<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="TOOLIB â€“ Tools for various needs">
    <meta name="author" content="Arthur Francisco" >
    <link rel="icon" href="../favicon.png">

    <title>test_minpack &ndash; TOOLIB</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
      <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
      <link href="../css/user.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">TOOLIB </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/programs.html">Programs</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>test_minpack      <small>Program</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">
            <li class="list-inline-item" id="meta-author"><i class="fa fa-pencil"></i> John Burkardt</li>

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title="29.8% of total for programs.">564 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/prg.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/prg.f90~9.html'>prg.f90</a></li>
            <li class="breadcrumb-item active" aria-current="page">test_minpack</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-bs-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#vars-0"
         aria-expanded="false" aria-controls="vars-0">
         <h4 class="card-header bg-primary text-white">Variables</h4>
      </a>
      <div id="vars-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../program/test_minpack.html#variable-rk">rk</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#subs-0"
         aria-expanded="false" aria-controls="subs-0">
         <h4 class="card-header bg-primary text-white">Subroutines</h4>
      </a>
      <div id="subs-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../program/test_minpack.html#proc-chkder_f">chkder_f</a>
            <a class="list-group-item" href="../program/test_minpack.html#proc-chkder_test">chkder_test</a>
            <a class="list-group-item" href="../program/test_minpack.html#proc-hybrd1_f">hybrd1_f</a>
            <a class="list-group-item" href="../program/test_minpack.html#proc-hybrd1_test">hybrd1_test</a>
            <a class="list-group-item" href="../program/test_minpack.html#proc-hybrj1_f">hybrj1_f</a>
            <a class="list-group-item" href="../program/test_minpack.html#proc-hybrj1_test">hybrj1_test</a>
            <a class="list-group-item" href="../program/test_minpack.html#proc-lmder1_2_f">lmder1_2_f</a>
            <a class="list-group-item" href="../program/test_minpack.html#proc-lmder1_2_test">lmder1_2_test</a>
            <a class="list-group-item" href="../program/test_minpack.html#proc-lmder1_f">lmder1_f</a>
            <a class="list-group-item" href="../program/test_minpack.html#proc-lmder1_test">lmder1_test</a>
            <a class="list-group-item" href="../program/test_minpack.html#proc-lmdif1_2_f">lmdif1_2_f</a>
            <a class="list-group-item" href="../program/test_minpack.html#proc-lmdif1_2_test">lmdif1_2_test</a>
            <a class="list-group-item" href="../program/test_minpack.html#proc-lmdif1_f">lmdif1_f</a>
            <a class="list-group-item" href="../program/test_minpack.html#proc-lmdif1_test">lmdif1_test</a>
            <a class="list-group-item" href="../program/test_minpack.html#proc-lmstr1_2_f">lmstr1_2_f</a>
            <a class="list-group-item" href="../program/test_minpack.html#proc-lmstr1_2_test">lmstr1_2_test</a>
            <a class="list-group-item" href="../program/test_minpack.html#proc-lmstr1_f">lmstr1_f</a>
            <a class="list-group-item" href="../program/test_minpack.html#proc-lmstr1_test">lmstr1_test</a>
            <a class="list-group-item" href="../program/test_minpack.html#proc-qform_test">qform_test</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../program/test_minpack.html#src">test_minpack</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
        <div class="card mb-4">
      <h3 class="card-header card-title bg-light">Uses</h3>
      <div class="card-body">
        <ul class="list-group list-group-flush">
            <li class="list-group-item">
              <ul class="list-inline">
                  <li class="list-inline-item"><a href='../module/minpack.html'>minpack</a></li>
              </ul>
            </li>
            <li class="list-group-item">
              <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: program~~test_minpack~~UsesGraph Pages: 1 -->
<svg id="programtest_minpackUsesGraph" width="174pt" height="32pt"
 viewBox="0.00 0.00 174.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~test_minpack~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>program~~test_minpack~~UsesGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 170,-28 170,4 -4,4"/>
<!-- program~test_minpack -->
<g id="program~~test_minpack~~UsesGraph_node1" class="node">
<title>program~test_minpack</title>
<polygon fill="none" stroke="black" points="166,-24 90,-24 90,0 166,0 166,-24"/>
<text text-anchor="middle" x="128" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">test_minpack</text>
</g>
<!-- module~minpack -->
<g id="program~~test_minpack~~UsesGraph_node2" class="node">
<title>module~minpack</title>
<g id="a_program~~test_minpack~~UsesGraph_node2"><a xlink:href="../module/minpack.html" xlink:title="minpack">
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">minpack</text>
</a>
</g>
</g>
<!-- program~test_minpack&#45;&gt;module~minpack -->
<g id="program~~test_minpack~~UsesGraph_edge1" class="edge">
<title>program~test_minpack&#45;&gt;module~minpack</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M89.85,-12C81.52,-12 72.69,-12 64.39,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="64.23,-8.5 54.23,-12 64.23,-15.5 64.23,-8.5"/>
</g>
</g>
</svg>
</div>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#UsesGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="UsesGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="490pt" height="32pt"
 viewBox="0.00 0.00 489.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 485.5,-28 485.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="139.5,-24 72.5,-24 72.5,0 139.5,0 139.5,-24"/>
<text text-anchor="middle" x="106" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="222,-24 158,-24 158,0 222,0 222,-24"/>
<text text-anchor="middle" x="190" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="294,-24 240,-24 240,0 294,0 294,-24"/>
<text text-anchor="middle" x="267" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-24 312,-24 312,0 366,0 366,-24"/>
<text text-anchor="middle" x="339" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="481.5,-24 384.5,-24 384.5,0 481.5,0 481.5,-24"/>
<text text-anchor="middle" x="433" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a submodule to the (sub)module which it is
descended from. Dashed arrows point from a module or program unit to 
modules which it uses.
</p>
 Where possible, edges connecting nodes are
given different colours to make them easier to distinguish in
large graphs.</div>
            </div>
          </div>
        </div>
            </li>
        </ul>
      </div>
    </div>

    <p><span style="color: #337ab7; font-family: cabin; font-size: 1.5em;">
<strong>A fortran collection of functions for minimization problems. Example of use.</strong>
</span></p>
    <br>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Calls</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: program~~test_minpack~~CallsGraph Pages: 1 -->
<svg id="programtest_minpackCallsGraph" width="641pt" height="694pt"
 viewBox="0.00 0.00 641.00 693.84" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~test_minpack~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 692)">
<title>program~~test_minpack~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-692 639,-692 639,4 -4,4"/>
<!-- program~test_minpack -->
<g id="program~~test_minpack~~CallsGraph_node1" class="node">
<title>program~test_minpack</title>
<polygon fill="none" stroke="black" points="76,-318 0,-318 0,-294 76,-294 76,-318"/>
<text text-anchor="middle" x="38" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50">test_minpack</text>
</g>
<!-- proc~chkder_test -->
<g id="program~~test_minpack~~CallsGraph_node2" class="node">
<title>proc~chkder_test</title>
<g id="a_program~~test_minpack~~CallsGraph_node2"><a xlink:href="../proc/chkder_test.html" xlink:title="chkder_test">
<polygon fill="#d9534f" stroke="#d9534f" points="186.5,-587 118.5,-587 118.5,-563 186.5,-563 186.5,-587"/>
<text text-anchor="middle" x="152.5" y="-572.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">chkder_test</text>
</a>
</g>
</g>
<!-- program~test_minpack&#45;&gt;proc~chkder_test -->
<g id="program~~test_minpack~~CallsGraph_edge1" class="edge">
<title>program~test_minpack&#45;&gt;proc~chkder_test</title>
<path fill="none" stroke="#ff0000" d="M40.95,-318.1C47,-353.34 67.83,-458.12 112,-533 116.82,-541.18 123.5,-549.07 129.99,-555.75"/>
<polygon fill="#ff0000" stroke="#ff0000" points="127.8,-558.51 137.4,-562.99 132.69,-553.5 127.8,-558.51"/>
</g>
<!-- proc~hybrd1_test -->
<g id="program~~test_minpack~~CallsGraph_node3" class="node">
<title>proc~hybrd1_test</title>
<g id="a_program~~test_minpack~~CallsGraph_node3"><a xlink:href="../proc/hybrd1_test.html" xlink:title="hybrd1_test">
<polygon fill="#d9534f" stroke="#d9534f" points="187,-524 118,-524 118,-500 187,-500 187,-524"/>
<text text-anchor="middle" x="152.5" y="-509.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hybrd1_test</text>
</a>
</g>
</g>
<!-- program~test_minpack&#45;&gt;proc~hybrd1_test -->
<g id="program~~test_minpack~~CallsGraph_edge2" class="edge">
<title>program~test_minpack&#45;&gt;proc~hybrd1_test</title>
<path fill="none" stroke="#ff0000" d="M40.84,-318.34C46.22,-350.49 64.62,-437.95 112,-491 112.75,-491.84 113.54,-492.65 114.37,-493.44"/>
<polygon fill="#ff0000" stroke="#ff0000" points="112.5,-496.42 122.55,-499.77 116.79,-490.88 112.5,-496.42"/>
</g>
<!-- proc~hybrj1_test -->
<g id="program~~test_minpack~~CallsGraph_node4" class="node">
<title>proc~hybrj1_test</title>
<g id="a_program~~test_minpack~~CallsGraph_node4"><a xlink:href="../proc/hybrj1_test.html" xlink:title="hybrj1_test">
<polygon fill="#d9534f" stroke="#d9534f" points="185,-482 120,-482 120,-458 185,-458 185,-482"/>
<text text-anchor="middle" x="152.5" y="-467.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hybrj1_test</text>
</a>
</g>
</g>
<!-- program~test_minpack&#45;&gt;proc~hybrj1_test -->
<g id="program~~test_minpack~~CallsGraph_edge3" class="edge">
<title>program~test_minpack&#45;&gt;proc~hybrj1_test</title>
<path fill="none" stroke="#ff0000" d="M43.12,-318.31C52.22,-344.06 76.09,-404.48 112,-444 114.52,-446.78 117.4,-449.39 120.43,-451.81"/>
<polygon fill="#ff0000" stroke="#ff0000" points="118.5,-454.73 128.66,-457.74 122.6,-449.06 118.5,-454.73"/>
</g>
<!-- proc~lmder1_2_test -->
<g id="program~~test_minpack~~CallsGraph_node5" class="node">
<title>proc~lmder1_2_test</title>
<g id="a_program~~test_minpack~~CallsGraph_node5"><a xlink:href="../proc/lmder1_2_test.html" xlink:title="lmder1_2_test">
<polygon fill="#d9534f" stroke="#d9534f" points="193,-360 112,-360 112,-336 193,-336 193,-360"/>
<text text-anchor="middle" x="152.5" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lmder1_2_test</text>
</a>
</g>
</g>
<!-- program~test_minpack&#45;&gt;proc~lmder1_2_test -->
<g id="program~~test_minpack~~CallsGraph_edge4" class="edge">
<title>program~test_minpack&#45;&gt;proc~lmder1_2_test</title>
<path fill="none" stroke="#ff0000" d="M71.24,-318.04C83.24,-322.52 97.04,-327.67 109.78,-332.42"/>
<polygon fill="#ff0000" stroke="#ff0000" points="108.66,-335.74 119.26,-335.96 111.11,-329.19 108.66,-335.74"/>
</g>
<!-- proc~lmder1_test -->
<g id="program~~test_minpack~~CallsGraph_node6" class="node">
<title>proc~lmder1_test</title>
<g id="a_program~~test_minpack~~CallsGraph_node6"><a xlink:href="../proc/lmder1_test.html" xlink:title="lmder1_test">
<polygon fill="#d9534f" stroke="#d9534f" points="187,-318 118,-318 118,-294 187,-294 187,-318"/>
<text text-anchor="middle" x="152.5" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lmder1_test</text>
</a>
</g>
</g>
<!-- program~test_minpack&#45;&gt;proc~lmder1_test -->
<g id="program~~test_minpack~~CallsGraph_edge5" class="edge">
<title>program~test_minpack&#45;&gt;proc~lmder1_test</title>
<path fill="none" stroke="#ff0000" d="M76.15,-306C86.23,-306 97.24,-306 107.65,-306"/>
<polygon fill="#ff0000" stroke="#ff0000" points="107.81,-309.5 117.81,-306 107.81,-302.5 107.81,-309.5"/>
</g>
<!-- proc~lmdif1_2_test -->
<g id="program~~test_minpack~~CallsGraph_node7" class="node">
<title>proc~lmdif1_2_test</title>
<g id="a_program~~test_minpack~~CallsGraph_node7"><a xlink:href="../proc/lmdif1_2_test.html" xlink:title="lmdif1_2_test">
<polygon fill="#d9534f" stroke="#d9534f" points="190.5,-192 114.5,-192 114.5,-168 190.5,-168 190.5,-192"/>
<text text-anchor="middle" x="152.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lmdif1_2_test</text>
</a>
</g>
</g>
<!-- program~test_minpack&#45;&gt;proc~lmdif1_2_test -->
<g id="program~~test_minpack~~CallsGraph_edge6" class="edge">
<title>program~test_minpack&#45;&gt;proc~lmdif1_2_test</title>
<path fill="none" stroke="#ff0000" d="M44.93,-293.91C55.78,-272.81 80.62,-228.86 112,-201 113.28,-199.87 114.63,-198.77 116.03,-197.72"/>
<polygon fill="#ff0000" stroke="#ff0000" points="118.04,-200.59 124.44,-192.15 114.17,-194.75 118.04,-200.59"/>
</g>
<!-- proc~lmdif1_test -->
<g id="program~~test_minpack~~CallsGraph_node8" class="node">
<title>proc~lmdif1_test</title>
<g id="a_program~~test_minpack~~CallsGraph_node8"><a xlink:href="../proc/lmdif1_test.html" xlink:title="lmdif1_test">
<polygon fill="#d9534f" stroke="#d9534f" points="184.5,-150 120.5,-150 120.5,-126 184.5,-126 184.5,-150"/>
<text text-anchor="middle" x="152.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lmdif1_test</text>
</a>
</g>
</g>
<!-- program~test_minpack&#45;&gt;proc~lmdif1_test -->
<g id="program~~test_minpack~~CallsGraph_edge7" class="edge">
<title>program~test_minpack&#45;&gt;proc~lmdif1_test</title>
<path fill="none" stroke="#ff0000" d="M42.25,-293.84C50.06,-266.59 72.27,-199.85 112,-159 112.91,-158.06 113.88,-157.15 114.88,-156.28"/>
<polygon fill="#ff0000" stroke="#ff0000" points="117.19,-158.93 123.21,-150.21 113.07,-153.27 117.19,-158.93"/>
</g>
<!-- proc~lmstr1_2_test -->
<g id="program~~test_minpack~~CallsGraph_node9" class="node">
<title>proc~lmstr1_2_test</title>
<g id="a_program~~test_minpack~~CallsGraph_node9"><a xlink:href="../proc/lmstr1_2_test.html" xlink:title="lmstr1_2_test">
<polygon fill="#d9534f" stroke="#d9534f" points="191,-276 114,-276 114,-252 191,-252 191,-276"/>
<text text-anchor="middle" x="152.5" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lmstr1_2_test</text>
</a>
</g>
</g>
<!-- program~test_minpack&#45;&gt;proc~lmstr1_2_test -->
<g id="program~~test_minpack~~CallsGraph_edge8" class="edge">
<title>program~test_minpack&#45;&gt;proc~lmstr1_2_test</title>
<path fill="none" stroke="#ff0000" d="M71.24,-293.96C83.24,-289.48 97.04,-284.33 109.78,-279.58"/>
<polygon fill="#ff0000" stroke="#ff0000" points="111.11,-282.81 119.26,-276.04 108.66,-276.26 111.11,-282.81"/>
</g>
<!-- proc~lmstr1_test -->
<g id="program~~test_minpack~~CallsGraph_node10" class="node">
<title>proc~lmstr1_test</title>
<g id="a_program~~test_minpack~~CallsGraph_node10"><a xlink:href="../proc/lmstr1_test.html" xlink:title="lmstr1_test">
<polygon fill="#d9534f" stroke="#d9534f" points="185,-234 120,-234 120,-210 185,-210 185,-234"/>
<text text-anchor="middle" x="152.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lmstr1_test</text>
</a>
</g>
</g>
<!-- program~test_minpack&#45;&gt;proc~lmstr1_test -->
<g id="program~~test_minpack~~CallsGraph_edge9" class="edge">
<title>program~test_minpack&#45;&gt;proc~lmstr1_test</title>
<path fill="none" stroke="#ff0000" d="M51.22,-293.94C65.18,-280.53 89.07,-258.7 112,-243 113.87,-241.72 115.84,-240.45 117.84,-239.22"/>
<polygon fill="#ff0000" stroke="#ff0000" points="119.86,-242.09 126.77,-234.06 116.36,-236.03 119.86,-242.09"/>
</g>
<!-- proc~qform_test -->
<g id="program~~test_minpack~~CallsGraph_node11" class="node">
<title>proc~qform_test</title>
<g id="a_program~~test_minpack~~CallsGraph_node11"><a xlink:href="../proc/qform_test.html" xlink:title="qform_test">
<polygon fill="#d9534f" stroke="#d9534f" points="396,-440 332,-440 332,-416 396,-416 396,-440"/>
<text text-anchor="middle" x="364" y="-425.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">qform_test</text>
</a>
</g>
</g>
<!-- program~test_minpack&#45;&gt;proc~qform_test -->
<g id="program~~test_minpack~~CallsGraph_edge10" class="edge">
<title>program~test_minpack&#45;&gt;proc~qform_test</title>
<path fill="none" stroke="#ff0000" d="M50.34,-318.19C63.86,-332.12 87.71,-354.82 112,-369 178.73,-407.95 269.58,-421.2 321.69,-425.7"/>
<polygon fill="#ff0000" stroke="#ff0000" points="321.64,-429.2 331.89,-426.51 322.2,-422.22 321.64,-429.2"/>
</g>
<!-- proc~timestamp -->
<g id="program~~test_minpack~~CallsGraph_node12" class="node">
<title>proc~timestamp</title>
<g id="a_program~~test_minpack~~CallsGraph_node12"><a xlink:href="../proc/timestamp.html" xlink:title="timestamp">
<polygon fill="#d9534f" stroke="#d9534f" points="183.5,-108 121.5,-108 121.5,-84 183.5,-84 183.5,-108"/>
<text text-anchor="middle" x="152.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">timestamp</text>
</a>
</g>
</g>
<!-- program~test_minpack&#45;&gt;proc~timestamp -->
<g id="program~~test_minpack~~CallsGraph_edge11" class="edge">
<title>program~test_minpack&#45;&gt;proc~timestamp</title>
<path fill="none" stroke="#ff0000" d="M40.69,-293.87C45.78,-261.43 63.7,-171.48 112,-117 112.75,-116.16 113.54,-115.34 114.36,-114.56"/>
<polygon fill="#ff0000" stroke="#ff0000" points="116.78,-117.11 122.53,-108.21 112.48,-111.58 116.78,-117.11"/>
</g>
<!-- proc~chkder -->
<g id="program~~test_minpack~~CallsGraph_node13" class="node">
<title>proc~chkder</title>
<g id="a_program~~test_minpack~~CallsGraph_node13"><a xlink:href="../proc/chkder.html" xlink:title="chkder">
<polygon fill="#d9534f" stroke="#d9534f" points="289.5,-650 235.5,-650 235.5,-626 289.5,-626 289.5,-650"/>
<text text-anchor="middle" x="262.5" y="-635.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">chkder</text>
</a>
</g>
</g>
<!-- proc~chkder_test&#45;&gt;proc~chkder -->
<g id="program~~test_minpack~~CallsGraph_edge12" class="edge">
<title>proc~chkder_test&#45;&gt;proc~chkder</title>
<path fill="none" stroke="#ff0000" d="M174.32,-587.15C190.68,-596.69 213.68,-610.1 231.94,-620.76"/>
<polygon fill="#ff0000" stroke="#ff0000" points="230.34,-623.87 240.74,-625.89 233.87,-617.83 230.34,-623.87"/>
</g>
<!-- proc~chkder_f -->
<g id="program~~test_minpack~~CallsGraph_node14" class="node">
<title>proc~chkder_f</title>
<g id="a_program~~test_minpack~~CallsGraph_node14"><a xlink:href="../proc/chkder_f.html" xlink:title="chkder_f">
<polygon fill="#d9534f" stroke="#d9534f" points="289.5,-608 235.5,-608 235.5,-584 289.5,-584 289.5,-608"/>
<text text-anchor="middle" x="262.5" y="-593.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">chkder_f</text>
</a>
</g>
</g>
<!-- proc~chkder_test&#45;&gt;proc~chkder_f -->
<g id="program~~test_minpack~~CallsGraph_edge13" class="edge">
<title>proc~chkder_test&#45;&gt;proc~chkder_f</title>
<path fill="none" stroke="#ff0000" d="M186.78,-581.47C198.99,-583.84 212.85,-586.54 225.3,-588.96"/>
<polygon fill="#ff0000" stroke="#ff0000" points="224.87,-592.44 235.35,-590.92 226.2,-585.57 224.87,-592.44"/>
</g>
<!-- proc~r8vec_print -->
<g id="program~~test_minpack~~CallsGraph_node30" class="node">
<title>proc~r8vec_print</title>
<g id="a_program~~test_minpack~~CallsGraph_node30"><a xlink:href="../proc/r8vec_print.html" xlink:title="r8vec_print">
<polygon fill="#d9534f" stroke="#d9534f" points="295.5,-276 229.5,-276 229.5,-252 295.5,-252 295.5,-276"/>
<text text-anchor="middle" x="262.5" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">r8vec_print</text>
</a>
</g>
</g>
<!-- proc~chkder_test&#45;&gt;proc~r8vec_print -->
<g id="program~~test_minpack~~CallsGraph_edge14" class="edge">
<title>proc~chkder_test&#45;&gt;proc~r8vec_print</title>
<path fill="none" stroke="#ff0000" d="M169.08,-562.66C177.56,-555.04 187.43,-544.54 193,-533 241.39,-432.68 168.84,-378.73 229,-285 229.34,-284.47 229.7,-283.95 230.07,-283.44"/>
<polygon fill="#ff0000" stroke="#ff0000" points="232.79,-285.68 237.35,-276.12 227.82,-280.75 232.79,-285.68"/>
</g>
<!-- proc~hybrd1 -->
<g id="program~~test_minpack~~CallsGraph_node15" class="node">
<title>proc~hybrd1</title>
<g id="a_program~~test_minpack~~CallsGraph_node15"><a xlink:href="../proc/hybrd1.html" xlink:title="hybrd1">
<polygon fill="#d9534f" stroke="#d9534f" points="289.5,-566 235.5,-566 235.5,-542 289.5,-542 289.5,-566"/>
<text text-anchor="middle" x="262.5" y="-551.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hybrd1</text>
</a>
</g>
</g>
<!-- proc~hybrd1_test&#45;&gt;proc~hybrd1 -->
<g id="program~~test_minpack~~CallsGraph_edge15" class="edge">
<title>proc~hybrd1_test&#45;&gt;proc~hybrd1</title>
<path fill="none" stroke="#ff8b00" d="M184.45,-524.04C197.39,-529.07 212.5,-534.95 225.9,-540.16"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="224.71,-543.45 235.3,-543.81 227.25,-536.92 224.71,-543.45"/>
</g>
<!-- proc~hybrd1_f -->
<g id="program~~test_minpack~~CallsGraph_node16" class="node">
<title>proc~hybrd1_f</title>
<g id="a_program~~test_minpack~~CallsGraph_node16"><a xlink:href="../proc/hybrd1_f.html" xlink:title="hybrd1_f">
<polygon fill="#d9534f" stroke="#d9534f" points="290,-524 235,-524 235,-500 290,-500 290,-524"/>
<text text-anchor="middle" x="262.5" y="-509.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hybrd1_f</text>
</a>
</g>
</g>
<!-- proc~hybrd1_test&#45;&gt;proc~hybrd1_f -->
<g id="program~~test_minpack~~CallsGraph_edge16" class="edge">
<title>proc~hybrd1_test&#45;&gt;proc~hybrd1_f</title>
<path fill="none" stroke="#ff8b00" d="M187.08,-512C198.96,-512 212.38,-512 224.52,-512"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="224.79,-515.5 234.79,-512 224.79,-508.5 224.79,-515.5"/>
</g>
<!-- proc~hybrd1_test&#45;&gt;proc~r8vec_print -->
<g id="program~~test_minpack~~CallsGraph_edge17" class="edge">
<title>proc~hybrd1_test&#45;&gt;proc~r8vec_print</title>
<path fill="none" stroke="#ff8b00" d="M183.87,-499.75C187.36,-497.29 190.54,-494.39 193,-491 247.58,-415.77 177.67,-362.48 229,-285 229.35,-284.47 229.71,-283.96 230.1,-283.46"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="232.8,-285.7 237.43,-276.17 227.87,-280.73 232.8,-285.7"/>
</g>
<!-- proc~hybrj1_test&#45;&gt;proc~hybrd1_f -->
<g id="program~~test_minpack~~CallsGraph_edge18" class="edge">
<title>proc~hybrj1_test&#45;&gt;proc~hybrd1_f</title>
<path fill="none" stroke="#e7ff00" d="M184.45,-482.04C197.29,-487.03 212.27,-492.85 225.59,-498.04"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="224.35,-501.31 234.94,-501.67 226.89,-494.79 224.35,-501.31"/>
</g>
<!-- proc~hybrj1 -->
<g id="program~~test_minpack~~CallsGraph_node17" class="node">
<title>proc~hybrj1</title>
<g id="a_program~~test_minpack~~CallsGraph_node17"><a xlink:href="../proc/hybrj1.html" xlink:title="hybrj1">
<polygon fill="#d9534f" stroke="#d9534f" points="289.5,-482 235.5,-482 235.5,-458 289.5,-458 289.5,-482"/>
<text text-anchor="middle" x="262.5" y="-467.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hybrj1</text>
</a>
</g>
</g>
<!-- proc~hybrj1_test&#45;&gt;proc~hybrj1 -->
<g id="program~~test_minpack~~CallsGraph_edge19" class="edge">
<title>proc~hybrj1_test&#45;&gt;proc~hybrj1</title>
<path fill="none" stroke="#e7ff00" d="M185.03,-470C197.61,-470 212.16,-470 225.18,-470"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="225.22,-473.5 235.22,-470 225.22,-466.5 225.22,-473.5"/>
</g>
<!-- proc~hybrj1_test&#45;&gt;proc~r8vec_print -->
<g id="program~~test_minpack~~CallsGraph_edge20" class="edge">
<title>proc~hybrj1_test&#45;&gt;proc~r8vec_print</title>
<path fill="none" stroke="#e7ff00" d="M158.23,-457.84C173.84,-417.79 223.05,-292.18 229,-285 229.6,-284.28 230.23,-283.57 230.89,-282.88"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="233.42,-285.32 238.71,-276.13 228.85,-280.01 233.42,-285.32"/>
</g>
<!-- proc~lmder1 -->
<g id="program~~test_minpack~~CallsGraph_node18" class="node">
<title>proc~lmder1</title>
<g id="a_program~~test_minpack~~CallsGraph_node18"><a xlink:href="../proc/lmder1.html" xlink:title="lmder1">
<polygon fill="#d9534f" stroke="#d9534f" points="289.5,-360 235.5,-360 235.5,-336 289.5,-336 289.5,-360"/>
<text text-anchor="middle" x="262.5" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lmder1</text>
</a>
</g>
</g>
<!-- proc~lmder1_2_test&#45;&gt;proc~lmder1 -->
<g id="program~~test_minpack~~CallsGraph_edge21" class="edge">
<title>proc~lmder1_2_test&#45;&gt;proc~lmder1</title>
<path fill="none" stroke="#5cff00" d="M193.1,-348C203.56,-348 214.79,-348 225.07,-348"/>
<polygon fill="#5cff00" stroke="#5cff00" points="225.36,-351.5 235.36,-348 225.36,-344.5 225.36,-351.5"/>
</g>
<!-- proc~lmder1_2_f -->
<g id="program~~test_minpack~~CallsGraph_node19" class="node">
<title>proc~lmder1_2_f</title>
<g id="a_program~~test_minpack~~CallsGraph_node19"><a xlink:href="../proc/lmder1_2_f.html" xlink:title="lmder1_2_f">
<polygon fill="#d9534f" stroke="#d9534f" points="296,-402 229,-402 229,-378 296,-378 296,-402"/>
<text text-anchor="middle" x="262.5" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lmder1_2_f</text>
</a>
</g>
</g>
<!-- proc~lmder1_2_test&#45;&gt;proc~lmder1_2_f -->
<g id="program~~test_minpack~~CallsGraph_edge22" class="edge">
<title>proc~lmder1_2_test&#45;&gt;proc~lmder1_2_f</title>
<path fill="none" stroke="#5cff00" d="M184.45,-360.04C195.86,-364.47 208.96,-369.57 221.08,-374.28"/>
<polygon fill="#5cff00" stroke="#5cff00" points="219.96,-377.6 230.55,-377.96 222.5,-371.08 219.96,-377.6"/>
</g>
<!-- proc~lmder1_2_test&#45;&gt;proc~r8vec_print -->
<g id="program~~test_minpack~~CallsGraph_edge23" class="edge">
<title>proc~lmder1_2_test&#45;&gt;proc~r8vec_print</title>
<path fill="none" stroke="#5cff00" d="M179.87,-335.76C184.44,-333.15 189,-330.2 193,-327 212.19,-311.63 210.48,-301.17 229,-285 230.14,-284.01 231.33,-283.02 232.55,-282.06"/>
<polygon fill="#5cff00" stroke="#5cff00" points="234.86,-284.71 240.91,-276.02 230.76,-279.04 234.86,-284.71"/>
</g>
<!-- proc~lmder1_test&#45;&gt;proc~lmder1 -->
<g id="program~~test_minpack~~CallsGraph_edge24" class="edge">
<title>proc~lmder1_test&#45;&gt;proc~lmder1</title>
<path fill="none" stroke="#00ff2e" d="M184.45,-318.04C197.39,-323.07 212.5,-328.95 225.9,-334.16"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="224.71,-337.45 235.3,-337.81 227.25,-330.92 224.71,-337.45"/>
</g>
<!-- proc~lmder1_f -->
<g id="program~~test_minpack~~CallsGraph_node20" class="node">
<title>proc~lmder1_f</title>
<g id="a_program~~test_minpack~~CallsGraph_node20"><a xlink:href="../proc/lmder1_f.html" xlink:title="lmder1_f">
<polygon fill="#d9534f" stroke="#d9534f" points="290,-318 235,-318 235,-294 290,-294 290,-318"/>
<text text-anchor="middle" x="262.5" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lmder1_f</text>
</a>
</g>
</g>
<!-- proc~lmder1_test&#45;&gt;proc~lmder1_f -->
<g id="program~~test_minpack~~CallsGraph_edge25" class="edge">
<title>proc~lmder1_test&#45;&gt;proc~lmder1_f</title>
<path fill="none" stroke="#00ff2e" d="M187.08,-306C198.96,-306 212.38,-306 224.52,-306"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="224.79,-309.5 234.79,-306 224.79,-302.5 224.79,-309.5"/>
</g>
<!-- proc~lmder1_test&#45;&gt;proc~r8vec_print -->
<g id="program~~test_minpack~~CallsGraph_edge26" class="edge">
<title>proc~lmder1_test&#45;&gt;proc~r8vec_print</title>
<path fill="none" stroke="#00ff2e" d="M184.45,-293.96C195.86,-289.53 208.96,-284.43 221.08,-279.72"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="222.5,-282.92 230.55,-276.04 219.96,-276.4 222.5,-282.92"/>
</g>
<!-- proc~lmdif1 -->
<g id="program~~test_minpack~~CallsGraph_node21" class="node">
<title>proc~lmdif1</title>
<g id="a_program~~test_minpack~~CallsGraph_node21"><a xlink:href="../proc/lmdif1.html" xlink:title="lmdif1">
<polygon fill="#d9534f" stroke="#d9534f" points="289.5,-66 235.5,-66 235.5,-42 289.5,-42 289.5,-66"/>
<text text-anchor="middle" x="262.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lmdif1</text>
</a>
</g>
</g>
<!-- proc~lmdif1_2_test&#45;&gt;proc~lmdif1 -->
<g id="program~~test_minpack~~CallsGraph_edge27" class="edge">
<title>proc~lmdif1_2_test&#45;&gt;proc~lmdif1</title>
<path fill="none" stroke="#00ffb9" d="M181.96,-167.95C186,-165.41 189.85,-162.43 193,-159 220.49,-129.1 202.8,-106.04 229,-75 229.61,-74.28 230.24,-73.58 230.91,-72.89"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="233.43,-75.34 238.76,-66.17 228.88,-70.02 233.43,-75.34"/>
</g>
<!-- proc~lmdif1_2_f -->
<g id="program~~test_minpack~~CallsGraph_node22" class="node">
<title>proc~lmdif1_2_f</title>
<g id="a_program~~test_minpack~~CallsGraph_node22"><a xlink:href="../proc/lmdif1_2_f.html" xlink:title="lmdif1_2_f">
<polygon fill="#d9534f" stroke="#d9534f" points="293.5,-108 231.5,-108 231.5,-84 293.5,-84 293.5,-108"/>
<text text-anchor="middle" x="262.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lmdif1_2_f</text>
</a>
</g>
</g>
<!-- proc~lmdif1_2_test&#45;&gt;proc~lmdif1_2_f -->
<g id="program~~test_minpack~~CallsGraph_edge28" class="edge">
<title>proc~lmdif1_2_test&#45;&gt;proc~lmdif1_2_f</title>
<path fill="none" stroke="#00ffb9" d="M179.87,-167.76C184.44,-165.15 189,-162.2 193,-159 212.19,-143.63 210.48,-133.17 229,-117 230.14,-116.01 231.33,-115.02 232.55,-114.06"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="234.86,-116.71 240.91,-108.02 230.76,-111.04 234.86,-116.71"/>
</g>
<!-- proc~lmdif1_2_test&#45;&gt;proc~r8vec_print -->
<g id="program~~test_minpack~~CallsGraph_edge29" class="edge">
<title>proc~lmdif1_2_test&#45;&gt;proc~r8vec_print</title>
<path fill="none" stroke="#00ffb9" d="M179.87,-192.24C184.44,-194.85 189,-197.8 193,-201 212.19,-216.37 210.48,-226.83 229,-243 230.14,-243.99 231.33,-244.98 232.55,-245.94"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="230.76,-248.96 240.91,-251.98 234.86,-243.29 230.76,-248.96"/>
</g>
<!-- proc~lmdif1_test&#45;&gt;proc~lmdif1 -->
<g id="program~~test_minpack~~CallsGraph_edge30" class="edge">
<title>proc~lmdif1_test&#45;&gt;proc~lmdif1</title>
<path fill="none" stroke="#00b9ff" d="M179.87,-125.76C184.44,-123.15 189,-120.2 193,-117 212.19,-101.63 210.48,-91.17 229,-75 230.14,-74.01 231.33,-73.02 232.55,-72.06"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="234.86,-74.71 240.91,-66.02 230.76,-69.04 234.86,-74.71"/>
</g>
<!-- proc~lmdif1_f -->
<g id="program~~test_minpack~~CallsGraph_node23" class="node">
<title>proc~lmdif1_f</title>
<g id="a_program~~test_minpack~~CallsGraph_node23"><a xlink:href="../proc/lmdif1_f.html" xlink:title="lmdif1_f">
<polygon fill="#d9534f" stroke="#d9534f" points="289.5,-24 235.5,-24 235.5,0 289.5,0 289.5,-24"/>
<text text-anchor="middle" x="262.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lmdif1_f</text>
</a>
</g>
</g>
<!-- proc~lmdif1_test&#45;&gt;proc~lmdif1_f -->
<g id="program~~test_minpack~~CallsGraph_edge31" class="edge">
<title>proc~lmdif1_test&#45;&gt;proc~lmdif1_f</title>
<path fill="none" stroke="#00b9ff" d="M181.96,-125.95C186,-123.41 189.85,-120.43 193,-117 220.49,-87.1 202.8,-64.04 229,-33 229.61,-32.28 230.24,-31.58 230.91,-30.89"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="233.43,-33.34 238.76,-24.17 228.88,-28.02 233.43,-33.34"/>
</g>
<!-- proc~lmdif1_test&#45;&gt;proc~r8vec_print -->
<g id="program~~test_minpack~~CallsGraph_edge32" class="edge">
<title>proc~lmdif1_test&#45;&gt;proc~r8vec_print</title>
<path fill="none" stroke="#00b9ff" d="M181.96,-150.05C186,-152.59 189.85,-155.57 193,-159 220.49,-188.9 202.8,-211.96 229,-243 229.61,-243.72 230.24,-244.42 230.91,-245.11"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="228.88,-247.98 238.76,-251.83 233.43,-242.66 228.88,-247.98"/>
</g>
<!-- proc~lmstr1 -->
<g id="program~~test_minpack~~CallsGraph_node24" class="node">
<title>proc~lmstr1</title>
<g id="a_program~~test_minpack~~CallsGraph_node24"><a xlink:href="../proc/lmstr1.html" xlink:title="lmstr1">
<polygon fill="#d9534f" stroke="#d9534f" points="289.5,-192 235.5,-192 235.5,-168 289.5,-168 289.5,-192"/>
<text text-anchor="middle" x="262.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lmstr1</text>
</a>
</g>
</g>
<!-- proc~lmstr1_2_test&#45;&gt;proc~lmstr1 -->
<g id="program~~test_minpack~~CallsGraph_edge33" class="edge">
<title>proc~lmstr1_2_test&#45;&gt;proc~lmstr1</title>
<path fill="none" stroke="#002eff" d="M179.87,-251.76C184.44,-249.15 189,-246.2 193,-243 212.19,-227.63 210.48,-217.17 229,-201 230.14,-200.01 231.33,-199.02 232.55,-198.06"/>
<polygon fill="#002eff" stroke="#002eff" points="234.86,-200.71 240.91,-192.02 230.76,-195.04 234.86,-200.71"/>
</g>
<!-- proc~lmstr1_2_f -->
<g id="program~~test_minpack~~CallsGraph_node25" class="node">
<title>proc~lmstr1_2_f</title>
<g id="a_program~~test_minpack~~CallsGraph_node25"><a xlink:href="../proc/lmstr1_2_f.html" xlink:title="lmstr1_2_f">
<polygon fill="#d9534f" stroke="#d9534f" points="294,-234 231,-234 231,-210 294,-210 294,-234"/>
<text text-anchor="middle" x="262.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lmstr1_2_f</text>
</a>
</g>
</g>
<!-- proc~lmstr1_2_test&#45;&gt;proc~lmstr1_2_f -->
<g id="program~~test_minpack~~CallsGraph_edge34" class="edge">
<title>proc~lmstr1_2_test&#45;&gt;proc~lmstr1_2_f</title>
<path fill="none" stroke="#002eff" d="M184.45,-251.96C195.96,-247.49 209.19,-242.34 221.4,-237.6"/>
<polygon fill="#002eff" stroke="#002eff" points="222.87,-240.78 230.92,-233.89 220.33,-234.25 222.87,-240.78"/>
</g>
<!-- proc~lmstr1_2_test&#45;&gt;proc~r8vec_print -->
<g id="program~~test_minpack~~CallsGraph_edge35" class="edge">
<title>proc~lmstr1_2_test&#45;&gt;proc~r8vec_print</title>
<path fill="none" stroke="#002eff" d="M191.27,-264C200.29,-264 209.97,-264 219.18,-264"/>
<polygon fill="#002eff" stroke="#002eff" points="219.31,-267.5 229.31,-264 219.31,-260.5 219.31,-267.5"/>
</g>
<!-- proc~lmstr1_test&#45;&gt;proc~lmstr1 -->
<g id="program~~test_minpack~~CallsGraph_edge36" class="edge">
<title>proc~lmstr1_test&#45;&gt;proc~lmstr1</title>
<path fill="none" stroke="#5c00ff" d="M184.45,-209.96C197.39,-204.93 212.5,-199.05 225.9,-193.84"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="227.25,-197.08 235.3,-190.19 224.71,-190.55 227.25,-197.08"/>
</g>
<!-- proc~lmstr1_f -->
<g id="program~~test_minpack~~CallsGraph_node26" class="node">
<title>proc~lmstr1_f</title>
<g id="a_program~~test_minpack~~CallsGraph_node26"><a xlink:href="../proc/lmstr1_f.html" xlink:title="lmstr1_f">
<polygon fill="#d9534f" stroke="#d9534f" points="289.5,-150 235.5,-150 235.5,-126 289.5,-126 289.5,-150"/>
<text text-anchor="middle" x="262.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lmstr1_f</text>
</a>
</g>
</g>
<!-- proc~lmstr1_test&#45;&gt;proc~lmstr1_f -->
<g id="program~~test_minpack~~CallsGraph_edge37" class="edge">
<title>proc~lmstr1_test&#45;&gt;proc~lmstr1_f</title>
<path fill="none" stroke="#5c00ff" d="M179.87,-209.76C184.44,-207.15 189,-204.2 193,-201 212.19,-185.63 210.48,-175.17 229,-159 230.14,-158.01 231.33,-157.02 232.55,-156.06"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="234.86,-158.71 240.91,-150.02 230.76,-153.04 234.86,-158.71"/>
</g>
<!-- proc~lmstr1_test&#45;&gt;proc~r8vec_print -->
<g id="program~~test_minpack~~CallsGraph_edge38" class="edge">
<title>proc~lmstr1_test&#45;&gt;proc~r8vec_print</title>
<path fill="none" stroke="#5c00ff" d="M184.45,-234.04C195.86,-238.47 208.96,-243.57 221.08,-248.28"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="219.96,-251.6 230.55,-251.96 222.5,-245.08 219.96,-251.6"/>
</g>
<!-- proc~qform -->
<g id="program~~test_minpack~~CallsGraph_node27" class="node">
<title>proc~qform</title>
<g id="a_program~~test_minpack~~CallsGraph_node27"><a xlink:href="../proc/qform.html" xlink:title="qform">
<polygon fill="#d9534f" stroke="#d9534f" points="492.5,-482 438.5,-482 438.5,-458 492.5,-458 492.5,-482"/>
<text text-anchor="middle" x="465.5" y="-467.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">qform</text>
</a>
</g>
</g>
<!-- proc~qform_test&#45;&gt;proc~qform -->
<g id="program~~test_minpack~~CallsGraph_edge39" class="edge">
<title>proc~qform_test&#45;&gt;proc~qform</title>
<path fill="none" stroke="#e700ff" d="M393.51,-440.04C404.55,-444.69 417.3,-450.08 428.93,-454.98"/>
<polygon fill="#e700ff" stroke="#e700ff" points="427.79,-458.3 438.37,-458.97 430.51,-451.86 427.79,-458.3"/>
</g>
<!-- proc~qrfac -->
<g id="program~~test_minpack~~CallsGraph_node28" class="node">
<title>proc~qrfac</title>
<g id="a_program~~test_minpack~~CallsGraph_node28"><a xlink:href="../proc/qrfac.html" xlink:title="qrfac">
<polygon fill="#d9534f" stroke="#d9534f" points="492.5,-360 438.5,-360 438.5,-336 492.5,-336 492.5,-360"/>
<text text-anchor="middle" x="465.5" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">qrfac</text>
</a>
</g>
</g>
<!-- proc~qform_test&#45;&gt;proc~qrfac -->
<g id="program~~test_minpack~~CallsGraph_edge40" class="edge">
<title>proc~qform_test&#45;&gt;proc~qrfac</title>
<path fill="none" stroke="#e700ff" d="M379.89,-415.97C393.46,-405.02 414.06,-388.4 432,-374 434.99,-371.6 438.14,-369.07 441.26,-366.58"/>
<polygon fill="#e700ff" stroke="#e700ff" points="443.66,-369.14 449.28,-360.16 439.28,-363.67 443.66,-369.14"/>
</g>
<!-- proc~r8mat_print -->
<g id="program~~test_minpack~~CallsGraph_node29" class="node">
<title>proc~r8mat_print</title>
<g id="a_program~~test_minpack~~CallsGraph_node29"><a xlink:href="../proc/r8mat_print.html" xlink:title="r8mat_print">
<polygon fill="#d9534f" stroke="#d9534f" points="499,-440 432,-440 432,-416 499,-416 499,-440"/>
<text text-anchor="middle" x="465.5" y="-425.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">r8mat_print</text>
</a>
</g>
</g>
<!-- proc~qform_test&#45;&gt;proc~r8mat_print -->
<g id="program~~test_minpack~~CallsGraph_edge41" class="edge">
<title>proc~qform_test&#45;&gt;proc~r8mat_print</title>
<path fill="none" stroke="#e700ff" d="M396.21,-428C404.23,-428 413.01,-428 421.51,-428"/>
<polygon fill="#e700ff" stroke="#e700ff" points="421.68,-431.5 431.68,-428 421.68,-424.5 421.68,-431.5"/>
</g>
<!-- proc~hybrd -->
<g id="program~~test_minpack~~CallsGraph_node32" class="node">
<title>proc~hybrd</title>
<g id="a_program~~test_minpack~~CallsGraph_node32"><a xlink:href="../proc/hybrd.html" xlink:title="hybrd">
<polygon fill="#d9534f" stroke="#d9534f" points="391,-566 337,-566 337,-542 391,-542 391,-566"/>
<text text-anchor="middle" x="364" y="-551.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hybrd</text>
</a>
</g>
</g>
<!-- proc~hybrd1&#45;&gt;proc~hybrd -->
<g id="program~~test_minpack~~CallsGraph_edge42" class="edge">
<title>proc~hybrd1&#45;&gt;proc~hybrd</title>
<path fill="none" stroke="#ffaa00" d="M289.64,-554C300.86,-554 314.17,-554 326.35,-554"/>
<polygon fill="#ffaa00" stroke="#ffaa00" points="326.69,-557.5 336.69,-554 326.69,-550.5 326.69,-557.5"/>
</g>
<!-- proc~hybrj -->
<g id="program~~test_minpack~~CallsGraph_node33" class="node">
<title>proc~hybrj</title>
<g id="a_program~~test_minpack~~CallsGraph_node33"><a xlink:href="../proc/hybrj.html" xlink:title="hybrj">
<polygon fill="#d9534f" stroke="#d9534f" points="391,-482 337,-482 337,-458 391,-458 391,-482"/>
<text text-anchor="middle" x="364" y="-467.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hybrj</text>
</a>
</g>
</g>
<!-- proc~hybrj1&#45;&gt;proc~hybrj -->
<g id="program~~test_minpack~~CallsGraph_edge43" class="edge">
<title>proc~hybrj1&#45;&gt;proc~hybrj</title>
<path fill="none" stroke="#aaff00" d="M289.64,-470C300.86,-470 314.17,-470 326.35,-470"/>
<polygon fill="#aaff00" stroke="#aaff00" points="326.69,-473.5 336.69,-470 326.69,-466.5 326.69,-473.5"/>
</g>
<!-- proc~lmder -->
<g id="program~~test_minpack~~CallsGraph_node34" class="node">
<title>proc~lmder</title>
<g id="a_program~~test_minpack~~CallsGraph_node34"><a xlink:href="../proc/lmder.html" xlink:title="lmder">
<polygon fill="#d9534f" stroke="#d9534f" points="391,-340 337,-340 337,-316 391,-316 391,-340"/>
<text text-anchor="middle" x="364" y="-325.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lmder</text>
</a>
</g>
</g>
<!-- proc~lmder1&#45;&gt;proc~lmder -->
<g id="program~~test_minpack~~CallsGraph_edge44" class="edge">
<title>proc~lmder1&#45;&gt;proc~lmder</title>
<path fill="none" stroke="#54ff00" d="M289.64,-342.75C300.98,-340.47 314.44,-337.76 326.72,-335.29"/>
<polygon fill="#54ff00" stroke="#54ff00" points="327.57,-338.69 336.69,-333.29 326.19,-331.83 327.57,-338.69"/>
</g>
<!-- proc~lmdif -->
<g id="program~~test_minpack~~CallsGraph_node35" class="node">
<title>proc~lmdif</title>
<g id="a_program~~test_minpack~~CallsGraph_node35"><a xlink:href="../proc/lmdif.html" xlink:title="lmdif">
<polygon fill="#d9534f" stroke="#d9534f" points="391,-160 337,-160 337,-136 391,-136 391,-160"/>
<text text-anchor="middle" x="364" y="-145.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lmdif</text>
</a>
</g>
</g>
<!-- proc~lmdif1&#45;&gt;proc~lmdif -->
<g id="program~~test_minpack~~CallsGraph_edge45" class="edge">
<title>proc~lmdif1&#45;&gt;proc~lmdif</title>
<path fill="none" stroke="#00ffa9" d="M284,-66.12C288.12,-68.85 292.3,-71.88 296,-75 315.08,-91.1 334.06,-112.41 346.92,-127.84"/>
<polygon fill="#00ffa9" stroke="#00ffa9" points="344.35,-130.23 353.4,-135.74 349.76,-125.79 344.35,-130.23"/>
</g>
<!-- proc~lmstr -->
<g id="program~~test_minpack~~CallsGraph_node36" class="node">
<title>proc~lmstr</title>
<g id="a_program~~test_minpack~~CallsGraph_node36"><a xlink:href="../proc/lmstr.html" xlink:title="lmstr">
<polygon fill="#d9534f" stroke="#d9534f" points="391,-242 337,-242 337,-218 391,-218 391,-242"/>
<text text-anchor="middle" x="364" y="-227.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lmstr</text>
</a>
</g>
</g>
<!-- proc~lmstr1&#45;&gt;proc~lmstr -->
<g id="program~~test_minpack~~CallsGraph_edge46" class="edge">
<title>proc~lmstr1&#45;&gt;proc~lmstr</title>
<path fill="none" stroke="#0054ff" d="M287.59,-192.1C300.2,-198.44 315.85,-206.31 329.62,-213.23"/>
<polygon fill="#0054ff" stroke="#0054ff" points="328.28,-216.47 338.79,-217.83 331.43,-210.22 328.28,-216.47"/>
</g>
<!-- proc~enorm -->
<g id="program~~test_minpack~~CallsGraph_node31" class="node">
<title>proc~enorm</title>
<g id="a_program~~test_minpack~~CallsGraph_node31"><a xlink:href="../proc/enorm.html" xlink:title="enorm">
<polygon fill="#d94e8f" stroke="#d94e8f" points="612,-340 558,-340 558,-316 612,-316 612,-340"/>
<text text-anchor="middle" x="585" y="-325.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">enorm</text>
</a>
</g>
</g>
<!-- proc~qrfac&#45;&gt;proc~enorm -->
<g id="program~~test_minpack~~CallsGraph_edge47" class="edge">
<title>proc~qrfac&#45;&gt;proc~enorm</title>
<path fill="none" stroke="#ff00ff" d="M492.58,-343.56C508.85,-340.79 530.04,-337.19 547.91,-334.14"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="548.72,-337.55 558,-332.43 547.55,-330.65 548.72,-337.55"/>
</g>
<!-- proc~r8mat_print_some -->
<g id="program~~test_minpack~~CallsGraph_node37" class="node">
<title>proc~r8mat_print_some</title>
<g id="a_program~~test_minpack~~CallsGraph_node37"><a xlink:href="../proc/r8mat_print_some.html" xlink:title="r8mat_print_some">
<polygon fill="#d9534f" stroke="#d9534f" points="635,-440 535,-440 535,-416 635,-416 635,-440"/>
<text text-anchor="middle" x="585" y="-425.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">r8mat_print_some</text>
</a>
</g>
</g>
<!-- proc~r8mat_print&#45;&gt;proc~r8mat_print_some -->
<g id="program~~test_minpack~~CallsGraph_edge48" class="edge">
<title>proc~r8mat_print&#45;&gt;proc~r8mat_print_some</title>
<path fill="none" stroke="#ff00aa" d="M499.23,-428C507.14,-428 515.83,-428 524.55,-428"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="524.74,-431.5 534.74,-428 524.74,-424.5 524.74,-431.5"/>
</g>
<!-- proc~hybrd&#45;&gt;proc~qform -->
<g id="program~~test_minpack~~CallsGraph_edge52" class="edge">
<title>proc~hybrd&#45;&gt;proc~qform</title>
<path fill="none" stroke="#ffda00" d="M376.75,-541.69C389.68,-528.46 411.38,-507.14 432,-491 433.35,-489.95 434.74,-488.9 436.17,-487.86"/>
<polygon fill="#ffda00" stroke="#ffda00" points="438.27,-490.66 444.51,-482.1 434.29,-484.9 438.27,-490.66"/>
</g>
<!-- proc~hybrd&#45;&gt;proc~qrfac -->
<g id="program~~test_minpack~~CallsGraph_edge53" class="edge">
<title>proc~hybrd&#45;&gt;proc~qrfac</title>
<path fill="none" stroke="#ffda00" d="M371.37,-541.54C377.78,-528.9 387.85,-508.72 396,-491 412.97,-454.1 414.18,-443.5 432,-407 438.27,-394.16 445.96,-380.13 452.28,-368.98"/>
<polygon fill="#ffda00" stroke="#ffda00" points="455.48,-370.44 457.42,-360.02 449.41,-366.95 455.48,-370.44"/>
</g>
<!-- proc~hybrd&#45;&gt;proc~enorm -->
<g id="program~~test_minpack~~CallsGraph_edge50" class="edge">
<title>proc~hybrd&#45;&gt;proc~enorm</title>
<path fill="none" stroke="#ffda00" d="M373.27,-566.1C384.5,-581.34 406.17,-606.76 432,-617 459.68,-627.97 476.23,-636.19 499,-617 571.4,-555.96 501.42,-495.54 535,-407 543.13,-385.55 557.34,-363.57 568.36,-348.26"/>
<polygon fill="#ffda00" stroke="#ffda00" points="571.29,-350.19 574.42,-340.07 565.66,-346.03 571.29,-350.19"/>
</g>
<!-- proc~dogleg -->
<g id="program~~test_minpack~~CallsGraph_node38" class="node">
<title>proc~dogleg</title>
<g id="a_program~~test_minpack~~CallsGraph_node38"><a xlink:href="../proc/dogleg.html" xlink:title="dogleg">
<polygon fill="#d9534f" stroke="#d9534f" points="492.5,-608 438.5,-608 438.5,-584 492.5,-584 492.5,-608"/>
<text text-anchor="middle" x="465.5" y="-593.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dogleg</text>
</a>
</g>
</g>
<!-- proc~hybrd&#45;&gt;proc~dogleg -->
<g id="program~~test_minpack~~CallsGraph_edge49" class="edge">
<title>proc~hybrd&#45;&gt;proc~dogleg</title>
<path fill="none" stroke="#ffda00" d="M391.14,-565.04C402.7,-569.92 416.48,-575.73 428.96,-581"/>
<polygon fill="#ffda00" stroke="#ffda00" points="427.61,-584.23 438.19,-584.89 430.33,-577.78 427.61,-584.23"/>
</g>
<!-- proc~fdjac1 -->
<g id="program~~test_minpack~~CallsGraph_node39" class="node">
<title>proc~fdjac1</title>
<g id="a_program~~test_minpack~~CallsGraph_node39"><a xlink:href="../proc/fdjac1.html" xlink:title="fdjac1">
<polygon fill="#d9534f" stroke="#d9534f" points="492.5,-688 438.5,-688 438.5,-664 492.5,-664 492.5,-688"/>
<text text-anchor="middle" x="465.5" y="-673.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fdjac1</text>
</a>
</g>
</g>
<!-- proc~hybrd&#45;&gt;proc~fdjac1 -->
<g id="program~~test_minpack~~CallsGraph_edge51" class="edge">
<title>proc~hybrd&#45;&gt;proc~fdjac1</title>
<path fill="none" stroke="#ffda00" d="M371.85,-566.03C383.01,-585.05 406.44,-622.71 432,-650 434.32,-652.48 436.89,-654.92 439.53,-657.26"/>
<polygon fill="#ffda00" stroke="#ffda00" points="437.58,-660.2 447.51,-663.9 442.05,-654.81 437.58,-660.2"/>
</g>
<!-- proc~r1mpyq -->
<g id="program~~test_minpack~~CallsGraph_node42" class="node">
<title>proc~r1mpyq</title>
<g id="a_program~~test_minpack~~CallsGraph_node42"><a xlink:href="../proc/r1mpyq.html" xlink:title="r1mpyq">
<polygon fill="#d9534f" stroke="#d9534f" points="492.5,-566 438.5,-566 438.5,-542 492.5,-542 492.5,-566"/>
<text text-anchor="middle" x="465.5" y="-551.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">r1mpyq</text>
</a>
</g>
</g>
<!-- proc~hybrd&#45;&gt;proc~r1mpyq -->
<g id="program~~test_minpack~~CallsGraph_edge54" class="edge">
<title>proc~hybrd&#45;&gt;proc~r1mpyq</title>
<path fill="none" stroke="#ffda00" d="M391.14,-554C402.36,-554 415.67,-554 427.85,-554"/>
<polygon fill="#ffda00" stroke="#ffda00" points="428.19,-557.5 438.19,-554 428.19,-550.5 428.19,-557.5"/>
</g>
<!-- proc~r1updt -->
<g id="program~~test_minpack~~CallsGraph_node43" class="node">
<title>proc~r1updt</title>
<g id="a_program~~test_minpack~~CallsGraph_node43"><a xlink:href="../proc/r1updt.html" xlink:title="r1updt">
<polygon fill="#d9534f" stroke="#d9534f" points="492.5,-524 438.5,-524 438.5,-500 492.5,-500 492.5,-524"/>
<text text-anchor="middle" x="465.5" y="-509.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">r1updt</text>
</a>
</g>
</g>
<!-- proc~hybrd&#45;&gt;proc~r1updt -->
<g id="program~~test_minpack~~CallsGraph_edge55" class="edge">
<title>proc~hybrd&#45;&gt;proc~r1updt</title>
<path fill="none" stroke="#ffda00" d="M391.14,-542.96C402.7,-538.08 416.48,-532.27 428.96,-527"/>
<polygon fill="#ffda00" stroke="#ffda00" points="430.33,-530.22 438.19,-523.11 427.61,-523.77 430.33,-530.22"/>
</g>
<!-- proc~hybrj&#45;&gt;proc~qform -->
<g id="program~~test_minpack~~CallsGraph_edge58" class="edge">
<title>proc~hybrj&#45;&gt;proc~qform</title>
<path fill="none" stroke="#48ff00" d="M391.14,-470C402.36,-470 415.67,-470 427.85,-470"/>
<polygon fill="#48ff00" stroke="#48ff00" points="428.19,-473.5 438.19,-470 428.19,-466.5 428.19,-473.5"/>
</g>
<!-- proc~hybrj&#45;&gt;proc~qrfac -->
<g id="program~~test_minpack~~CallsGraph_edge59" class="edge">
<title>proc~hybrj&#45;&gt;proc~qrfac</title>
<path fill="none" stroke="#48ff00" d="M386.25,-457.84C389.78,-455.22 393.2,-452.25 396,-449 420.14,-421 408.99,-402.94 432,-374 433.9,-371.61 436.05,-369.31 438.33,-367.12"/>
<polygon fill="#48ff00" stroke="#48ff00" points="441.06,-369.39 446.33,-360.2 436.48,-364.09 441.06,-369.39"/>
</g>
<!-- proc~hybrj&#45;&gt;proc~enorm -->
<g id="program~~test_minpack~~CallsGraph_edge57" class="edge">
<title>proc~hybrj&#45;&gt;proc~enorm</title>
<path fill="none" stroke="#48ff00" d="M384.61,-457.88C388.53,-455.14 392.51,-452.12 396,-449 414.34,-432.63 412.74,-422.28 432,-407 442.15,-398.94 508.95,-365.23 550.55,-344.54"/>
<polygon fill="#48ff00" stroke="#48ff00" points="552.12,-347.66 559.52,-340.08 549.01,-341.39 552.12,-347.66"/>
</g>
<!-- proc~hybrj&#45;&gt;proc~dogleg -->
<g id="program~~test_minpack~~CallsGraph_edge56" class="edge">
<title>proc~hybrj&#45;&gt;proc~dogleg</title>
<path fill="none" stroke="#48ff00" d="M370.6,-482.19C380.64,-503.06 403.34,-546.17 432,-575 432.91,-575.91 433.86,-576.8 434.84,-577.67"/>
<polygon fill="#48ff00" stroke="#48ff00" points="432.82,-580.54 442.87,-583.9 437.11,-575.01 432.82,-580.54"/>
</g>
<!-- proc~hybrj&#45;&gt;proc~r1mpyq -->
<g id="program~~test_minpack~~CallsGraph_edge60" class="edge">
<title>proc~hybrj&#45;&gt;proc~r1mpyq</title>
<path fill="none" stroke="#48ff00" d="M376.75,-482.31C389.68,-495.54 411.38,-516.86 432,-533 433.35,-534.05 434.74,-535.1 436.17,-536.14"/>
<polygon fill="#48ff00" stroke="#48ff00" points="434.29,-539.1 444.51,-541.9 438.27,-533.34 434.29,-539.1"/>
</g>
<!-- proc~hybrj&#45;&gt;proc~r1updt -->
<g id="program~~test_minpack~~CallsGraph_edge61" class="edge">
<title>proc~hybrj&#45;&gt;proc~r1updt</title>
<path fill="none" stroke="#48ff00" d="M391.14,-481.04C402.7,-485.92 416.48,-491.73 428.96,-497"/>
<polygon fill="#48ff00" stroke="#48ff00" points="427.61,-500.23 438.19,-500.89 430.33,-493.78 427.61,-500.23"/>
</g>
<!-- proc~lmder&#45;&gt;proc~qrfac -->
<g id="program~~test_minpack~~CallsGraph_edge64" class="edge">
<title>proc~lmder&#45;&gt;proc~qrfac</title>
<path fill="none" stroke="#00ff91" d="M391.14,-333.25C402.48,-335.53 415.94,-338.24 428.22,-340.71"/>
<polygon fill="#00ff91" stroke="#00ff91" points="427.69,-344.17 438.19,-342.71 429.07,-337.31 427.69,-344.17"/>
</g>
<!-- proc~lmder&#45;&gt;proc~enorm -->
<g id="program~~test_minpack~~CallsGraph_edge62" class="edge">
<title>proc~lmder&#45;&gt;proc~enorm</title>
<path fill="none" stroke="#00ff91" d="M391.09,-327.52C403.48,-327.32 418.51,-327.1 432,-327 461.78,-326.78 469.22,-326.82 499,-327 514.91,-327.09 532.5,-327.29 547.53,-327.48"/>
<polygon fill="#00ff91" stroke="#00ff91" points="547.91,-330.98 557.96,-327.61 548.01,-323.98 547.91,-330.98"/>
</g>
<!-- proc~lmpar -->
<g id="program~~test_minpack~~CallsGraph_node41" class="node">
<title>proc~lmpar</title>
<g id="a_program~~test_minpack~~CallsGraph_node41"><a xlink:href="../proc/lmpar.html" xlink:title="lmpar">
<polygon fill="#d9534f" stroke="#d9534f" points="492.5,-242 438.5,-242 438.5,-218 492.5,-218 492.5,-242"/>
<text text-anchor="middle" x="465.5" y="-227.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lmpar</text>
</a>
</g>
</g>
<!-- proc~lmder&#45;&gt;proc~lmpar -->
<g id="program~~test_minpack~~CallsGraph_edge63" class="edge">
<title>proc~lmder&#45;&gt;proc~lmpar</title>
<path fill="none" stroke="#00ff91" d="M377.2,-315.98C394.13,-299.31 424.94,-268.96 445.06,-249.14"/>
<polygon fill="#00ff91" stroke="#00ff91" points="447.53,-251.63 452.2,-242.12 442.62,-246.64 447.53,-251.63"/>
</g>
<!-- proc~lmdif&#45;&gt;proc~qrfac -->
<g id="program~~test_minpack~~CallsGraph_edge68" class="edge">
<title>proc~lmdif&#45;&gt;proc~qrfac</title>
<path fill="none" stroke="#0091ff" d="M371.22,-160.13C377.51,-172.42 387.49,-192 396,-209 416.8,-250.57 440.73,-299.34 454.09,-326.66"/>
<polygon fill="#0091ff" stroke="#0091ff" points="450.97,-328.25 458.5,-335.7 457.26,-325.18 450.97,-328.25"/>
</g>
<!-- proc~lmdif&#45;&gt;proc~enorm -->
<g id="program~~test_minpack~~CallsGraph_edge65" class="edge">
<title>proc~lmdif&#45;&gt;proc~enorm</title>
<path fill="none" stroke="#0091ff" d="M391.03,-144.64C420.31,-142.33 467.84,-143.15 499,-167 531.25,-191.69 516.03,-215.08 535,-251 545.42,-270.73 559.19,-292.04 569.49,-307.23"/>
<polygon fill="#0091ff" stroke="#0091ff" points="566.84,-309.57 575.38,-315.83 572.61,-305.61 566.84,-309.57"/>
</g>
<!-- proc~fdjac2 -->
<g id="program~~test_minpack~~CallsGraph_node40" class="node">
<title>proc~fdjac2</title>
<g id="a_program~~test_minpack~~CallsGraph_node40"><a xlink:href="../proc/fdjac2.html" xlink:title="fdjac2">
<polygon fill="#d9534f" stroke="#d9534f" points="492.5,-120 438.5,-120 438.5,-96 492.5,-96 492.5,-120"/>
<text text-anchor="middle" x="465.5" y="-105.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fdjac2</text>
</a>
</g>
</g>
<!-- proc~lmdif&#45;&gt;proc~fdjac2 -->
<g id="program~~test_minpack~~CallsGraph_edge66" class="edge">
<title>proc~lmdif&#45;&gt;proc~fdjac2</title>
<path fill="none" stroke="#0091ff" d="M391.14,-137.49C402.59,-132.89 416.21,-127.41 428.59,-122.44"/>
<polygon fill="#0091ff" stroke="#0091ff" points="430.21,-125.56 438.19,-118.58 427.6,-119.06 430.21,-125.56"/>
</g>
<!-- proc~lmdif&#45;&gt;proc~lmpar -->
<g id="program~~test_minpack~~CallsGraph_edge67" class="edge">
<title>proc~lmdif&#45;&gt;proc~lmpar</title>
<path fill="none" stroke="#0091ff" d="M377.3,-160.35C390.34,-173.16 411.81,-193.45 432,-209 433.35,-210.04 434.76,-211.09 436.19,-212.12"/>
<polygon fill="#0091ff" stroke="#0091ff" points="434.32,-215.08 444.55,-217.85 438.28,-209.31 434.32,-215.08"/>
</g>
<!-- proc~lmstr&#45;&gt;proc~qrfac -->
<g id="program~~test_minpack~~CallsGraph_edge71" class="edge">
<title>proc~lmstr&#45;&gt;proc~qrfac</title>
<path fill="none" stroke="#4800ff" d="M375.27,-242.18C392.4,-262.5 426.96,-303.48 447.68,-328.05"/>
<polygon fill="#4800ff" stroke="#4800ff" points="445.01,-330.32 454.13,-335.71 450.36,-325.8 445.01,-330.32"/>
</g>
<!-- proc~lmstr&#45;&gt;proc~enorm -->
<g id="program~~test_minpack~~CallsGraph_edge69" class="edge">
<title>proc~lmstr&#45;&gt;proc~enorm</title>
<path fill="none" stroke="#4800ff" d="M391.42,-241.82C430.74,-259.42 504.73,-292.53 548.67,-312.19"/>
<polygon fill="#4800ff" stroke="#4800ff" points="547.27,-315.4 557.83,-316.29 550.13,-309.01 547.27,-315.4"/>
</g>
<!-- proc~lmstr&#45;&gt;proc~lmpar -->
<g id="program~~test_minpack~~CallsGraph_edge70" class="edge">
<title>proc~lmstr&#45;&gt;proc~lmpar</title>
<path fill="none" stroke="#4800ff" d="M391.14,-230C402.36,-230 415.67,-230 427.85,-230"/>
<polygon fill="#4800ff" stroke="#4800ff" points="428.19,-233.5 438.19,-230 428.19,-226.5 428.19,-233.5"/>
</g>
<!-- proc~rwupdt -->
<g id="program~~test_minpack~~CallsGraph_node44" class="node">
<title>proc~rwupdt</title>
<g id="a_program~~test_minpack~~CallsGraph_node44"><a xlink:href="../proc/rwupdt.html" xlink:title="rwupdt">
<polygon fill="#d9534f" stroke="#d9534f" points="492.5,-200 438.5,-200 438.5,-176 492.5,-176 492.5,-200"/>
<text text-anchor="middle" x="465.5" y="-185.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rwupdt</text>
</a>
</g>
</g>
<!-- proc~lmstr&#45;&gt;proc~rwupdt -->
<g id="program~~test_minpack~~CallsGraph_edge72" class="edge">
<title>proc~lmstr&#45;&gt;proc~rwupdt</title>
<path fill="none" stroke="#4800ff" d="M391.14,-218.96C402.7,-214.08 416.48,-208.27 428.96,-203"/>
<polygon fill="#4800ff" stroke="#4800ff" points="430.33,-206.22 438.19,-199.11 427.61,-199.77 430.33,-206.22"/>
</g>
<!-- proc~dogleg&#45;&gt;proc~enorm -->
<g id="program~~test_minpack~~CallsGraph_edge73" class="edge">
<title>proc~dogleg&#45;&gt;proc~enorm</title>
<path fill="none" stroke="#ff0000" d="M490.45,-583.75C493.71,-581.23 496.71,-578.32 499,-575 542.38,-512.15 506.45,-477.83 535,-407 543.57,-385.73 557.73,-363.73 568.63,-348.36"/>
<polygon fill="#ff0000" stroke="#ff0000" points="571.55,-350.29 574.6,-340.14 565.89,-346.18 571.55,-350.29"/>
</g>
<!-- proc~lmpar&#45;&gt;proc~enorm -->
<g id="program~~test_minpack~~CallsGraph_edge74" class="edge">
<title>proc~lmpar&#45;&gt;proc~enorm</title>
<path fill="none" stroke="#00ff91" d="M481.78,-242.08C487.24,-246.44 493.42,-251.41 499,-256 520.68,-273.85 545.12,-294.62 562.21,-309.25"/>
<polygon fill="#00ff91" stroke="#00ff91" points="560.09,-312.05 569.96,-315.9 564.65,-306.74 560.09,-312.05"/>
</g>
<!-- proc~qrsolv -->
<g id="program~~test_minpack~~CallsGraph_node45" class="node">
<title>proc~qrsolv</title>
<g id="a_program~~test_minpack~~CallsGraph_node45"><a xlink:href="../proc/qrsolv.html" xlink:title="qrsolv">
<polygon fill="#d9534f" stroke="#d9534f" points="612,-242 558,-242 558,-218 612,-218 612,-242"/>
<text text-anchor="middle" x="585" y="-227.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">qrsolv</text>
</a>
</g>
</g>
<!-- proc~lmpar&#45;&gt;proc~qrsolv -->
<g id="program~~test_minpack~~CallsGraph_edge75" class="edge">
<title>proc~lmpar&#45;&gt;proc~qrsolv</title>
<path fill="none" stroke="#00ff91" d="M492.58,-230C508.85,-230 530.04,-230 547.91,-230"/>
<polygon fill="#00ff91" stroke="#00ff91" points="548,-233.5 558,-230 548,-226.5 548,-233.5"/>
</g>
</g>
</svg>
</div>                <script>
                  var panprogramtest_minpackCallsGraph = svgPanZoom('#programtest_minpackCallsGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CallsGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CallsGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="29pt"
 viewBox="0.00 0.00 641.00 29.32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.92 0.92) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 695.5,-28 695.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,0 64,0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,0 136,0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,0 209.5,0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="350,-24 228,-24 228,0 350,0 350,-24"/>
<text text-anchor="middle" x="289" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="504,-24 368,-24 368,0 504,0 504,-24"/>
<text text-anchor="middle" x="436" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="576,-24 522,-24 522,0 576,0 576,-24"/>
<text text-anchor="middle" x="549" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="691.5,-24 594.5,-24 594.5,0 691.5,0 691.5,-24"/>
<text text-anchor="middle" x="643" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 Where possible, edges connecting nodes are
given different colours to make them easier to distinguish in
large graphs.</div>
            </div>
          </div>
        </div>
      </div>
    </div>
<br>

    <section>
    <h2>Variables</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-rk"></span>
              integer,
            </td>
            <td>
parameter               
            </td>
            <td>::</td>
            <td><strong>rk</strong></td>
<td> =</td>
                <td>kind(1.0D+00)</td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    
    
    

    


    <section>
    <h2>Subroutines</h2>
      <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-chkder_f"></span> <h3> subroutine <a href='../proc/chkder_f.html'>chkder_f</a>(n, x, fvec, fjac, ldfjac, iflag)  
</h3></div>
    <div class="card-body">
          
  <p>CHKDER_F is a function/jacobian routine for use with CHKDER_TEST.</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-n~88"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>n</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-x~52"></span>
              real(kind=rk)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>x</strong>(n)</td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fvec~16"></span>
              real(kind=rk)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>fvec</strong>(n)</td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fjac~15"></span>
              real(kind=rk)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>fjac</strong>(ldfjac,n)</td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ldfjac~15"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>ldfjac</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iflag~9"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>iflag</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

      <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-chkder_test"></span> <h3> subroutine <a href='../proc/chkder_test.html'>chkder_test</a>()  
</h3></div>
    <div class="card-body">
          
  <p>CHKDER_TEST tests CHKDER.</p>

  <h4>Arguments</h4>
    <em>None</em>

    </div>
  </div>

      <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-hybrd1_f"></span> <h3> subroutine <a href='../proc/hybrd1_f.html'>hybrd1_f</a>(n, x, fvec, iflag)  
</h3></div>
    <div class="card-body">
          
  <p>HYBRD1_F is a function routine for use with HYBRD1_TEST.</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-n~90"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>n</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-x~54"></span>
              real(kind=rk)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>x</strong>(n)</td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fvec~18"></span>
              real(kind=rk)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>fvec</strong>(n)</td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iflag~11"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>iflag</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

      <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-hybrd1_test"></span> <h3> subroutine <a href='../proc/hybrd1_test.html'>hybrd1_test</a>()  
</h3></div>
    <div class="card-body">
          
  <p>HYBRD1_TEST tests HYBRD1.</p>

  <h4>Arguments</h4>
    <em>None</em>

    </div>
  </div>

      <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-hybrj1_f"></span> <h3> subroutine <a href='../proc/hybrj1_f.html'>hybrj1_f</a>(n, x, fvec, fjac, ldfjac, iflag)  
</h3></div>
    <div class="card-body">
          
  <p>HYBRJ1_F is a function/jacobian routine for use with HYBRJ1_TEST.</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-n~92"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>n</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-x~56"></span>
              real(kind=rk)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>x</strong>(n)</td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fvec~20"></span>
              real(kind=rk)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>fvec</strong>(n)</td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fjac~17"></span>
              real(kind=rk)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>fjac</strong>(ldfjac,n)</td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ldfjac~17"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>ldfjac</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iflag~13"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>iflag</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

      <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-hybrj1_test"></span> <h3> subroutine <a href='../proc/hybrj1_test.html'>hybrj1_test</a>()  
</h3></div>
    <div class="card-body">
          
  <p>HYBRJ1_TEST tests HYBRJ1.</p>

  <h4>Arguments</h4>
    <em>None</em>

    </div>
  </div>

      <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-lmder1_2_f"></span> <h3> subroutine <a href='../proc/lmder1_2_f.html'>lmder1_2_f</a>(m, n, x, fvec, fjac, ldfjac, iflag)  
</h3></div>
    <div class="card-body">
          
  <p>LMDER1_2_F is a function/jacobian routine for use with LMDER1_2_TEST.</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-m~27"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>m</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-n~96"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>n</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-x~60"></span>
              real(kind=rk)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>x</strong>(n)</td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fvec~24"></span>
              real(kind=rk)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>fvec</strong>(m)</td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fjac~21"></span>
              real(kind=rk)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>fjac</strong>(ldfjac,n)</td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ldfjac~21"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>ldfjac</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iflag~17"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>iflag</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

      <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-lmder1_2_test"></span> <h3> subroutine <a href='../proc/lmder1_2_test.html'>lmder1_2_test</a>()  
</h3></div>
    <div class="card-body">
          
  <p>LMDER1_2_TEST tests LMDER1.</p>

  <h4>Arguments</h4>
    <em>None</em>

    </div>
  </div>

      <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-lmder1_f"></span> <h3> subroutine <a href='../proc/lmder1_f.html'>lmder1_f</a>(m, n, x, fvec, fjac, ldfjac, iflag)  
</h3></div>
    <div class="card-body">
          
  <p>LMDER1_F is a function/jacobian routine for use with LMDER1_TEST.</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-m~25"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>m</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-n~94"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>n</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-x~58"></span>
              real(kind=rk)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>x</strong>(n)</td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fvec~22"></span>
              real(kind=rk)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>fvec</strong>(m)</td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fjac~19"></span>
              real(kind=rk)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>fjac</strong>(ldfjac,n)</td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ldfjac~19"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>ldfjac</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iflag~15"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>iflag</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

      <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-lmder1_test"></span> <h3> subroutine <a href='../proc/lmder1_test.html'>lmder1_test</a>()  
</h3></div>
    <div class="card-body">
          
  <p>LMDER1_TEST tests LMDER1.</p>

  <h4>Arguments</h4>
    <em>None</em>

    </div>
  </div>

      <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-lmdif1_2_f"></span> <h3> subroutine <a href='../proc/lmdif1_2_f.html'>lmdif1_2_f</a>(m, n, x, fvec, iflag)  
</h3></div>
    <div class="card-body">
          
  <p>LMDIF1_2_F is a function routine for use with LMDIF1_2_TEST.</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-m~31"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>m</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-n~100"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>n</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-x~64"></span>
              real(kind=rk)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>x</strong>(n)</td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fvec~28"></span>
              real(kind=rk)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>fvec</strong>(m)</td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iflag~21"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>iflag</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

      <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-lmdif1_2_test"></span> <h3> subroutine <a href='../proc/lmdif1_2_test.html'>lmdif1_2_test</a>()  
</h3></div>
    <div class="card-body">
          
  <p>LMDIF1_2_TEST tests LMDIF1.</p>

  <h4>Arguments</h4>
    <em>None</em>

    </div>
  </div>

      <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-lmdif1_f"></span> <h3> subroutine <a href='../proc/lmdif1_f.html'>lmdif1_f</a>(m, n, x, fvec, iflag)  
</h3></div>
    <div class="card-body">
          
  <p>LMDIF1_F is a function routine for use with LMDIF1_TEST.</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-m~29"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>m</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-n~98"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>n</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-x~62"></span>
              real(kind=rk)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>x</strong>(n)</td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fvec~26"></span>
              real(kind=rk)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>fvec</strong>(m)</td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iflag~19"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>iflag</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

      <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-lmdif1_test"></span> <h3> subroutine <a href='../proc/lmdif1_test.html'>lmdif1_test</a>()  
</h3></div>
    <div class="card-body">
          
  <p>LMDIF1_TEST tests LMDIF1.</p>

  <h4>Arguments</h4>
    <em>None</em>

    </div>
  </div>

      <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-lmstr1_2_f"></span> <h3> subroutine <a href='../proc/lmstr1_2_f.html'>lmstr1_2_f</a>(m, n, x, fvec, fjrow, iflag)  
</h3></div>
    <div class="card-body">
          
  <p>LMSTR1_2_F is a function/jacobian routine for use with LMSTR1_2_TEST.</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-m~35"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>m</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-n~104"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>n</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-x~68"></span>
              real(kind=rk)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>x</strong>(n)</td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fvec~32"></span>
              real(kind=rk)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>fvec</strong>(m)</td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fjrow~4"></span>
              real(kind=rk)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>fjrow</strong>(n)</td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iflag~25"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>iflag</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

      <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-lmstr1_2_test"></span> <h3> subroutine <a href='../proc/lmstr1_2_test.html'>lmstr1_2_test</a>()  
</h3></div>
    <div class="card-body">
          
  <p>LMSTR1_2_TEST tests LMSTR1.</p>

  <h4>Arguments</h4>
    <em>None</em>

    </div>
  </div>

      <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-lmstr1_f"></span> <h3> subroutine <a href='../proc/lmstr1_f.html'>lmstr1_f</a>(m, n, x, fvec, fjrow, iflag)  
</h3></div>
    <div class="card-body">
          
  <p>LMSTR1_F is a function/jacobian routine for use with LMSTR1_TEST.</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-m~33"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>m</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-n~102"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>n</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-x~66"></span>
              real(kind=rk)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>x</strong>(n)</td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fvec~30"></span>
              real(kind=rk)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>fvec</strong>(m)</td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fjrow~2"></span>
              real(kind=rk)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>fjrow</strong>(n)</td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iflag~23"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>iflag</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

      <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-lmstr1_test"></span> <h3> subroutine <a href='../proc/lmstr1_test.html'>lmstr1_test</a>()  
</h3></div>
    <div class="card-body">
          
  <p>LMSTR1_TEST tests LMSTR1.</p>

  <h4>Arguments</h4>
    <em>None</em>

    </div>
  </div>

      <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-qform_test"></span> <h3> subroutine <a href='../proc/qform_test.html'>qform_test</a>()  
</h3></div>
    <div class="card-body">
          
  <p>QFORM_TEST tests QFORM.</p>

  <h4>Arguments</h4>
    <em>None</em>

    </div>
  </div>

    </section>    
    

    <section>
    <h2 id="src">Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="k">program </span><span class="n">test_minpack</span>
<span class="k">use </span><span class="n">minpack</span>
<span class="c">!*****************************************************************************80</span>
<span class="c">!</span>
<span class="c">! minpack_test() tests minpack().</span>
<span class="c">!</span>
<span class="c">!  Licensing:</span>
<span class="c">!</span>
<span class="c">!    This code is distributed under the GNU LGPL license.</span>
<span class="c">!</span>
<span class="c">!  Modified:</span>
<span class="c">!</span>
<span class="c">!    02 January 2018</span>
<span class="c">!</span>
<span class="c">!  Author:</span>
<span class="c">!</span>
<span class="c">!    John Burkardt</span>
<span class="c">!</span>
<span class="w">  </span><span class="k">implicit none</span>

<span class="k">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mf">1.0D+00</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="k">call </span><span class="n">timestamp</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; &#39;</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;minpack_test():&#39;</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;  FORTRAN90 version&#39;</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;  Test minpack().&#39;</span>

<span class="w">  </span><span class="k">call </span><span class="n">chkder_test</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="k">call </span><span class="n">hybrd1_test</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="k">call </span><span class="n">hybrj1_test</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="k">call </span><span class="n">lmder1_test</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="k">call </span><span class="n">lmder1_2_test</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="k">call </span><span class="n">lmdif1_test</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="k">call </span><span class="n">lmdif1_2_test</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="k">call </span><span class="n">lmstr1_test</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="k">call </span><span class="n">lmstr1_2_test</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="k">call </span><span class="n">qform_test</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">)</span>
<span class="c">!</span>
<span class="c">!  Terminate.</span>
<span class="c">!</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; &#39;</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;minpack_test():&#39;</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;  Normal end of execution.&#39;</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; &#39;</span>
<span class="w">  </span><span class="k">call </span><span class="n">timestamp</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="k">stop </span><span class="mi">0</span>

<span class="k">contains</span>

<span class="k">subroutine </span><span class="n">chkder_test</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">)</span>

<span class="c">!*****************************************************************************80</span>
<span class="c">!</span>
<span class="c">!! CHKDER_TEST tests CHKDER.</span>
<span class="c">!</span>
<span class="c">!  Licensing:</span>
<span class="c">!</span>
<span class="c">!    This code is distributed under the GNU LGPL license.</span>
<span class="c">!</span>
<span class="c">!  Modified:</span>
<span class="c">!</span>
<span class="c">!    30 December 2004</span>
<span class="c">!</span>
<span class="c">!  Author:</span>
<span class="c">!</span>
<span class="c">!    John Burkardt</span>
<span class="c">!</span>
<span class="w">  </span><span class="k">implicit none</span>

<span class="k">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mf">1.0D+00</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span>
<span class="w">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span>
<span class="w">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ldfjac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span>

<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">err</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">fjac</span><span class="p">(</span><span class="n">ldfjac</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">fvec</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">fvecp</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">i</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">ido</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">iflag</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">mode</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">xp</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; &#39;</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;CHKDER_TEST&#39;</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;  CHKDER compares a user supplied jacobian&#39;</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;  and a finite difference approximation to it&#39;</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;  and judges whether the jacobian is correct.&#39;</span>

<span class="w">  </span><span class="k">do </span><span class="n">ido</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ido</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">      write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; &#39;</span>
<span class="w">      </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;  On the first test, use a correct jacobian.&#39;</span>

<span class="w">    </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ido</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">       write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; &#39;</span>
<span class="w">       </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;  Repeat the test, but use a &quot;bad&quot; jacobian&#39;</span>
<span class="w">       </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;  and see if the routine notices!&#39;</span>

<span class="w">     </span><span class="k">end if</span>
<span class="c">!</span>
<span class="c">!  Set the point at which the test is to be made:</span>
<span class="c">!</span>
<span class="w">    </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5D+00</span>

<span class="w">    </span><span class="k">call </span><span class="n">r8vec_print</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  Evaluation point X:&#39;</span><span class="w"> </span><span class="p">)</span>

<span class="w">    </span><span class="n">mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="k">call </span><span class="n">chkder</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="n">fjac</span><span class="p">,</span><span class="w"> </span><span class="n">ldfjac</span><span class="p">,</span><span class="w"> </span><span class="n">xp</span><span class="p">,</span><span class="w"> </span><span class="n">fvecp</span><span class="p">,</span><span class="w"> </span><span class="n">mode</span><span class="p">,</span><span class="w"> </span><span class="n">err</span><span class="w"> </span><span class="p">)</span>

<span class="w">    </span><span class="n">iflag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>

<span class="w">    </span><span class="k">call </span><span class="n">chkder_f</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="n">fjac</span><span class="p">,</span><span class="w"> </span><span class="n">ldfjac</span><span class="p">,</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="k">call </span><span class="n">chkder_f</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">xp</span><span class="p">,</span><span class="w"> </span><span class="n">fvecp</span><span class="p">,</span><span class="w"> </span><span class="n">fjac</span><span class="p">,</span><span class="w"> </span><span class="n">ldfjac</span><span class="p">,</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="p">)</span>

<span class="w">    </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; &#39;</span>
<span class="w">    </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;  Sampled function values F(X) and F(XP)&#39;</span>
<span class="w">    </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; &#39;</span>
<span class="w">    </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">m</span>
<span class="w">      </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(i3,2g14.6)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">fvecp</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">    </span><span class="k">end do</span>

<span class="k">    </span><span class="n">iflag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
<span class="w">    </span><span class="k">call </span><span class="n">chkder_f</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="n">fjac</span><span class="p">,</span><span class="w"> </span><span class="n">ldfjac</span><span class="p">,</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="p">)</span>
<span class="c">!</span>
<span class="c">!  Here&#39;s where we put a mistake into the jacobian, on purpose.</span>
<span class="c">!</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ido</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">fjac</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.01D+00</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">fjac</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="w">      </span><span class="n">fjac</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">fjac</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="w">    </span><span class="k">end if</span>

<span class="k">    write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; &#39;</span>
<span class="w">    </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;  Computed jacobian&#39;</span>
<span class="w">    </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; &#39;</span>
<span class="w">    </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">m</span>
<span class="w">      </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(5g14.6)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">fjac</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">)</span>
<span class="w">    </span><span class="k">end do</span>

<span class="k">    </span><span class="n">mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
<span class="w">    </span><span class="k">call </span><span class="n">chkder</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="n">fjac</span><span class="p">,</span><span class="w"> </span><span class="n">ldfjac</span><span class="p">,</span><span class="w"> </span><span class="n">xp</span><span class="p">,</span><span class="w"> </span><span class="n">fvecp</span><span class="p">,</span><span class="w"> </span><span class="n">mode</span><span class="p">,</span><span class="w"> </span><span class="n">err</span><span class="w"> </span><span class="p">)</span>

<span class="w">    </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; &#39;</span>
<span class="w">    </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;  CHKDER gradient component error estimates:&#39;</span>
<span class="w">    </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;     &gt; 0.5, the component is probably correct.&#39;</span>
<span class="w">    </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;     &lt; 0.5, the component is probably incorrect.&#39;</span>
<span class="w">    </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; &#39;</span>
<span class="w">    </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">m</span>
<span class="w">      </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(i6,g14.6)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">err</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">    </span><span class="k">end do</span>

<span class="k">  end do</span>

<span class="k">  return</span>
<span class="k">end</span>
<span class="k">subroutine </span><span class="n">chkder_f</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="n">fjac</span><span class="p">,</span><span class="w"> </span><span class="n">ldfjac</span><span class="p">,</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="p">)</span>

<span class="c">!*****************************************************************************80</span>
<span class="c">!</span>
<span class="c">!! CHKDER_F is a function/jacobian routine for use with CHKDER_TEST.</span>
<span class="c">!</span>
<span class="c">!  Licensing:</span>
<span class="c">!</span>
<span class="c">!    This code is distributed under the GNU LGPL license.</span>
<span class="c">!</span>
<span class="c">!  Modified:</span>
<span class="c">!</span>
<span class="c">!    17 May 2001</span>
<span class="c">!</span>
<span class="c">!  Author:</span>
<span class="c">!</span>
<span class="c">!    John Burkardt</span>
<span class="c">!</span>
<span class="c">!  Parameters:</span>
<span class="c">!</span>
<span class="c">!    Input, integer N, the number of variables.</span>
<span class="c">!</span>
<span class="c">!    Input, real ( kind = rk ) X(N), the variable values.</span>
<span class="c">!</span>
<span class="c">!    Output, real ( kind = rk ) FVEC(N), the function values at X,</span>
<span class="c">!    if IFLAG = 1.</span>
<span class="c">!</span>
<span class="c">!    Output, real ( kind = rk ) FJAC(LDFJAC,N), the N by N jacobian at X,</span>
<span class="c">!    if IFLAG = 2.</span>
<span class="c">!</span>
<span class="c">!    Input, integer LDFJAC, the leading dimension of FJAC,</span>
<span class="c">!    which must be at least N.</span>
<span class="c">!</span>
<span class="c">!    Input, integer IFLAG:</span>
<span class="c">!    0, user requests printout of current iterate X.</span>
<span class="c">!    1, please compute F(I) (X).</span>
<span class="c">!    2, please compute FJAC(I,J) (X).</span>
<span class="c">!</span>
<span class="w">  </span><span class="k">implicit none</span>

<span class="k">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mf">1.0D+00</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="kt">integer </span><span class="n">ldfjac</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">n</span>

<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">fjac</span><span class="p">(</span><span class="n">ldfjac</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">fvec</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">i</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">iflag</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">j</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">prod</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="c">!</span>
<span class="c">!  If IFLAG is 0, print out X (and anything else about this iterate).</span>
<span class="c">!</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">    write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;&#39;</span>
<span class="w">    </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">      </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(g14.6)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">    </span><span class="k">end do</span>
<span class="c">!</span>
<span class="c">!  If IFLAG is 1, we are supposed to evaluate F(X).</span>
<span class="c">!</span>
<span class="w">  </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">    do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">      </span><span class="n">fvec</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">sum</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="k">end do</span>

<span class="k">    </span><span class="n">fvec</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">product</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1.0D+00</span>
<span class="c">!</span>
<span class="c">!  If IFLAG is 2, we are supposed to evaluate FJAC(I,J) = d F(I)/d X(J)</span>
<span class="c">!</span>
<span class="w">  </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">    </span><span class="n">fjac</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0D+00</span>

<span class="w">    </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">      </span><span class="n">fjac</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0D+00</span>
<span class="w">    </span><span class="k">end do</span>

<span class="k">    </span><span class="n">prod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">product</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>

<span class="w">    </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">      </span><span class="n">fjac</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prod</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<span class="w">    </span><span class="k">end do</span>

<span class="k">  end if</span>

<span class="k">  return</span>
<span class="k">end</span>
<span class="k">subroutine </span><span class="n">hybrd1_test</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">)</span>

<span class="c">!*****************************************************************************80</span>
<span class="c">!</span>
<span class="c">!! HYBRD1_TEST tests HYBRD1.</span>
<span class="c">!</span>
<span class="c">!  Discussion:</span>
<span class="c">!</span>
<span class="c">!    This is an example of what your main program would look</span>
<span class="c">!    like if you wanted to use MINPACK to solve N nonlinear equations</span>
<span class="c">!    in N unknowns.  In this version, we avoid computing the jacobian</span>
<span class="c">!    matrix, and request that MINPACK approximate it for us.</span>
<span class="c">!</span>
<span class="c">!    The set of nonlinear equations is:</span>
<span class="c">!</span>
<span class="c">!      x1^2 - 10 * x1 + x2^2 + 8 = 0</span>
<span class="c">!      x1 * x2^2 + x1 - 10 * x2 + 8 = 0</span>
<span class="c">!</span>
<span class="c">!    with solution x1 = x2 = 1</span>
<span class="c">!</span>
<span class="c">!  Licensing:</span>
<span class="c">!</span>
<span class="c">!    This code is distributed under the GNU LGPL license.</span>
<span class="c">!</span>
<span class="c">!  Modified:</span>
<span class="c">!</span>
<span class="c">!    30 December 2004</span>
<span class="c">!</span>
<span class="c">!  Author:</span>
<span class="c">!</span>
<span class="c">!    John Burkardt</span>
<span class="c">!</span>
<span class="w">  </span><span class="k">implicit none</span>

<span class="k">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mf">1.0D+00</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>

<span class="c">!~   external hybrd1_f</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">fvec</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">iflag</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">info</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">tol</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; &#39;</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;HYBRD1_TEST&#39;</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;  HYBRD1 solves a nonlinear system of equations.&#39;</span>

<span class="w">  </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="w"> </span><span class="mf">3.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0D+00</span><span class="w"> </span><span class="o">/</span><span class="p">)</span>
<span class="w">  </span><span class="k">call </span><span class="n">r8vec_print</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  Initial X:&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="k">call </span><span class="n">hybrd1_f</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="k">call </span><span class="n">r8vec_print</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  Initial F(X):&#39;</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="n">tol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.00001D+00</span>

<span class="w">  </span><span class="k">call </span><span class="n">hybrd1</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">hybrd1_f</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="n">tol</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; &#39;</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a,i6)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;  Returned value of INFO = &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">info</span>
<span class="w">  </span><span class="k">call </span><span class="n">r8vec_print</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  Final X:&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="k">call </span><span class="n">r8vec_print</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  Final F(X):&#39;</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="k">return</span>
<span class="k">end</span>
<span class="k">subroutine </span><span class="n">hybrd1_f</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="p">)</span>

<span class="c">!*****************************************************************************80</span>
<span class="c">!</span>
<span class="c">!! HYBRD1_F is a function routine for use with HYBRD1_TEST.</span>
<span class="c">!</span>
<span class="c">!  Licensing:</span>
<span class="c">!</span>
<span class="c">!    This code is distributed under the GNU LGPL license.</span>
<span class="c">!</span>
<span class="c">!  Modified:</span>
<span class="c">!</span>
<span class="c">!    19 August 2016</span>
<span class="c">!</span>
<span class="c">!  Author:</span>
<span class="c">!</span>
<span class="c">!    John Burkardt</span>
<span class="c">!</span>
<span class="c">!  Input:</span>
<span class="c">!</span>
<span class="c">!    integer N, the number of variables.</span>
<span class="c">!</span>
<span class="c">!    real ( kind = rk ) X(N), the variable values.</span>
<span class="c">!</span>
<span class="c">!  Output:</span>
<span class="c">!</span>
<span class="c">!    real ( kind = rk ) FVEC(N), the function values at X,</span>
<span class="c">!    if IFLAG = 1.</span>
<span class="c">!</span>
<span class="c">!    integer IFLAG, error flag.</span>
<span class="c">!    If IFLAG &lt; 0, an error has occurred and the computation should stop.</span>
<span class="c">!</span>
<span class="w">  </span><span class="k">implicit none</span>

<span class="k">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mf">1.0D+00</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="kt">integer </span><span class="n">n</span>

<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">fvec</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">iflag</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

<span class="w">  </span><span class="n">fvec</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="mf">0.0D+00</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">8.0D+00</span>
<span class="w">  </span><span class="n">fvec</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="mf">0.0D+00</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">8.0D+00</span>
<span class="w">  </span><span class="n">iflag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>

<span class="w">  </span><span class="k">return</span>
<span class="k">end</span>
<span class="k">subroutine </span><span class="n">hybrj1_test</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">)</span>

<span class="c">!*****************************************************************************80</span>
<span class="c">!</span>
<span class="c">!! HYBRJ1_TEST tests HYBRJ1.</span>
<span class="c">!</span>
<span class="c">!  Licensing:</span>
<span class="c">!</span>
<span class="c">!    This code is distributed under the GNU LGPL license.</span>
<span class="c">!</span>
<span class="c">!  Modified:</span>
<span class="c">!</span>
<span class="c">!    30 December 2004</span>
<span class="c">!</span>
<span class="c">!  Author:</span>
<span class="c">!</span>
<span class="c">!    John Burkardt</span>
<span class="c">!</span>
<span class="w">  </span><span class="k">implicit none</span>

<span class="k">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mf">1.0D+00</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
<span class="w">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ldfjac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span>

<span class="c">!~   external hybrj1_f</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">fjac</span><span class="p">(</span><span class="n">ldfjac</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">fvec</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">iflag</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">info</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">tol</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; &#39;</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;HYBRJ1_TEST&#39;</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;  HYBRJ1 solves a nonlinear system of equations.&#39;</span>

<span class="w">  </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="w"> </span><span class="mf">3.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0D+00</span><span class="w"> </span><span class="o">/</span><span class="p">)</span>
<span class="w">  </span><span class="k">call </span><span class="n">r8vec_print</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  Initial X:&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="k">call </span><span class="n">hybrd1_f</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="k">call </span><span class="n">r8vec_print</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  F(X):&#39;</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="n">tol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.00001D+00</span>

<span class="w">  </span><span class="k">call </span><span class="n">hybrj1</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">hybrj1_f</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="n">fjac</span><span class="p">,</span><span class="w"> </span><span class="n">ldfjac</span><span class="p">,</span><span class="w"> </span><span class="n">tol</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; &#39;</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a,i6)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;  Returned value of INFO = &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">info</span>
<span class="w">  </span><span class="k">call </span><span class="n">r8vec_print</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  X:&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="k">call </span><span class="n">r8vec_print</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  F(X):&#39;</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="k">return</span>
<span class="k">end</span>
<span class="k">subroutine </span><span class="n">hybrj1_f</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="n">fjac</span><span class="p">,</span><span class="w"> </span><span class="n">ldfjac</span><span class="p">,</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="p">)</span>

<span class="c">!*****************************************************************************80</span>
<span class="c">!</span>
<span class="c">!! HYBRJ1_F is a function/jacobian routine for use with HYBRJ1_TEST.</span>
<span class="c">!</span>
<span class="c">!  Licensing:</span>
<span class="c">!</span>
<span class="c">!    This code is distributed under the GNU LGPL license.</span>
<span class="c">!</span>
<span class="c">!  Modified:</span>
<span class="c">!</span>
<span class="c">!    30 December 2004</span>
<span class="c">!</span>
<span class="c">!  Author:</span>
<span class="c">!</span>
<span class="c">!    John Burkardt</span>
<span class="c">!</span>
<span class="c">!  Parameters:</span>
<span class="c">!</span>
<span class="c">!    Input, integer N, the number of variables.</span>
<span class="c">!</span>
<span class="c">!    Input, real ( kind = rk ) X(N), the variable values.</span>
<span class="c">!</span>
<span class="c">!    Output, real ( kind = rk ) FVEC(N), the function values at X,</span>
<span class="c">!    if IFLAG = 1.</span>
<span class="c">!</span>
<span class="c">!    Output, real ( kind = rk ) FJAC(LDFJAC,N), the N by N jacobian at X,</span>
<span class="c">!    if IFLAG = 2.</span>
<span class="c">!</span>
<span class="c">!    Input, integer LDFJAC, the leading dimension of FJAC,</span>
<span class="c">!    which must be at least N.</span>
<span class="c">!</span>
<span class="c">!    Input, integer IFLAG:</span>
<span class="c">!    0, user requests printout of current iterate X.</span>
<span class="c">!    1, please compute F(I) (X).</span>
<span class="c">!    2, please compute FJAC(I,J) (X).</span>
<span class="c">!</span>
<span class="w">  </span><span class="k">implicit none</span>

<span class="k">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mf">1.0D+00</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="kt">integer </span><span class="n">ldfjac</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">n</span>

<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">fjac</span><span class="p">(</span><span class="n">ldfjac</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">fvec</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">i</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">iflag</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">    write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;&#39;</span>
<span class="w">    </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">      </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(g14.6)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">    </span><span class="k">end do</span>

<span class="k">  else if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">    </span><span class="n">fvec</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="mf">0.0D+00</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">8.0D+00</span>
<span class="w">    </span><span class="n">fvec</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="mf">0.0D+00</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">8.0D+00</span>

<span class="w">  </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">    </span><span class="n">fjac</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0D+00</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="mf">0.0D+00</span>
<span class="w">    </span><span class="n">fjac</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0D+00</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="w">    </span><span class="n">fjac</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1.0D+00</span>
<span class="w">    </span><span class="n">fjac</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0D+00</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="mf">0.0D+00</span>

<span class="w">  </span><span class="k">end if</span>

<span class="k">  return</span>
<span class="k">end</span>
<span class="k">subroutine </span><span class="n">lmder1_test</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">)</span>

<span class="c">!*****************************************************************************80</span>
<span class="c">!</span>
<span class="c">!! LMDER1_TEST tests LMDER1.</span>
<span class="c">!</span>
<span class="c">!  Discussion:</span>
<span class="c">!</span>
<span class="c">!    LMDER1 solves M nonlinear equations in N unknowns, with M &gt;= N.</span>
<span class="c">!</span>
<span class="c">!    LMDER1 seeks a solution X minimizing the euclidean norm of the residual.</span>
<span class="c">!</span>
<span class="c">!    In this example, the set of equations is actually linear, but</span>
<span class="c">!    normally they are nonlinear.</span>
<span class="c">!</span>
<span class="c">!    In this problem, we have a set of pairs of data points, and we</span>
<span class="c">!    seek a functional relationship between them.  We assume the</span>
<span class="c">!    relationship is of the form</span>
<span class="c">!</span>
<span class="c">!      y = a * x + b</span>
<span class="c">!</span>
<span class="c">!    and we want to know the values of a and b.  Therefore, we would like</span>
<span class="c">!    to find numbers a and b which satisfy a set of equations.</span>
<span class="c">!</span>
<span class="c">!    The data points are (2,2), (4,11), (6,28) and (8,40).</span>
<span class="c">!</span>
<span class="c">!    Therefore, the equations we want to satisfy are:</span>
<span class="c">!</span>
<span class="c">!      a * 2 + b -  2 = 0</span>
<span class="c">!      a * 4 + b - 11 = 0</span>
<span class="c">!      a * 6 + b - 28 = 0</span>
<span class="c">!      a * 8 + b - 40 = 0</span>
<span class="c">!</span>
<span class="c">!    The least squares solution of this system is a=6.55, b=-12.5,</span>
<span class="c">!    In other words, the line y=6.55*x-12.5 is the line which &quot;best&quot;</span>
<span class="c">!    models the data in the least squares sense.</span>
<span class="c">!</span>
<span class="c">!    Problems with more variables, or higher degree polynomials, would</span>
<span class="c">!    be solved similarly.  For example, suppose we have (x,y,z) data,</span>
<span class="c">!    and we wish to find a relationship of the form f(x,y,z).  We assume</span>
<span class="c">!    that x and y occur linearly, and z quadratically.  Then the equation</span>
<span class="c">!    we seek has the form:</span>
<span class="c">!</span>
<span class="c">!      a*x+b*y+c*z + d*z*z + e = 0</span>
<span class="c">!</span>
<span class="c">!    and, supposing that our first two points were (1,2,3), (1,3,8), our set of</span>
<span class="c">!    equations would begin:</span>
<span class="c">!</span>
<span class="c">!      a*1+b*2+c*3 + d*9  + e = 0</span>
<span class="c">!      a*1+b*3+c*8 + d*64 + e = 0</span>
<span class="c">!</span>
<span class="c">!    and so on.</span>
<span class="c">!</span>
<span class="c">!    M is the number of equations, which in this case is the number of</span>
<span class="c">!    (x,y) data values.</span>
<span class="c">!</span>
<span class="c">!    N is the number of variables, which in this case is the number of</span>
<span class="c">!    &#39;free&#39; coefficients in the relationship we are trying to determine.</span>
<span class="c">!</span>
<span class="c">!  Licensing:</span>
<span class="c">!</span>
<span class="c">!    This code is distributed under the GNU LGPL license.</span>
<span class="c">!</span>
<span class="c">!  Modified:</span>
<span class="c">!</span>
<span class="c">!    31 October 2005</span>
<span class="c">!</span>
<span class="c">!  Author:</span>
<span class="c">!</span>
<span class="c">!    John Burkardt</span>
<span class="c">!</span>
<span class="w">  </span><span class="k">implicit none</span>

<span class="k">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mf">1.0D+00</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span>
<span class="w">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
<span class="w">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ldfjac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span>

<span class="c">!~   external lmder1_f</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">fjac</span><span class="p">(</span><span class="n">ldfjac</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">fvec</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">iflag</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">info</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">tol</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; &#39;</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;LMDER1_TEST&#39;</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;  LMDER1 minimizes M functions in N variables.&#39;</span>

<span class="w">  </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="w"> </span><span class="mf">0.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mf">5.0D+00</span><span class="w"> </span><span class="o">/</span><span class="p">)</span>
<span class="w">  </span><span class="k">call </span><span class="n">r8vec_print</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  Initial X:&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="n">iflag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">  </span><span class="k">call </span><span class="n">lmder1_f</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="n">fjac</span><span class="p">,</span><span class="w"> </span><span class="n">ldfjac</span><span class="p">,</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="k">call </span><span class="n">r8vec_print</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  F(X):&#39;</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="n">tol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.00001D+00</span>

<span class="w">  </span><span class="k">call </span><span class="n">lmder1</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">lmder1_f</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="n">fjac</span><span class="p">,</span><span class="w"> </span><span class="n">ldfjac</span><span class="p">,</span><span class="w"> </span><span class="n">tol</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; &#39;</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a,i6)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;  Returned value of INFO = &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">info</span>
<span class="w">  </span><span class="k">call </span><span class="n">r8vec_print</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  X:&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="k">call </span><span class="n">r8vec_print</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  F(X):&#39;</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="k">return</span>
<span class="k">end</span>
<span class="k">subroutine </span><span class="n">lmder1_f</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="n">fjac</span><span class="p">,</span><span class="w"> </span><span class="n">ldfjac</span><span class="p">,</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="p">)</span>

<span class="c">!*****************************************************************************80</span>
<span class="c">!</span>
<span class="c">!! LMDER1_F is a function/jacobian routine for use with LMDER1_TEST.</span>
<span class="c">!</span>
<span class="c">!  Licensing:</span>
<span class="c">!</span>
<span class="c">!    This code is distributed under the GNU LGPL license.</span>
<span class="c">!</span>
<span class="c">!  Modified:</span>
<span class="c">!</span>
<span class="c">!    30 December 2004</span>
<span class="c">!</span>
<span class="c">!  Author:</span>
<span class="c">!</span>
<span class="c">!    John Burkardt</span>
<span class="c">!</span>
<span class="c">!  Input:</span>
<span class="c">!</span>
<span class="c">!    integer N, the number of variables.</span>
<span class="c">!</span>
<span class="c">!    real ( kind = rk ) X(N), the variable values.</span>
<span class="c">!</span>
<span class="c">!    Input, integer LDFJAC, the leading dimension of FJAC,</span>
<span class="c">!    which must be at least N.</span>
<span class="c">!</span>
<span class="c">!    Input, integer IFLAG:</span>
<span class="c">!    0, user requests printout of current iterate X.</span>
<span class="c">!    1, please compute F(I) (X).</span>
<span class="c">!    2, please compute FJAC(I,J) (X).</span>
<span class="c">!</span>
<span class="c">!  Output:</span>
<span class="c">!</span>
<span class="c">!    real ( kind = rk ) FVEC(N), the function values at X,</span>
<span class="c">!    if IFLAG = 1.</span>
<span class="c">!</span>
<span class="c">!    real ( kind = rk ) FJAC(LDFJAC,N), the N by N jacobian at X,</span>
<span class="c">!    if IFLAG = 2.</span>
<span class="c">!</span>
<span class="w">  </span><span class="k">implicit none</span>

<span class="k">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mf">1.0D+00</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="kt">integer </span><span class="n">ldfjac</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">m</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">n</span>

<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">fjac</span><span class="p">(</span><span class="n">ldfjac</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">fvec</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">i</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">iflag</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xdat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">    </span><span class="mf">2.0D+00</span><span class="p">,</span><span class="w">  </span><span class="mf">4.0D+00</span><span class="p">,</span><span class="w">  </span><span class="mf">6.0D+00</span><span class="p">,</span><span class="w">  </span><span class="mf">8.0D+00</span><span class="w"> </span><span class="o">/</span><span class="p">)</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ydat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">    </span><span class="mf">2.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="mf">1.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="mf">8.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="mf">0.0D+00</span><span class="w"> </span><span class="o">/</span><span class="p">)</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">    write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;&#39;</span>
<span class="w">    </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">      </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(g14.6)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">    </span><span class="k">end do</span>

<span class="k">  else if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">    </span><span class="n">fvec</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xdat</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ydat</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="p">)</span>

<span class="w">  </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">    </span><span class="n">fjac</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xdat</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="p">)</span>
<span class="w">    </span><span class="n">fjac</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0D+00</span>

<span class="w">  </span><span class="k">else</span>

<span class="k">    write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; &#39;</span>
<span class="w">    </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;LMDER1_F - Fatal error!&#39;</span>
<span class="w">    </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a,i6)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;  Called with unexpected value of IFLAG = &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">iflag</span>
<span class="w">    </span><span class="k">stop</span>

<span class="k">  end if</span>

<span class="k">  return</span>
<span class="k">end</span>
<span class="k">subroutine </span><span class="n">lmder1_2_test</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">)</span>

<span class="c">!*****************************************************************************80</span>
<span class="c">!</span>
<span class="c">!! LMDER1_2_TEST tests LMDER1.</span>
<span class="c">!</span>
<span class="c">!  Discussion:</span>
<span class="c">!</span>
<span class="c">!    LMDER1 solves M nonlinear equations in n unknowns, where M is greater</span>
<span class="c">!    than N.  The functional fit is nonlinear this time, of the form</span>
<span class="c">!</span>
<span class="c">!      y=a+b*x^c,</span>
<span class="c">!</span>
<span class="c">!    with x and y data, and a, b and c unknown.</span>
<span class="c">!</span>
<span class="c">!    This problem is set up so that the data is exactly fit by by</span>
<span class="c">!    a=1, b=3, c=2.  Normally, the data would only be approximately</span>
<span class="c">!    fit by the best possible solution.</span>
<span class="c">!</span>
<span class="c">!  Licensing:</span>
<span class="c">!</span>
<span class="c">!    This code is distributed under the GNU LGPL license.</span>
<span class="c">!</span>
<span class="c">!  Modified:</span>
<span class="c">!</span>
<span class="c">!    30 December 2004</span>
<span class="c">!</span>
<span class="c">!  Author:</span>
<span class="c">!</span>
<span class="c">!    John Burkardt</span>
<span class="c">!</span>
<span class="w">  </span><span class="k">implicit none</span>

<span class="k">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mf">1.0D+00</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span>
<span class="w">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span>
<span class="w">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ldfjac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span>

<span class="c">!~   external lmder1_2_f</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">fjac</span><span class="p">(</span><span class="n">ldfjac</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">fvec</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">iflag</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">info</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">tol</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; &#39;</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;LMDER1_2_TEST&#39;</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;  LMDER1 minimizes M functions in N variables.&#39;</span>

<span class="w">  </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="w"> </span><span class="mf">0.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mf">5.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mf">1.3D+00</span><span class="w"> </span><span class="o">/</span><span class="p">)</span>
<span class="w">  </span><span class="k">call </span><span class="n">r8vec_print</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  Initial X:&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="n">iflag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">  </span><span class="k">call </span><span class="n">lmder1_2_f</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="n">fjac</span><span class="p">,</span><span class="w"> </span><span class="n">ldfjac</span><span class="p">,</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="k">call </span><span class="n">r8vec_print</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  F(X):&#39;</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="n">tol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.00001D+00</span>

<span class="w">  </span><span class="k">call </span><span class="n">lmder1</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">lmder1_2_f</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="n">fjac</span><span class="p">,</span><span class="w"> </span><span class="n">ldfjac</span><span class="p">,</span><span class="w"> </span><span class="n">tol</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; &#39;</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a,i6)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;  Returned value of INFO = &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">info</span>
<span class="w">  </span><span class="k">call </span><span class="n">r8vec_print</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  X:&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="k">call </span><span class="n">r8vec_print</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  F(X):&#39;</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="k">return</span>
<span class="k">end</span>
<span class="k">subroutine </span><span class="n">lmder1_2_f</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="n">fjac</span><span class="p">,</span><span class="w"> </span><span class="n">ldfjac</span><span class="p">,</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="p">)</span>

<span class="c">!*****************************************************************************80</span>
<span class="c">!</span>
<span class="c">!! LMDER1_2_F is a function/jacobian routine for use with LMDER1_2_TEST.</span>
<span class="c">!</span>
<span class="c">!  Licensing:</span>
<span class="c">!</span>
<span class="c">!    This code is distributed under the GNU LGPL license.</span>
<span class="c">!</span>
<span class="c">!  Modified:</span>
<span class="c">!</span>
<span class="c">!    30 December 2004</span>
<span class="c">!</span>
<span class="c">!  Author:</span>
<span class="c">!</span>
<span class="c">!    John Burkardt</span>
<span class="c">!</span>
<span class="c">!  Parameters:</span>
<span class="c">!</span>
<span class="c">!    Input, integer N, the number of variables.</span>
<span class="c">!</span>
<span class="c">!    Input, real ( kind = rk ) X(N), the variable values.</span>
<span class="c">!</span>
<span class="c">!    Output, real ( kind = rk ) FVEC(N), the function values at X,</span>
<span class="c">!    if IFLAG = 1.</span>
<span class="c">!</span>
<span class="c">!    Output, real ( kind = rk ) FJAC(LDFJAC,N), the N by N jacobian at X,</span>
<span class="c">!    if IFLAG = 2.</span>
<span class="c">!</span>
<span class="c">!    Input, integer LDFJAC, the leading dimension of FJAC,</span>
<span class="c">!    which must be at least N.</span>
<span class="c">!</span>
<span class="c">!    Input, integer IFLAG:</span>
<span class="c">!    0, user requests printout of current iterate X.</span>
<span class="c">!    1, please compute F(I) (X).</span>
<span class="c">!    2, please compute FJAC(I,J) (X).</span>
<span class="c">!</span>
<span class="w">  </span><span class="k">implicit none</span>

<span class="k">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mf">1.0D+00</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="kt">integer </span><span class="n">ldfjac</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">m</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">n</span>

<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">fjac</span><span class="p">(</span><span class="n">ldfjac</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">fvec</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">i</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">iflag</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xdat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">    </span><span class="mf">1.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mf">2.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mf">3.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mf">4.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mf">5.0D+00</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">    </span><span class="mf">6.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mf">7.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mf">8.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mf">9.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="mf">0.0D+00</span><span class="w"> </span><span class="o">/</span><span class="p">)</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ydat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">    </span><span class="mf">4.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="mf">3.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="mf">8.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="mf">9.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="mf">6.0D+00</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">    </span><span class="mi">10</span><span class="mf">9.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="mf">8.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mi">19</span><span class="mf">3.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mi">24</span><span class="mf">4.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="mf">1.0D+00</span><span class="w"> </span><span class="o">/</span><span class="p">)</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">    write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;&#39;</span>
<span class="w">    </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">      </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(g14.6)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">    </span><span class="k">end do</span>

<span class="k">  else if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">    </span><span class="n">fvec</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xdat</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="o">**</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ydat</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="p">)</span>

<span class="w">  </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">    </span><span class="n">fjac</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0D+00</span>
<span class="w">    </span><span class="n">fjac</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xdat</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="o">**</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="w">    </span><span class="n">fjac</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">log</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">xdat</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xdat</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="o">**</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="w">  </span><span class="k">end if</span>

<span class="k">  return</span>
<span class="k">end</span>
<span class="k">subroutine </span><span class="n">lmdif1_test</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">)</span>

<span class="c">!*****************************************************************************80</span>
<span class="c">!</span>
<span class="c">!! LMDIF1_TEST tests LMDIF1.</span>
<span class="c">!</span>
<span class="c">!  Discussion:</span>
<span class="c">!</span>
<span class="c">!    LMDIF1 solves M nonlinear equations in N unknowns, where M is greater</span>
<span class="c">!    than N.  Generally, you cannot get a solution vector x which will satisfy</span>
<span class="c">!    all the equations.  That is, the vector equation f(x)=0 cannot</span>
<span class="c">!    be solved exactly.  Instead, minpack seeks a solution x so that</span>
<span class="c">!    the euclidean norm transpose(f(x))*f(x) is minimized.  The size</span>
<span class="c">!    of the euclidean norm is a measure of how good the solution is.</span>
<span class="c">!</span>
<span class="c">!    In this example, the set of equations is actually linear, but</span>
<span class="c">!    normally they are nonlinear.</span>
<span class="c">!</span>
<span class="c">!    In this problem, we have a set of pairs of data points, and we</span>
<span class="c">!    seek a functional relationship between them.  We assume the</span>
<span class="c">!    relationship is of the form</span>
<span class="c">!</span>
<span class="c">!      y=a*x+b</span>
<span class="c">!</span>
<span class="c">!    and we want to know the values of a and b.  Therefore, we would like</span>
<span class="c">!    to find numbers a and b which satisfy a set of equations.</span>
<span class="c">!</span>
<span class="c">!    The data points are (2,2), (4,11), (6,28) and (8,40).</span>
<span class="c">!</span>
<span class="c">!    Therefore, the equations we want to satisfy are:</span>
<span class="c">!</span>
<span class="c">!      a * 2 + b -  2 = 0</span>
<span class="c">!      a * 4 + b - 11 = 0</span>
<span class="c">!      a * 6 + b - 28 = 0</span>
<span class="c">!      a * 8 + b - 40 = 0</span>
<span class="c">!</span>
<span class="c">!    The least squares solution of this system is a=6.55, b=-12.5,</span>
<span class="c">!    In other words, the line y=6.55*x-12.5 is the line which &quot;best&quot;</span>
<span class="c">!    models the data in the least squares sense.</span>
<span class="c">!</span>
<span class="c">!    Problems with more variables, or higher degree polynomials, would</span>
<span class="c">!    be solved similarly.  For example, suppose we have (x,y,z) data,</span>
<span class="c">!    and we wish to find a relationship of the form f(x,y,z).  We assume</span>
<span class="c">!    that x and y occur linearly, and z quadratically.  Then the equation</span>
<span class="c">!    we seek has the form:</span>
<span class="c">!</span>
<span class="c">!      a*x+b*y+c*z + d*z*z + e = 0</span>
<span class="c">!</span>
<span class="c">!    and, supposing that our first two points were (1,2,3), (1,3,8), our set of</span>
<span class="c">!    equations would begin:</span>
<span class="c">!</span>
<span class="c">!      a*1+b*2+c*3 + d*9  + e = 0</span>
<span class="c">!      a*1+b*3+c*8 + d*64 + e = 0</span>
<span class="c">!</span>
<span class="c">!    and so on.</span>
<span class="c">!</span>
<span class="c">!    M is the number of equations, which in this case is the number of</span>
<span class="c">!    (x,y) data values.</span>
<span class="c">!</span>
<span class="c">!    N is the number of variables, which in this case is the number of</span>
<span class="c">!    &#39;free&#39; coefficients in the relationship we are trying to determine.</span>
<span class="c">!</span>
<span class="c">!  Licensing:</span>
<span class="c">!</span>
<span class="c">!    This code is distributed under the GNU LGPL license.</span>
<span class="c">!</span>
<span class="c">!  Modified:</span>
<span class="c">!</span>
<span class="c">!    30 December 2004</span>
<span class="c">!</span>
<span class="c">!  Author:</span>
<span class="c">!</span>
<span class="c">!    John Burkardt</span>
<span class="c">!</span>
<span class="w">  </span><span class="k">implicit none</span>

<span class="k">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mf">1.0D+00</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span>
<span class="w">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>

<span class="c">!~   external lmdif1_f</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">fvec</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">iflag</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">info</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">tol</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; &#39;</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;LMDIF1_TEST&#39;</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;  LMDIF1 minimizes M functions in N variables.&#39;</span>

<span class="w">  </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="w"> </span><span class="mf">0.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mf">5.0D+00</span><span class="w"> </span><span class="o">/</span><span class="p">)</span>
<span class="w">  </span><span class="k">call </span><span class="n">r8vec_print</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  Initial X:&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="n">iflag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">  </span><span class="k">call </span><span class="n">lmdif1_f</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="k">call </span><span class="n">r8vec_print</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  F(X):&#39;</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="n">tol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.00001D+00</span>

<span class="w">  </span><span class="k">call </span><span class="n">lmdif1</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">lmdif1_f</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="n">tol</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; &#39;</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a,i6)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;  Returned value of INFO = &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">info</span>
<span class="w">  </span><span class="k">call </span><span class="n">r8vec_print</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  X:&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="k">call </span><span class="n">r8vec_print</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  F(X):&#39;</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="k">return</span>
<span class="k">end</span>
<span class="k">subroutine </span><span class="n">lmdif1_f</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="p">)</span>

<span class="c">!*****************************************************************************80</span>
<span class="c">!</span>
<span class="c">!! LMDIF1_F is a function routine for use with LMDIF1_TEST.</span>
<span class="c">!</span>
<span class="c">!  Licensing:</span>
<span class="c">!</span>
<span class="c">!    This code is distributed under the GNU LGPL license.</span>
<span class="c">!</span>
<span class="c">!  Modified:</span>
<span class="c">!</span>
<span class="c">!    30 December 2004</span>
<span class="c">!</span>
<span class="c">!  Author:</span>
<span class="c">!</span>
<span class="c">!    John Burkardt</span>
<span class="c">!</span>
<span class="c">!  Parameters:</span>
<span class="c">!</span>
<span class="c">!    Input, integer M, the number of functions.</span>
<span class="c">!</span>
<span class="c">!    Input, integer N, the number of variables.</span>
<span class="c">!</span>
<span class="c">!    Input, real ( kind = rk ) X(N), the variable values.</span>
<span class="c">!</span>
<span class="c">!    Output, real ( kind = rk ) FVEC(M), the function values at X,</span>
<span class="c">!    if IFLAG = 1.</span>
<span class="c">!</span>
<span class="c">!    Input, integer IFLAG:</span>
<span class="c">!    0, user requests printout of current iterate X.</span>
<span class="c">!    1, please compute F(I) (X).</span>
<span class="c">!</span>
<span class="w">  </span><span class="k">implicit none</span>

<span class="k">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mf">1.0D+00</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="kt">integer </span><span class="n">m</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">n</span>

<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">fvec</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">i</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">iflag</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xdat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">    </span><span class="mf">2.0D+00</span><span class="p">,</span><span class="w">  </span><span class="mf">4.0D+00</span><span class="p">,</span><span class="w">  </span><span class="mf">6.0D+00</span><span class="p">,</span><span class="w">  </span><span class="mf">8.0D+00</span><span class="w"> </span><span class="o">/</span><span class="p">)</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ydat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">    </span><span class="mf">2.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="mf">1.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="mf">8.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="mf">0.0D+00</span><span class="w"> </span><span class="o">/</span><span class="p">)</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">    write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;&#39;</span>
<span class="w">    </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">      </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(g14.6)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">    </span><span class="k">end do</span>

<span class="k">  else if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">    </span><span class="n">fvec</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xdat</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ydat</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="p">)</span>

<span class="w">  </span><span class="k">end if</span>

<span class="k">  return</span>
<span class="k">end</span>
<span class="k">subroutine </span><span class="n">lmdif1_2_test</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">)</span>

<span class="c">!*****************************************************************************80</span>
<span class="c">!</span>
<span class="c">!! LMDIF1_2_TEST tests LMDIF1.</span>
<span class="c">!</span>
<span class="c">!  Discussion:</span>
<span class="c">!</span>
<span class="c">!    LMDIF1 solves M nonlinear equations in N unknowns, where M is greater</span>
<span class="c">!    than N.  It is similar to test02, except that the functional fit is</span>
<span class="c">!    nonlinear this time, of the form</span>
<span class="c">!</span>
<span class="c">!      y = a + b * x^c,</span>
<span class="c">!</span>
<span class="c">!    with x and y data, and a, b and c unknown.</span>
<span class="c">!</span>
<span class="c">!    This problem is set up so that the data is exactly fit by by</span>
<span class="c">!    a=1, b=3, c=2.  Normally, the data would only be approximately</span>
<span class="c">!    fit by the best possible solution.</span>
<span class="c">!</span>
<span class="c">!  Licensing:</span>
<span class="c">!</span>
<span class="c">!    This code is distributed under the GNU LGPL license.</span>
<span class="c">!</span>
<span class="c">!  Modified:</span>
<span class="c">!</span>
<span class="c">!    30 December 2004</span>
<span class="c">!</span>
<span class="c">!  Author:</span>
<span class="c">!</span>
<span class="c">!    John Burkardt</span>
<span class="c">!</span>
<span class="w">  </span><span class="k">implicit none</span>

<span class="k">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mf">1.0D+00</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span>
<span class="w">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span>

<span class="c">!~   external lmdif1_2_f</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">fvec</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">iflag</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">info</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">tol</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; &#39;</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;LMDIF1_2_TEST&#39;</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;  LMDIF1 minimizes M functions in N variables.&#39;</span>

<span class="w">  </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="w"> </span><span class="mf">0.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mf">5.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mf">1.3D+00</span><span class="w"> </span><span class="o">/</span><span class="p">)</span>
<span class="w">  </span><span class="k">call </span><span class="n">r8vec_print</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  X:&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="n">iflag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">  </span><span class="k">call </span><span class="n">lmdif1_2_f</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="k">call </span><span class="n">r8vec_print</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  F(X):&#39;</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="n">tol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.00001D+00</span>

<span class="w">  </span><span class="k">call </span><span class="n">lmdif1</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">lmdif1_2_f</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="n">tol</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; &#39;</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a,i6)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;  Returned value of INFO = &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">info</span>
<span class="w">  </span><span class="k">call </span><span class="n">r8vec_print</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  X:&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="k">call </span><span class="n">r8vec_print</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  F(X):&#39;</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="k">return</span>
<span class="k">end</span>
<span class="k">subroutine </span><span class="n">lmdif1_2_f</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="p">)</span>

<span class="c">!*****************************************************************************80</span>
<span class="c">!</span>
<span class="c">!! LMDIF1_2_F is a function routine for use with LMDIF1_2_TEST.</span>
<span class="c">!</span>
<span class="c">!  Licensing:</span>
<span class="c">!</span>
<span class="c">!    This code is distributed under the GNU LGPL license.</span>
<span class="c">!</span>
<span class="c">!  Modified:</span>
<span class="c">!</span>
<span class="c">!    30 December 2004</span>
<span class="c">!</span>
<span class="c">!  Author:</span>
<span class="c">!</span>
<span class="c">!    John Burkardt</span>
<span class="c">!</span>
<span class="c">!  Parameters:</span>
<span class="c">!</span>
<span class="c">!    Input, integer M, the number of functions.</span>
<span class="c">!</span>
<span class="c">!    Input, integer N, the number of variables.</span>
<span class="c">!</span>
<span class="c">!    Input, real ( kind = rk ) X(N), the variable values.</span>
<span class="c">!</span>
<span class="c">!    Output, real ( kind = rk ) FVEC(M), the function values at X,</span>
<span class="c">!    if IFLAG = 1.</span>
<span class="c">!</span>
<span class="c">!    Input, integer IFLAG:</span>
<span class="c">!    0, user requests printout of current iterate X.</span>
<span class="c">!    1, please compute F(I) (X).</span>
<span class="c">!</span>
<span class="w">  </span><span class="k">implicit none</span>

<span class="k">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mf">1.0D+00</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="kt">integer </span><span class="n">m</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">n</span>

<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">fvec</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">i</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">iflag</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xdat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">    </span><span class="mf">1.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mf">2.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mf">3.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mf">4.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mf">5.0D+00</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">    </span><span class="mf">6.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mf">7.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mf">8.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mf">9.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="mf">0.0D+00</span><span class="w"> </span><span class="o">/</span><span class="p">)</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ydat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">    </span><span class="mf">4.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="mf">3.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="mf">8.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="mf">9.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="mf">6.0D+00</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">    </span><span class="mi">10</span><span class="mf">9.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="mf">8.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mi">19</span><span class="mf">3.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mi">24</span><span class="mf">4.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="mf">1.0D+00</span><span class="w"> </span><span class="o">/</span><span class="p">)</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">    write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;&#39;</span>
<span class="w">    </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">      </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(g14.6)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">    </span><span class="k">end do</span>

<span class="k">  else if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">    </span><span class="n">fvec</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xdat</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="o">**</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ydat</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="p">)</span>

<span class="w">  </span><span class="k">end if</span>

<span class="k">  return</span>
<span class="k">end</span>
<span class="k">subroutine </span><span class="n">lmstr1_test</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">)</span>

<span class="c">!*****************************************************************************80</span>
<span class="c">!</span>
<span class="c">!! LMSTR1_TEST tests LMSTR1.</span>
<span class="c">!</span>
<span class="c">!  Discussion:</span>
<span class="c">!</span>
<span class="c">!    LMSTR1 solves M nonlinear equations in N unknowns, where M is greater</span>
<span class="c">!    than N.  Generally, you cannot get a solution vector x which will satisfy</span>
<span class="c">!    all the equations.  That is, the vector equation f(x)=0 cannot</span>
<span class="c">!    be solved exactly.  Instead, minpack seeks a solution x so that</span>
<span class="c">!    the euclidean norm transpose(f(x))*f(x) is minimized.  The size</span>
<span class="c">!    of the euclidean norm is a measure of how good the solution is.</span>
<span class="c">!</span>
<span class="c">!    In this example, the set of equations is actually linear, but</span>
<span class="c">!    normally they are nonlinear.</span>
<span class="c">!</span>
<span class="c">!    In this problem, we have a set of pairs of data points, and we</span>
<span class="c">!    seek a functional relationship between them.  We assume the</span>
<span class="c">!    relationship is of the form</span>
<span class="c">!</span>
<span class="c">!      y=a*x+b</span>
<span class="c">!</span>
<span class="c">!    and we want to know the values of a and b.  Therefore, we would like</span>
<span class="c">!    to find numbers a and b which satisfy a set of equations.</span>
<span class="c">!</span>
<span class="c">!    The data points are (2,2), (4,11), (6,28) and (8,40).</span>
<span class="c">!</span>
<span class="c">!    Therefore, the equations we want to satisfy are:</span>
<span class="c">!</span>
<span class="c">!      a * 2 + b -  2 = 0</span>
<span class="c">!      a * 4 + b - 11 = 0</span>
<span class="c">!      a * 6 + b - 28 = 0</span>
<span class="c">!      a * 8 + b - 40 = 0</span>
<span class="c">!</span>
<span class="c">!    The least squares solution of this system is a=6.55, b=-12.5,</span>
<span class="c">!    In other words, the line y=6.55*x-12.5 is the line which &quot;best&quot;</span>
<span class="c">!    models the data in the least squares sense.</span>
<span class="c">!</span>
<span class="c">!    Problems with more variables, or higher degree polynomials, would</span>
<span class="c">!    be solved similarly.  For example, suppose we have (x,y,z) data,</span>
<span class="c">!    and we wish to find a relationship of the form f(x,y,z).  We assume</span>
<span class="c">!    that x and y occur linearly, and z quadratically.  Then the equation</span>
<span class="c">!    we seek has the form:</span>
<span class="c">!</span>
<span class="c">!      a*x + b*y + c*z + d*z*z + e = 0</span>
<span class="c">!</span>
<span class="c">!    and, supposing that our first two points were (1,2,3), (1,3,8), our set of</span>
<span class="c">!    equations would begin:</span>
<span class="c">!</span>
<span class="c">!      a*1 + b*2 + c*3 + d*9  + e = 0</span>
<span class="c">!      a*1 + b*3 + c*8 + d*64 + e = 0</span>
<span class="c">!</span>
<span class="c">!    and so on.</span>
<span class="c">!</span>
<span class="c">!    M is the number of equations, which in this case is the number of</span>
<span class="c">!    (x,y) data values.</span>
<span class="c">!</span>
<span class="c">!    N is the number of variables, which in this case is the number of</span>
<span class="c">!    &#39;free&#39; coefficients in the relationship we are trying to determine.</span>
<span class="c">!</span>
<span class="c">!    Thanks to Jacques Le Bourlot for pointing out that the line</span>
<span class="c">!      integer fjrow</span>
<span class="c">!    should instead read</span>
<span class="c">!      real ( kind = rk ) fjrow(n)</span>
<span class="c">!    19 August 2016</span>
<span class="c">!</span>
<span class="c">!  Licensing:</span>
<span class="c">!</span>
<span class="c">!    This code is distributed under the GNU LGPL license.</span>
<span class="c">!</span>
<span class="c">!  Modified:</span>
<span class="c">!</span>
<span class="c">!    19 August 2016</span>
<span class="c">!</span>
<span class="c">!  Author:</span>
<span class="c">!</span>
<span class="c">!    John Burkardt</span>
<span class="c">!</span>
<span class="w">  </span><span class="k">implicit none</span>

<span class="k">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mf">1.0D+00</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span>
<span class="w">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
<span class="w">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ldfjac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span>

<span class="c">!~   external lmstr1_f</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">fjac</span><span class="p">(</span><span class="n">ldfjac</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">fjrow</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">fvec</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">iflag</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">info</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">tol</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; &#39;</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;LMSTR1_TEST&#39;</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;  LMSTR1 minimizes M functions in N variables.&#39;</span>

<span class="w">  </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="w"> </span><span class="mf">0.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mf">5.0D+00</span><span class="w"> </span><span class="o">/</span><span class="p">)</span>
<span class="w">  </span><span class="k">call </span><span class="n">r8vec_print</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  Initial X:&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="n">iflag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">  </span><span class="k">call </span><span class="n">lmstr1_f</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="n">fjrow</span><span class="p">,</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="k">call </span><span class="n">r8vec_print</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  F(X):&#39;</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="n">tol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.00001D+00</span>

<span class="w">  </span><span class="k">call </span><span class="n">lmstr1</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">lmstr1_f</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="n">fjac</span><span class="p">,</span><span class="w"> </span><span class="n">ldfjac</span><span class="p">,</span><span class="w"> </span><span class="n">tol</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; &#39;</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a,i6)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;  Returned value of INFO = &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">info</span>
<span class="w">  </span><span class="k">call </span><span class="n">r8vec_print</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  X:&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="k">call </span><span class="n">r8vec_print</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  F(X):&#39;</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="k">return</span>
<span class="k">end</span>
<span class="k">subroutine </span><span class="n">lmstr1_f</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="n">fjrow</span><span class="p">,</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="p">)</span>

<span class="c">!*****************************************************************************80</span>
<span class="c">!</span>
<span class="c">!! LMSTR1_F is a function/jacobian routine for use with LMSTR1_TEST.</span>
<span class="c">!</span>
<span class="c">!  Licensing:</span>
<span class="c">!</span>
<span class="c">!    This code is distributed under the GNU LGPL license.</span>
<span class="c">!</span>
<span class="c">!  Modified:</span>
<span class="c">!</span>
<span class="c">!    30 December 2004</span>
<span class="c">!</span>
<span class="c">!  Author:</span>
<span class="c">!</span>
<span class="c">!    John Burkardt</span>
<span class="c">!</span>
<span class="c">!  Parameters:</span>
<span class="c">!</span>
<span class="c">!    Input, integer M, the number of functions, and the</span>
<span class="c">!    number of rows in the jacobian.</span>
<span class="c">!</span>
<span class="c">!    Input, integer N, the number of variables.</span>
<span class="c">!</span>
<span class="c">!    Input, real ( kind = rk ) X(N), the variable values.</span>
<span class="c">!</span>
<span class="c">!    Output, real ( kind = rk ) FVEC(M), the function values at X,</span>
<span class="c">!    if IFLAG = 1.</span>
<span class="c">!</span>
<span class="c">!    Output, real ( kind = rk ) FJROW(N), space to return one row</span>
<span class="c">!    of the jacobian,  if IFLAG = 2.</span>
<span class="c">!</span>
<span class="c">!    Input, integer LDFJAC, the leading dimension of FJAC,</span>
<span class="c">!    which must be at least N.</span>
<span class="c">!</span>
<span class="c">!    Input, integer IFLAG:</span>
<span class="c">!    0, user requests printout of current iterate X.</span>
<span class="c">!    1, please compute F(I) (X).</span>
<span class="c">!    2, please compute row (I-1) of the jacobian and return it in FJROW.</span>
<span class="c">!</span>
<span class="w">  </span><span class="k">implicit none</span>

<span class="k">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mf">1.0D+00</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="kt">integer </span><span class="n">m</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">n</span>

<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">fjrow</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">fvec</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">iflag</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xdat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">    </span><span class="mf">2.0D+00</span><span class="p">,</span><span class="w">  </span><span class="mf">4.0D+00</span><span class="p">,</span><span class="w">  </span><span class="mf">6.0D+00</span><span class="p">,</span><span class="w">  </span><span class="mf">8.0D+00</span><span class="w"> </span><span class="o">/</span><span class="p">)</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ydat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">    </span><span class="mf">2.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="mf">1.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="mf">8.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="mf">0.0D+00</span><span class="w"> </span><span class="o">/</span><span class="p">)</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">    </span><span class="n">fvec</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xdat</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ydat</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="p">)</span>

<span class="w">  </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">    </span><span class="n">fjrow</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xdat</span><span class="p">(</span><span class="n">iflag</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="n">fjrow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0D+00</span>

<span class="w">  </span><span class="k">end if</span>

<span class="k">  return</span>
<span class="k">end</span>
<span class="k">subroutine </span><span class="n">lmstr1_2_test</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">)</span>

<span class="c">!*****************************************************************************80</span>
<span class="c">!</span>
<span class="c">!! LMSTR1_2_TEST tests LMSTR1.</span>
<span class="c">!</span>
<span class="c">!  Discussion:</span>
<span class="c">!</span>
<span class="c">!    LMSTR1 solves M nonlinear equations in N unknowns, where M is greater</span>
<span class="c">!    than N.  This test is similar to test02, except that the functional fit</span>
<span class="c">!    is nonlinear this time, of the form</span>
<span class="c">!</span>
<span class="c">!      y = a + b * x^c,</span>
<span class="c">!</span>
<span class="c">!    with x and y data, and a, b and c unknown.</span>
<span class="c">!</span>
<span class="c">!    This problem is set up so that the data is exactly fit by by</span>
<span class="c">!    a=1, b=3, c=2.  Normally, the data would only be approximately</span>
<span class="c">!    fit by the best possible solution.</span>
<span class="c">!</span>
<span class="c">!  Licensing:</span>
<span class="c">!</span>
<span class="c">!    This code is distributed under the GNU LGPL license.</span>
<span class="c">!</span>
<span class="c">!  Modified:</span>
<span class="c">!</span>
<span class="c">!    30 December 2004</span>
<span class="c">!</span>
<span class="c">!  Author:</span>
<span class="c">!</span>
<span class="c">!    John Burkardt</span>
<span class="c">!</span>
<span class="w">  </span><span class="k">implicit none</span>

<span class="k">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mf">1.0D+00</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span>
<span class="w">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span>
<span class="w">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ldfjac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span>

<span class="c">!~   external lmstr1_2_f</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">fjac</span><span class="p">(</span><span class="n">ldfjac</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">fjrow</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">fvec</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">iflag</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">info</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">tol</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; &#39;</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;LMSTR1_2_TEST&#39;</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;  LMSTR1 minimizes M functions in N variables.&#39;</span>

<span class="w">  </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="w"> </span><span class="mf">0.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mf">5.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mf">1.3D+00</span><span class="w"> </span><span class="o">/</span><span class="p">)</span>
<span class="w">  </span><span class="k">call </span><span class="n">r8vec_print</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  Initial X:&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="n">iflag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">  </span><span class="k">call </span><span class="n">lmstr1_2_f</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="n">fjrow</span><span class="p">,</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="k">call </span><span class="n">r8vec_print</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  F(X):&#39;</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="n">tol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.00001D+00</span>

<span class="w">  </span><span class="k">call </span><span class="n">lmstr1</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">lmstr1_2_f</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="n">fjac</span><span class="p">,</span><span class="w"> </span><span class="n">ldfjac</span><span class="p">,</span><span class="w"> </span><span class="n">tol</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; &#39;</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a,i6)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;  Returned value of INFO = &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">info</span>
<span class="w">  </span><span class="k">call </span><span class="n">r8vec_print</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  X:&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="k">call </span><span class="n">r8vec_print</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  F(X):&#39;</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="k">return</span>
<span class="k">end</span>
<span class="k">subroutine </span><span class="n">lmstr1_2_f</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="n">fjrow</span><span class="p">,</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="p">)</span>

<span class="c">!*****************************************************************************80</span>
<span class="c">!</span>
<span class="c">!! LMSTR1_2_F is a function/jacobian routine for use with LMSTR1_2_TEST.</span>
<span class="c">!</span>
<span class="c">!  Licensing:</span>
<span class="c">!</span>
<span class="c">!    This code is distributed under the GNU LGPL license.</span>
<span class="c">!</span>
<span class="c">!  Modified:</span>
<span class="c">!</span>
<span class="c">!    30 December 2004</span>
<span class="c">!</span>
<span class="c">!  Author:</span>
<span class="c">!</span>
<span class="c">!    John Burkardt</span>
<span class="c">!</span>
<span class="c">!  Parameters:</span>
<span class="c">!</span>
<span class="c">!    Input, integer M, the number of functions, and the</span>
<span class="c">!    number of rows in the jacobian.</span>
<span class="c">!</span>
<span class="c">!    Input, integer N, the number of variables.</span>
<span class="c">!</span>
<span class="c">!    Input, real ( kind = rk ) X(N), the variable values.</span>
<span class="c">!</span>
<span class="c">!    Output, real ( kind = rk ) FVEC(M), the function values at X,</span>
<span class="c">!    if IFLAG = 1.</span>
<span class="c">!</span>
<span class="c">!    Output, real ( kind = rk ) FJROW(N), space to return one row</span>
<span class="c">!    of the jacobian,  if IFLAG = 2.</span>
<span class="c">!</span>
<span class="c">!    Input, integer LDFJAC, the leading dimension of FJAC,</span>
<span class="c">!    which must be at least N.</span>
<span class="c">!</span>
<span class="c">!    Input, integer IFLAG:</span>
<span class="c">!    0, user requests printout of current iterate X.</span>
<span class="c">!    1, please compute F(I) (X).</span>
<span class="c">!    2, please compute row (I-1) of the jacobian and return it in FJROW.</span>
<span class="c">!</span>
<span class="w">  </span><span class="k">implicit none</span>

<span class="k">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mf">1.0D+00</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="kt">integer </span><span class="n">m</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">n</span>

<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">fjrow</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">fvec</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">iflag</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xdat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">    </span><span class="mf">1.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mf">2.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mf">3.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mf">4.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mf">5.0D+00</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">    </span><span class="mf">6.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mf">7.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mf">8.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mf">9.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="mf">0.0D+00</span><span class="w"> </span><span class="o">/</span><span class="p">)</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ydat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">    </span><span class="mf">4.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="mf">3.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="mf">8.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="mf">9.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="mf">6.0D+00</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">    </span><span class="mi">10</span><span class="mf">9.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="mf">8.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mi">19</span><span class="mf">3.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mi">24</span><span class="mf">4.0D+00</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="mf">1.0D+00</span><span class="w"> </span><span class="o">/</span><span class="p">)</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">    </span><span class="n">fvec</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xdat</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="o">**</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ydat</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="p">)</span>

<span class="w">  </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">iflag</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">    </span><span class="n">fjrow</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0D+00</span>
<span class="w">    </span><span class="n">fjrow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xdat</span><span class="p">(</span><span class="n">iflag</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">**</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="w">    </span><span class="n">fjrow</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">log</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">xdat</span><span class="p">(</span><span class="n">iflag</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xdat</span><span class="p">(</span><span class="n">iflag</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">**</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="w">  </span><span class="k">end if</span>

<span class="k">  return</span>
<span class="k">end</span>
<span class="k">subroutine </span><span class="n">qform_test</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">)</span>

<span class="c">!*****************************************************************************80</span>
<span class="c">!</span>
<span class="c">!! QFORM_TEST tests QFORM.</span>
<span class="c">!</span>
<span class="c">!  Licensing:</span>
<span class="c">!</span>
<span class="c">!    This code is distributed under the GNU LGPL license.</span>
<span class="c">!</span>
<span class="c">!  Modified:</span>
<span class="c">!</span>
<span class="c">!    02 January 2018</span>
<span class="c">!</span>
<span class="c">!  Author:</span>
<span class="c">!</span>
<span class="c">!    John Burkardt</span>
<span class="c">!</span>
<span class="w">  </span><span class="k">implicit none</span>

<span class="k">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mf">1.0D+00</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span>
<span class="w">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span>

<span class="w">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span>

<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="n">lda</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">a2</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">acnorm</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">ipivot</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">j</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">k</span>
<span class="w">  </span><span class="kt">integer </span><span class="n">lipvt</span>
<span class="w">  </span><span class="kt">logical </span><span class="n">pivot</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">q</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">m</span><span class="p">)</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">r</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">rdiag</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;&#39;</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;QFORM_TEST:&#39;</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;  QFORM constructs the Q factor explicitly&#39;</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;  after the use of QRFAC.&#39;</span>
<span class="c">!</span>
<span class="c">!  Set the matrix A.</span>
<span class="c">!</span>
<span class="w">  </span><span class="k">call </span><span class="nb">random_number</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">harvest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="k">call </span><span class="n">r8mat_print</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  Matrix A:&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="c">!</span>
<span class="c">!  Compute the QR factors.</span>
<span class="c">!</span>
<span class="w">  </span><span class="n">pivot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<span class="w">  </span><span class="n">lipvt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span>

<span class="w">  </span><span class="k">call </span><span class="n">qrfac</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="n">pivot</span><span class="p">,</span><span class="w"> </span><span class="n">ipivot</span><span class="p">,</span><span class="w"> </span><span class="n">lipvt</span><span class="p">,</span><span class="w"> </span><span class="n">rdiag</span><span class="p">,</span><span class="w"> </span><span class="n">acnorm</span><span class="w"> </span><span class="p">)</span>
<span class="c">!</span>
<span class="c">!  Extract the R factor.</span>
<span class="c">!</span>
<span class="w">  </span><span class="n">r</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0D+00</span>

<span class="w">  </span><span class="k">do </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nb">min</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="n">r</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rdiag</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="w">  </span><span class="k">end do</span>

<span class="k">  do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">    </span><span class="n">r</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">min</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">m</span><span class="p">),</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">min</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">m</span><span class="p">),</span><span class="n">j</span><span class="p">)</span>
<span class="w">  </span><span class="k">end do</span>
<span class="k">  call </span><span class="n">r8mat_print</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  Matrix R:&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="c">!</span>
<span class="c">!  Call QRFORM to form the Q factor.</span>
<span class="c">!</span>
<span class="w">  </span><span class="n">q</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0D+00</span>
<span class="w">  </span><span class="n">q</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="nb">min</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">))</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="nb">min</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>

<span class="w">  </span><span class="k">call </span><span class="n">qform</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="k">call </span><span class="n">r8mat_print</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  Matrix Q:&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="c">!</span>
<span class="c">!  Compute Q*R.</span>
<span class="c">!</span>
<span class="w">  </span><span class="n">a2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">matmul</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="p">)</span>
<span class="c">!</span>
<span class="c">!  Compare Q*R to A.</span>
<span class="c">!</span>
<span class="w">  </span><span class="k">call </span><span class="n">r8mat_print</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">a2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  Matrix A2 = Q * R:&#39;</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="k">return</span>
<span class="k">end</span>
<span class="c">!~ subroutine r8mat_print ( m, n, a, title )</span>

<span class="c">!~ !*****************************************************************************80</span>
<span class="c">!~ !</span>
<span class="c">!~ !! R8MAT_PRINT prints an R8MAT.</span>
<span class="c">!~ !</span>
<span class="c">!~ !  Discussion:</span>
<span class="c">!~ !</span>
<span class="c">!~ !    An R8MAT is an MxN array of R8&#39;s, stored by (I,J) -&gt; [I+J*M].</span>
<span class="c">!~ !</span>
<span class="c">!~ !  Licensing:</span>
<span class="c">!~ !</span>
<span class="c">!~ !    This code is distributed under the GNU LGPL license.</span>
<span class="c">!~ !</span>
<span class="c">!~ !  Modified:</span>
<span class="c">!~ !</span>
<span class="c">!~ !    12 September 2004</span>
<span class="c">!~ !</span>
<span class="c">!~ !  Author:</span>
<span class="c">!~ !</span>
<span class="c">!~ !    John Burkardt</span>
<span class="c">!~ !</span>
<span class="c">!~ !  Parameters:</span>
<span class="c">!~ !</span>
<span class="c">!~ !    Input, integer M, the number of rows in A.</span>
<span class="c">!~ !</span>
<span class="c">!~ !    Input, integer N, the number of columns in A.</span>
<span class="c">!~ !</span>
<span class="c">!~ !    Input, real ( kind = rk ) A(M,N), the matrix.</span>
<span class="c">!~ !</span>
<span class="c">!~ !    Input, character ( len = * ) TITLE, a title.</span>
<span class="c">!~ !</span>
<span class="c">!~   implicit none</span>

<span class="c">!~   integer, parameter :: rk = kind ( 1.0D+00 )</span>

<span class="c">!~   integer m</span>
<span class="c">!~   integer n</span>

<span class="c">!~   real ( kind = rk ) a(m,n)</span>
<span class="c">!~   character ( len = * ) title</span>

<span class="c">!~   call r8mat_print_some ( m, n, a, 1, 1, m, n, title )</span>

<span class="c">!~   return</span>
<span class="c">!~ end</span>
<span class="c">!~ subroutine r8mat_print_some ( m, n, a, ilo, jlo, ihi, jhi, title )</span>

<span class="c">!~ !*****************************************************************************80</span>
<span class="c">!~ !</span>
<span class="c">!~ !! R8MAT_PRINT_SOME prints some of an R8MAT.</span>
<span class="c">!~ !</span>
<span class="c">!~ !  Discussion:</span>
<span class="c">!~ !</span>
<span class="c">!~ !    An R8MAT is an MxN array of R8&#39;s, stored by (I,J) -&gt; [I+J*M].</span>
<span class="c">!~ !</span>
<span class="c">!~ !  Licensing:</span>
<span class="c">!~ !</span>
<span class="c">!~ !    This code is distributed under the GNU LGPL license.</span>
<span class="c">!~ !</span>
<span class="c">!~ !  Modified:</span>
<span class="c">!~ !</span>
<span class="c">!~ !    10 September 2009</span>
<span class="c">!~ !</span>
<span class="c">!~ !  Author:</span>
<span class="c">!~ !</span>
<span class="c">!~ !    John Burkardt</span>
<span class="c">!~ !</span>
<span class="c">!~ !  Parameters:</span>
<span class="c">!~ !</span>
<span class="c">!~ !    Input, integer M, N, the number of rows and columns.</span>
<span class="c">!~ !</span>
<span class="c">!~ !    Input, real ( kind = rk ) A(M,N), an M by N matrix to be printed.</span>
<span class="c">!~ !</span>
<span class="c">!~ !    Input, integer ILO, JLO, the first row and column to print.</span>
<span class="c">!~ !</span>
<span class="c">!~ !    Input, integer IHI, JHI, the last row and column to print.</span>
<span class="c">!~ !</span>
<span class="c">!~ !    Input, character ( len = * ) TITLE, a title.</span>
<span class="c">!~ !</span>
<span class="c">!~   implicit none</span>

<span class="c">!~   integer, parameter :: rk = kind ( 1.0D+00 )</span>

<span class="c">!~   integer, parameter :: incx = 5</span>
<span class="c">!~   integer m</span>
<span class="c">!~   integer n</span>

<span class="c">!~   real ( kind = rk ) a(m,n)</span>
<span class="c">!~   character ( len = 14 ) ctemp(incx)</span>
<span class="c">!~   integer i</span>
<span class="c">!~   integer i2hi</span>
<span class="c">!~   integer i2lo</span>
<span class="c">!~   integer ihi</span>
<span class="c">!~   integer ilo</span>
<span class="c">!~   integer inc</span>
<span class="c">!~   integer j</span>
<span class="c">!~   integer j2</span>
<span class="c">!~   integer j2hi</span>
<span class="c">!~   integer j2lo</span>
<span class="c">!~   integer jhi</span>
<span class="c">!~   integer jlo</span>
<span class="c">!~   character ( len = * ) title</span>

<span class="c">!~   write ( *, &#39;(a)&#39; ) &#39; &#39;</span>
<span class="c">!~   write ( *, &#39;(a)&#39; ) trim ( title )</span>

<span class="c">!~   if ( m &lt;= 0 .or. n &lt;= 0 ) then</span>
<span class="c">!~     write ( *, &#39;(a)&#39; ) &#39; &#39;</span>
<span class="c">!~     write ( *, &#39;(a)&#39; ) &#39;  (None)&#39;</span>
<span class="c">!~     return</span>
<span class="c">!~   end if</span>

<span class="c">!~   do j2lo = max ( jlo, 1 ), min ( jhi, n ), incx</span>

<span class="c">!~     j2hi = j2lo + incx - 1</span>
<span class="c">!~     j2hi = min ( j2hi, n )</span>
<span class="c">!~     j2hi = min ( j2hi, jhi )</span>

<span class="c">!~     inc = j2hi + 1 - j2lo</span>

<span class="c">!~     write ( *, &#39;(a)&#39; ) &#39; &#39;</span>

<span class="c">!~     do j = j2lo, j2hi</span>
<span class="c">!~       j2 = j + 1 - j2lo</span>
<span class="c">!~       write ( ctemp(j2), &#39;(i8,6x)&#39; ) j</span>
<span class="c">!~     end do</span>

<span class="c">!~     write ( *, &#39;(&#39;&#39;  Col   &#39;&#39;,5a14)&#39; ) ctemp(1:inc)</span>
<span class="c">!~     write ( *, &#39;(a)&#39; ) &#39;  Row&#39;</span>
<span class="c">!~     write ( *, &#39;(a)&#39; ) &#39; &#39;</span>

<span class="c">!~     i2lo = max ( ilo, 1 )</span>
<span class="c">!~     i2hi = min ( ihi, m )</span>

<span class="c">!~     do i = i2lo, i2hi</span>

<span class="c">!~       do j2 = 1, inc</span>

<span class="c">!~         j = j2lo - 1 + j2</span>

<span class="c">!~         if ( a(i,j) == real ( int ( a(i,j) ), kind = rk ) ) then</span>
<span class="c">!~           write ( ctemp(j2), &#39;(f8.0,6x)&#39; ) a(i,j)</span>
<span class="c">!~         else</span>
<span class="c">!~           write ( ctemp(j2), &#39;(g14.6)&#39; ) a(i,j)</span>
<span class="c">!~         end if</span>

<span class="c">!~       end do</span>

<span class="c">!~       write ( *, &#39;(i5,a,5a14)&#39; ) i, &#39;:&#39;, ( ctemp(j), j = 1, inc )</span>

<span class="c">!~     end do</span>

<span class="c">!~   end do</span>

<span class="c">!~   return</span>
<span class="c">!~ end</span>
<span class="c">!~ subroutine r8vec_print ( n, a, title )</span>

<span class="c">!~ !*****************************************************************************80</span>
<span class="c">!~ !</span>
<span class="c">!~ !! R8VEC_PRINT prints an R8VEC.</span>
<span class="c">!~ !</span>
<span class="c">!~ !  Discussion:</span>
<span class="c">!~ !</span>
<span class="c">!~ !    An R8VEC is a vector of R8&#39;s.</span>
<span class="c">!~ !</span>
<span class="c">!~ !  Licensing:</span>
<span class="c">!~ !</span>
<span class="c">!~ !    This code is distributed under the GNU LGPL license.</span>
<span class="c">!~ !</span>
<span class="c">!~ !  Modified:</span>
<span class="c">!~ !</span>
<span class="c">!~ !    22 August 2000</span>
<span class="c">!~ !</span>
<span class="c">!~ !  Author:</span>
<span class="c">!~ !</span>
<span class="c">!~ !    John Burkardt</span>
<span class="c">!~ !</span>
<span class="c">!~ !  Parameters:</span>
<span class="c">!~ !</span>
<span class="c">!~ !    Input, integer N, the number of components of the vector.</span>
<span class="c">!~ !</span>
<span class="c">!~ !    Input, real ( kind = rk ) A(N), the vector to be printed.</span>
<span class="c">!~ !</span>
<span class="c">!~ !    Input, character ( len = * ) TITLE, a title.</span>
<span class="c">!~ !</span>
<span class="c">!~   implicit none</span>

<span class="c">!~   integer, parameter :: rk = kind ( 1.0D+00 )</span>

<span class="c">!~   integer n</span>

<span class="c">!~   real ( kind = rk ) a(n)</span>
<span class="c">!~   integer i</span>
<span class="c">!~   character ( len = * ) title</span>

<span class="c">!~   write ( *, &#39;(a)&#39; ) &#39; &#39;</span>
<span class="c">!~   write ( *, &#39;(a)&#39; ) trim ( title )</span>
<span class="c">!~   write ( *, &#39;(a)&#39; ) &#39; &#39;</span>
<span class="c">!~   do i = 1, n</span>
<span class="c">!~     write ( *, &#39;(2x,i8,2x,g16.8)&#39; ) i, a(i)</span>
<span class="c">!~   end do</span>

<span class="c">!~   return</span>
<span class="c">!~ end</span>
<span class="c">!~ subroutine timestamp ( )</span>

<span class="c">!~ !*****************************************************************************80</span>
<span class="c">!~ !</span>
<span class="c">!~ !! TIMESTAMP prints the current YMDHMS date as a time stamp.</span>
<span class="c">!~ !</span>
<span class="c">!~ !  Example:</span>
<span class="c">!~ !</span>
<span class="c">!~ !    31 May 2001   9:45:54.872 AM</span>
<span class="c">!~ !</span>
<span class="c">!~ !  Licensing:</span>
<span class="c">!~ !</span>
<span class="c">!~ !    This code is distributed under the GNU LGPL license.</span>
<span class="c">!~ !</span>
<span class="c">!~ !  Modified:</span>
<span class="c">!~ !</span>
<span class="c">!~ !    18 May 2013</span>
<span class="c">!~ !</span>
<span class="c">!~ !  Author:</span>
<span class="c">!~ !</span>
<span class="c">!~ !    John Burkardt</span>
<span class="c">!~ !</span>
<span class="c">!~   implicit none</span>

<span class="c">!~   integer, parameter :: rk = kind ( 1.0D+00 )</span>

<span class="c">!~   character ( len = 8 ) ampm</span>
<span class="c">!~   integer d</span>
<span class="c">!~   integer h</span>
<span class="c">!~   integer m</span>
<span class="c">!~   integer mm</span>
<span class="c">!~   character ( len = 9 ), parameter, dimension(12) :: month = (/ &amp;</span>
<span class="c">!~     &#39;January  &#39;, &#39;February &#39;, &#39;March    &#39;, &#39;April    &#39;, &amp;</span>
<span class="c">!~     &#39;May      &#39;, &#39;June     &#39;, &#39;July     &#39;, &#39;August   &#39;, &amp;</span>
<span class="c">!~     &#39;September&#39;, &#39;October  &#39;, &#39;November &#39;, &#39;December &#39; /)</span>
<span class="c">!~   integer n</span>
<span class="c">!~   integer s</span>
<span class="c">!~   integer values(8)</span>
<span class="c">!~   integer y</span>

<span class="c">!~   call date_and_time ( values = values )</span>

<span class="c">!~   y = values(1)</span>
<span class="c">!~   m = values(2)</span>
<span class="c">!~   d = values(3)</span>
<span class="c">!~   h = values(5)</span>
<span class="c">!~   n = values(6)</span>
<span class="c">!~   s = values(7)</span>
<span class="c">!~   mm = values(8)</span>

<span class="c">!~   if ( h &lt; 12 ) then</span>
<span class="c">!~     ampm = &#39;AM&#39;</span>
<span class="c">!~   else if ( h == 12 ) then</span>
<span class="c">!~     if ( n == 0 .and. s == 0 ) then</span>
<span class="c">!~       ampm = &#39;Noon&#39;</span>
<span class="c">!~     else</span>
<span class="c">!~       ampm = &#39;PM&#39;</span>
<span class="c">!~     end if</span>
<span class="c">!~   else</span>
<span class="c">!~     h = h - 12</span>
<span class="c">!~     if ( h &lt; 12 ) then</span>
<span class="c">!~       ampm = &#39;PM&#39;</span>
<span class="c">!~     else if ( h == 12 ) then</span>
<span class="c">!~       if ( n == 0 .and. s == 0 ) then</span>
<span class="c">!~         ampm = &#39;Midnight&#39;</span>
<span class="c">!~       else</span>
<span class="c">!~         ampm = &#39;AM&#39;</span>
<span class="c">!~       end if</span>
<span class="c">!~     end if</span>
<span class="c">!~   end if</span>

<span class="c">!~   write ( *, &#39;(i2.2,1x,a,1x,i4,2x,i2,a1,i2.2,a1,i2.2,a1,i3.3,1x,a)&#39; ) &amp;</span>
<span class="c">!~     d, trim ( month(m) ), y, h, &#39;:&#39;, n, &#39;:&#39;, s, &#39;.&#39;, mm, trim ( ampm )</span>

<span class="c">!~   return</span>
<span class="c">!~ end</span>

<span class="k">endprogram </span><span class="n">test_minpack</span>
</pre></div>

    </section>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              TOOLIB
 was developed by Arthur Francisco<br>              &copy; 2024 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2024-12-26 17:40              </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>    

    <!-- MathJax JavaScript
             ================================================== -->
             <!-- Placed at the end of the document so the pages load faster -->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
          TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
          jax: ['input/TeX','input/MathML','output/HTML-CSS'],
          extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
          });
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

          <script src="../tipuesearch/tipuesearch_content.js"></script>
          <script src="../tipuesearch/tipuesearch_set.js"></script>
          <script src="../tipuesearch/tipuesearch.js"></script>

  </body>
</html>