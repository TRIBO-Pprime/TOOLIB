<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="TOOLIB – Tools for various needs">
    <meta name="author" content="Arthur Francisco" >
    <link rel="icon" href="../favicon.png">

    <title>test_algen &ndash; TOOLIB</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
      <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
      <link href="../css/user.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">TOOLIB </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/programs.html">Programs</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>test_algen      <small>Program</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">
            <li class="list-inline-item" id="meta-author"><i class="fa fa-pencil"></i> Arthur Francisco</li>
            <li class="list-inline-item" id="meta-date"><i class="fa fa-calendar-o"></i> november, 01 2024</li>
            <li class="list-inline-item" id="meta-version"><i class="fa fa-barcode"></i> 1.0.0</li>

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title="14.5% of total for programs.">275 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/prg.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/prg.f90~6.html'>prg.f90</a></li>
            <li class="breadcrumb-item active" aria-current="page">test_algen</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-bs-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#vars-0"
         aria-expanded="false" aria-controls="vars-0">
         <h4 class="card-header bg-primary text-white">Variables</h4>
      </a>
      <div id="vars-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../program/test_algen.html#variable-sku">SKU</a>
            <a class="list-group-item" href="../program/test_algen.html#variable-ssk">SSK</a>
            <a class="list-group-item" href="../program/test_algen.html#variable-f~2">f</a>
            <a class="list-group-item" href="../program/test_algen.html#variable-f_xx">f_xx</a>
            <a class="list-group-item" href="../program/test_algen.html#variable-i~33">i</a>
            <a class="list-group-item" href="../program/test_algen.html#variable-iu">iu</a>
            <a class="list-group-item" href="../program/test_algen.html#variable-j~26">j</a>
            <a class="list-group-item" href="../program/test_algen.html#variable-k~14">k</a>
            <a class="list-group-item" href="../program/test_algen.html#variable-mom">mom</a>
            <a class="list-group-item" href="../program/test_algen.html#variable-nb_th">nb_th</a>
            <a class="list-group-item" href="../program/test_algen.html#variable-nn~2">nn</a>
            <a class="list-group-item" href="../program/test_algen.html#variable-p~3">p</a>
            <a class="list-group-item" href="../program/test_algen.html#variable-status~57">status</a>
            <a class="list-group-item" href="../program/test_algen.html#variable-tab_sur">tab_sur</a>
            <a class="list-group-item" href="../program/test_algen.html#variable-tend">tend</a>
            <a class="list-group-item" href="../program/test_algen.html#variable-tstart">tstart</a>
            <a class="list-group-item" href="../program/test_algen.html#variable-xl">xl</a>
            <a class="list-group-item" href="../program/test_algen.html#variable-xu">xu</a>
            <a class="list-group-item" href="../program/test_algen.html#variable-xx">xx</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#types-0"
         aria-expanded="false" aria-controls="types-0">
         <h4 class="card-header bg-primary text-white">Derived Types</h4>
      </a>
      <div id="types-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../program/test_algen.html#type-moment_stat">moment_stat</a>
        </div>
      </div>
    </div>

      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#funcs-0"
         aria-expanded="false" aria-controls="funcs-0">
         <h4 class="card-header bg-primary text-white">Functions</h4>
      </a>
      <div id="funcs-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../program/test_algen.html#proc-abs_diff_sk_ku">abs_diff_sk_ku</a>
            <a class="list-group-item" href="../program/test_algen.html#proc-add_tang">add_tang</a>
            <a class="list-group-item" href="../program/test_algen.html#proc-cost_func">cost_func</a>
            <a class="list-group-item" href="../program/test_algen.html#proc-tang">tang</a>
        </div>
      </div>
    </div>

      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#subs-0"
         aria-expanded="false" aria-controls="subs-0">
         <h4 class="card-header bg-primary text-white">Subroutines</h4>
      </a>
      <div id="subs-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../program/test_algen.html#proc-calc_moments_1d">calc_moments_1D</a>
            <a class="list-group-item" href="../program/test_algen.html#proc-cost">cost</a>
            <a class="list-group-item" href="../program/test_algen.html#proc-melange">melange</a>
            <a class="list-group-item" href="../program/test_algen.html#proc-newton_raphson_downhill">newton_raphson_downhill</a>
            <a class="list-group-item" href="../program/test_algen.html#proc-profil_theo_trie_1d">profil_theo_trie_1D</a>
            <a class="list-group-item" href="../program/test_algen.html#proc-sk_ku">sk_ku</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../program/test_algen.html#src">test_algen</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
        <div class="card mb-4">
      <h3 class="card-header card-title bg-light">Uses</h3>
      <div class="card-body">
        <ul class="list-group list-group-flush">
            <li class="list-group-item">
              <ul class="list-inline">
                  <li class="list-inline-item"><a href='../module/pikaia_oop.html'>pikaia_oop</a></li>
                  <li class="list-inline-item"><a href='../module/miscellaneous.html'>miscellaneous</a></li>
                  <li class="list-inline-item"><a href='../module/data_arch.html'>data_arch</a></li>
                  <li class="list-inline-item"><a href='../module/sort_arrays.html'>sort_arrays</a></li>
                  <li class="list-inline-item"><a href='https://www.openmp.org/spec-html/5.1/openmpch3.html#x156-1890003'>omp_lib</a></li>
              </ul>
            </li>
            <li class="list-group-item">
              <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: program~~test_algen~~UsesGraph Pages: 1 -->
<svg id="programtest_algenUsesGraph" width="418pt" height="175pt"
 viewBox="0.00 0.00 418.00 174.72" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~test_algen~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 170.72)">
<title>program~~test_algen~~UsesGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-170.72 414,-170.72 414,4 -4,4"/>
<!-- program~test_algen -->
<g id="program~~test_algen~~UsesGraph_node1" class="node">
<title>program~test_algen</title>
<polygon fill="none" stroke="black" points="410,-108 348,-108 348,-84 410,-84 410,-108"/>
<text text-anchor="middle" x="379" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50">test_algen</text>
</g>
<!-- module~data_arch -->
<g id="program~~test_algen~~UsesGraph_node2" class="node">
<title>module~data_arch</title>
<g id="a_program~~test_algen~~UsesGraph_node2"><a xlink:href="../module/data_arch.html" xlink:title="data_arch">
<polygon fill="#337ab7" stroke="#337ab7" points="190,-148 129,-148 129,-124 190,-124 190,-148"/>
<text text-anchor="middle" x="159.5" y="-133.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">data_arch</text>
</a>
</g>
</g>
<!-- program~test_algen&#45;&gt;module~data_arch -->
<g id="program~~test_algen~~UsesGraph_edge1" class="edge">
<title>program~test_algen&#45;&gt;module~data_arch</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M369.9,-108.1C358.88,-123.33 337.59,-148.75 312,-159 274.45,-174.04 228.06,-163.1 196.58,-151.74"/>
<polygon fill="#ff0000" stroke="#ff0000" points="197.51,-148.35 186.91,-148.07 195.02,-154.89 197.51,-148.35"/>
</g>
<!-- module~miscellaneous -->
<g id="program~~test_algen~~UsesGraph_node3" class="node">
<title>module~miscellaneous</title>
<g id="a_program~~test_algen~~UsesGraph_node3"><a xlink:href="../module/miscellaneous.html" xlink:title="miscellaneous">
<polygon fill="#337ab7" stroke="#337ab7" points="312,-150 232,-150 232,-126 312,-126 312,-150"/>
<text text-anchor="middle" x="272" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">miscellaneous</text>
</a>
</g>
</g>
<!-- program~test_algen&#45;&gt;module~miscellaneous -->
<g id="program~~test_algen~~UsesGraph_edge2" class="edge">
<title>program~test_algen&#45;&gt;module~miscellaneous</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M347.91,-108.04C336.93,-112.43 324.33,-117.47 312.64,-122.14"/>
<polygon fill="#ff0000" stroke="#ff0000" points="311.08,-119 303.09,-125.96 313.68,-125.5 311.08,-119"/>
</g>
<!-- module~pikaia_oop -->
<g id="program~~test_algen~~UsesGraph_node4" class="node">
<title>module~pikaia_oop</title>
<g id="a_program~~test_algen~~UsesGraph_node4"><a xlink:href="../module/pikaia_oop.html" xlink:title="pikaia_oop">
<polygon fill="#337ab7" stroke="#337ab7" points="304,-66 240,-66 240,-42 304,-42 304,-66"/>
<text text-anchor="middle" x="272" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pikaia_oop</text>
</a>
</g>
</g>
<!-- program~test_algen&#45;&gt;module~pikaia_oop -->
<g id="program~~test_algen~~UsesGraph_edge3" class="edge">
<title>program~test_algen&#45;&gt;module~pikaia_oop</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M347.91,-83.96C336.93,-79.57 324.33,-74.53 312.64,-69.86"/>
<polygon fill="#ff0000" stroke="#ff0000" points="313.68,-66.5 303.09,-66.04 311.08,-73 313.68,-66.5"/>
</g>
<!-- module~sort_arrays -->
<g id="program~~test_algen~~UsesGraph_node5" class="node">
<title>module~sort_arrays</title>
<g id="a_program~~test_algen~~UsesGraph_node5"><a xlink:href="../module/sort_arrays.html" xlink:title="sort_arrays">
<polygon fill="#337ab7" stroke="#337ab7" points="305.5,-108 238.5,-108 238.5,-84 305.5,-84 305.5,-108"/>
<text text-anchor="middle" x="272" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sort_arrays</text>
</a>
</g>
</g>
<!-- program~test_algen&#45;&gt;module~sort_arrays -->
<g id="program~~test_algen~~UsesGraph_edge4" class="edge">
<title>program~test_algen&#45;&gt;module~sort_arrays</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M347.91,-96C337.9,-96 326.55,-96 315.77,-96"/>
<polygon fill="#ff0000" stroke="#ff0000" points="315.67,-92.5 305.67,-96 315.67,-99.5 315.67,-92.5"/>
</g>
<!-- omp_lib -->
<g id="program~~test_algen~~UsesGraph_node6" class="node">
<title>omp_lib</title>
<g id="a_program~~test_algen~~UsesGraph_node6"><a xlink:href="https://www.openmp.org/spec-html/5.1/openmpch3.html#x156-1890003" xlink:title="omp_lib">
<polygon fill="#337ab7" stroke="#337ab7" points="299,-24 245,-24 245,0 299,0 299,-24"/>
<text text-anchor="middle" x="272" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">omp_lib</text>
</a>
</g>
</g>
<!-- program~test_algen&#45;&gt;omp_lib -->
<g id="program~~test_algen~~UsesGraph_edge5" class="edge">
<title>program~test_algen&#45;&gt;omp_lib</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M367.15,-83.84C354.71,-70.35 333.28,-48.45 312,-33 310.37,-31.81 308.66,-30.65 306.91,-29.52"/>
<polygon fill="#ff0000" stroke="#ff0000" points="308.32,-26.29 297.95,-24.14 304.72,-32.29 308.32,-26.29"/>
</g>
<!-- iso_fortran_env -->
<g id="program~~test_algen~~UsesGraph_node7" class="node">
<title>iso_fortran_env</title>
<g id="a_program~~test_algen~~UsesGraph_node7"><a xlink:href="http://fortranwiki.org/fortran/show/iso_fortran_env" xlink:title="iso_fortran_env">
<polygon fill="#337ab7" stroke="#337ab7" points="87,-106 0,-106 0,-82 87,-82 87,-106"/>
<text text-anchor="middle" x="43.5" y="-91.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iso_fortran_env</text>
</a>
</g>
</g>
<!-- module~data_arch&#45;&gt;iso_fortran_env -->
<g id="program~~test_algen~~UsesGraph_edge6" class="edge">
<title>module~data_arch&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M128.85,-125.07C115.98,-120.34 100.68,-114.7 86.67,-109.54"/>
<polygon fill="#ff0000" stroke="#ff0000" points="87.81,-106.23 77.22,-106.05 85.39,-112.79 87.81,-106.23"/>
</g>
<!-- module~miscellaneous&#45;&gt;module~data_arch -->
<g id="program~~test_algen~~UsesGraph_edge7" class="edge">
<title>module~miscellaneous&#45;&gt;module~data_arch</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M231.73,-137.29C221.6,-137.11 210.69,-136.91 200.52,-136.72"/>
<polygon fill="#cbff00" stroke="#cbff00" points="200.32,-133.22 190.26,-136.54 200.2,-140.22 200.32,-133.22"/>
</g>
<!-- module~pikaia_oop&#45;&gt;iso_fortran_env -->
<g id="program~~test_algen~~UsesGraph_edge8" class="edge">
<title>module~pikaia_oop&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M239.87,-63.83C226.48,-67.77 210.58,-72.06 196,-75 163.46,-81.56 126.5,-86.25 97.23,-89.33"/>
<polygon fill="#00ff66" stroke="#00ff66" points="96.81,-85.85 87.22,-90.35 97.52,-92.81 96.81,-85.85"/>
</g>
<!-- module~mt19937_64 -->
<g id="program~~test_algen~~UsesGraph_node8" class="node">
<title>module~mt19937_64</title>
<g id="a_program~~test_algen~~UsesGraph_node8"><a xlink:href="../module/mt19937_64.html" xlink:title="mt19937_64">
<polygon fill="#337ab7" stroke="#337ab7" points="196,-66 123,-66 123,-42 196,-42 196,-66"/>
<text text-anchor="middle" x="159.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mt19937_64</text>
</a>
</g>
</g>
<!-- module~pikaia_oop&#45;&gt;module~mt19937_64 -->
<g id="program~~test_algen~~UsesGraph_edge9" class="edge">
<title>module~pikaia_oop&#45;&gt;module~mt19937_64</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M239.93,-54C229.47,-54 217.57,-54 206.22,-54"/>
<polygon fill="#00ff66" stroke="#00ff66" points="206.02,-50.5 196.02,-54 206.02,-57.5 206.02,-50.5"/>
</g>
<!-- module~sort_arrays&#45;&gt;module~data_arch -->
<g id="program~~test_algen~~UsesGraph_edge10" class="edge">
<title>module~sort_arrays&#45;&gt;module~data_arch</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M238.44,-107.78C226.27,-112.19 212.31,-117.24 199.61,-121.84"/>
<polygon fill="#0066ff" stroke="#0066ff" points="198.4,-118.56 190.18,-125.25 200.78,-125.14 198.4,-118.56"/>
</g>
<!-- module~mt19937_64&#45;&gt;iso_fortran_env -->
<g id="program~~test_algen~~UsesGraph_edge11" class="edge">
<title>module~mt19937_64&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M124.3,-66C113.13,-69.92 100.56,-74.33 88.76,-78.47"/>
<polygon fill="#00ffff" stroke="#00ffff" points="87.35,-75.26 79.07,-81.87 89.67,-81.86 87.35,-75.26"/>
</g>
</g>
</svg>
</div>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#UsesGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="UsesGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="490pt" height="32pt"
 viewBox="0.00 0.00 489.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 485.5,-28 485.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="139.5,-24 72.5,-24 72.5,0 139.5,0 139.5,-24"/>
<text text-anchor="middle" x="106" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="222,-24 158,-24 158,0 222,0 222,-24"/>
<text text-anchor="middle" x="190" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="294,-24 240,-24 240,0 294,0 294,-24"/>
<text text-anchor="middle" x="267" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-24 312,-24 312,0 366,0 366,-24"/>
<text text-anchor="middle" x="339" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="481.5,-24 384.5,-24 384.5,0 481.5,0 481.5,-24"/>
<text text-anchor="middle" x="433" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a submodule to the (sub)module which it is
descended from. Dashed arrows point from a module or program unit to 
modules which it uses.
</p>
 Where possible, edges connecting nodes are
given different colours to make them easier to distinguish in
large graphs.</div>
            </div>
          </div>
        </div>
            </li>
        </ul>
      </div>
    </div>

    <p><span style="color: #337ab7; font-family: cabin; font-size: 1.5em;">
    <strong>PIKAIA oop example of use</strong>
 </span></p>
<div class="alert alert-info">
<p class="alert-title h4">Note</p>
<p>The example chosen is the generation of a surface with given statistical moments.
 The implementation is part of the analytical developments presented in:<br/>
 A. Francisco and N. Brunetière, &ldquo;A hybrid method for fast and efficient rough surface generation&rdquo;,
 Proc IMechE Part J:J Engineering Tribology, 2016, Vol. 230(7) 747–768, DOI: 10.1177/1350650115612116</p>
<p>The surface heights are generated thanks the <em>tangent</em> function. This function is indeed very near the common material
 curves. Thus, providing the right lower and upper bounds makes it possible to match the desired statistical moments.</p>
</div>
<div class="alert alert-info">
<p class="alert-title h4">Note</p>
<p>The main difficulty to cope with is the high non linearity and the convergence only possible near the solution.
 Classical optimization methods fail in reaching the true solution: the lower and upper limits <code>x(1:2</code>.<br/>
 The <strong>PIKAIA</strong> program, which implements a genetic algorithm, is utilized to found a &ldquo;good&rdquo; solution, then a
 very classical optimization routine is used to find the nearly exact solution.</p>
</div>
<div class="alert alert-warning">
<p class="alert-title h4">Warning</p>
<p><strong>PIKAIA</strong> cost function must be chosen so as to be maximized.<br/>
 For clarity reasons, the optimization function must be minimized because it is the deviation to the solution.
 @note Warning</p>
</div>
<div class="alert alert-info">
<p class="alert-title h4">Note</p>
<p>First each thread runs the <strong>PIKAIA</strong> program to find a rather good starting point <code>x</code>. The parameters
 (as defined by <code>CTRL</code>) are the same. The only difference is the starting population. Thus, several concurrent
 populations evolve during <code>CTRL(02)</code> generations.<br/>
 Then, the optimization subroutine starts from the best population.</p>
</div>
<div class="alert alert-info">
<p class="alert-title h4">Note</p>
<p><code>make all</code>    <br/>
 <code>./prg</code>        <br/>
 The surface is in ascii mode in the &ldquo;/out&rdquo; directory</p>
</div>
    <br>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Calls</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: program~~test_algen~~CallsGraph Pages: 1 -->
<svg id="programtest_algenCallsGraph" width="641pt" height="401pt"
 viewBox="0.00 0.00 641.00 401.17" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~test_algen~~CallsGraph" class="graph" transform="scale(0.48 0.48) rotate(0) translate(4 824)">
<title>program~~test_algen~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-824 1319,-824 1319,4 -4,4"/>
<!-- program~test_algen -->
<g id="program~~test_algen~~CallsGraph_node1" class="node">
<title>program~test_algen</title>
<polygon fill="none" stroke="black" points="62,-658 0,-658 0,-634 62,-634 62,-658"/>
<text text-anchor="middle" x="31" y="-643.6" font-family="Helvetica,sans-Serif" font-size="10.50">test_algen</text>
</g>
<!-- proc~abs_diff_sk_ku -->
<g id="program~~test_algen~~CallsGraph_node2" class="node">
<title>proc~abs_diff_sk_ku</title>
<g id="a_program~~test_algen~~CallsGraph_node2"><a xlink:href="../proc/abs_diff_sk_ku.html" xlink:title="abs_diff_sk_ku">
<polygon fill="#d94e8f" stroke="#d94e8f" points="392.5,-780 308.5,-780 308.5,-756 392.5,-756 392.5,-780"/>
<text text-anchor="middle" x="350.5" y="-765.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">abs_diff_sk_ku</text>
</a>
</g>
</g>
<!-- program~test_algen&#45;&gt;proc~abs_diff_sk_ku -->
<g id="program~~test_algen~~CallsGraph_edge1" class="edge">
<title>program~test_algen&#45;&gt;proc~abs_diff_sk_ku</title>
<path fill="none" stroke="#ff0000" d="M62.08,-656.12C73.3,-659.75 86.17,-663.75 98,-667 169.72,-686.74 193.2,-674.41 261,-705 286.12,-716.33 311.39,-735.25 328.46,-749.4"/>
<polygon fill="#ff0000" stroke="#ff0000" points="326.25,-752.12 336.14,-755.91 330.78,-746.78 326.25,-752.12"/>
</g>
<!-- proc~get_unit -->
<g id="program~~test_algen~~CallsGraph_node3" class="node">
<title>proc~get_unit</title>
<g id="a_program~~test_algen~~CallsGraph_node3"><a xlink:href="../proc/get_unit.html" xlink:title="get_unit">
<polygon fill="#d9534f" stroke="#d9534f" points="206.5,-738 152.5,-738 152.5,-714 206.5,-714 206.5,-738"/>
<text text-anchor="middle" x="179.5" y="-723.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_unit</text>
</a>
</g>
</g>
<!-- program~test_algen&#45;&gt;proc~get_unit -->
<g id="program~~test_algen~~CallsGraph_edge2" class="edge">
<title>program~test_algen&#45;&gt;proc~get_unit</title>
<path fill="none" stroke="#ff0000" d="M44.11,-658.3C56.62,-670.4 77.2,-688.66 98,-700 111.8,-707.52 128.13,-713.3 142.47,-717.48"/>
<polygon fill="#ff0000" stroke="#ff0000" points="141.91,-720.95 152.48,-720.24 143.77,-714.21 141.91,-720.95"/>
</g>
<!-- proc~melange -->
<g id="program~~test_algen~~CallsGraph_node4" class="node">
<title>proc~melange</title>
<g id="a_program~~test_algen~~CallsGraph_node4"><a xlink:href="../proc/melange.html" xlink:title="melange">
<polygon fill="#d9534f" stroke="#d9534f" points="206.5,-658 152.5,-658 152.5,-634 206.5,-634 206.5,-658"/>
<text text-anchor="middle" x="179.5" y="-643.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">melange</text>
</a>
</g>
</g>
<!-- program~test_algen&#45;&gt;proc~melange -->
<g id="program~~test_algen~~CallsGraph_edge3" class="edge">
<title>program~test_algen&#45;&gt;proc~melange</title>
<path fill="none" stroke="#ff0000" d="M62.35,-646C85.53,-646 117.55,-646 142.1,-646"/>
<polygon fill="#ff0000" stroke="#ff0000" points="142.11,-649.5 152.11,-646 142.11,-642.5 142.11,-649.5"/>
</g>
<!-- proc~newton_raphson_downhill -->
<g id="program~~test_algen~~CallsGraph_node5" class="node">
<title>proc~newton_raphson_downhill</title>
<g id="a_program~~test_algen~~CallsGraph_node5"><a xlink:href="../proc/newton_raphson_downhill.html" xlink:title="newton_raphson_downhill">
<polygon fill="#d9534f" stroke="#d9534f" points="247.5,-780 111.5,-780 111.5,-756 247.5,-756 247.5,-780"/>
<text text-anchor="middle" x="179.5" y="-765.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">newton_raphson_downhill</text>
</a>
</g>
</g>
<!-- program~test_algen&#45;&gt;proc~newton_raphson_downhill -->
<g id="program~~test_algen~~CallsGraph_edge4" class="edge">
<title>program~test_algen&#45;&gt;proc~newton_raphson_downhill</title>
<path fill="none" stroke="#ff0000" d="M36.46,-658.04C44.99,-679.38 65.69,-723.76 98,-747 100.23,-748.61 102.58,-750.09 105,-751.46"/>
<polygon fill="#ff0000" stroke="#ff0000" points="103.59,-754.66 114.11,-755.94 106.68,-748.38 103.59,-754.66"/>
</g>
<!-- proc~profil_theo_trie_1d -->
<g id="program~~test_algen~~CallsGraph_node6" class="node">
<title>proc~profil_theo_trie_1d</title>
<g id="a_program~~test_algen~~CallsGraph_node6"><a xlink:href="../proc/profil_theo_trie_1d.html" xlink:title="profil_theo_trie_1D">
<polygon fill="#d9534f" stroke="#d9534f" points="231,-616 128,-616 128,-592 231,-592 231,-616"/>
<text text-anchor="middle" x="179.5" y="-601.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">profil_theo_trie_1D</text>
</a>
</g>
</g>
<!-- program~test_algen&#45;&gt;proc~profil_theo_trie_1d -->
<g id="program~~test_algen~~CallsGraph_edge5" class="edge">
<title>program~test_algen&#45;&gt;proc~profil_theo_trie_1d</title>
<path fill="none" stroke="#ff0000" d="M62.13,-636.05C73.35,-632.43 86.22,-628.41 98,-625 105.41,-622.86 113.24,-620.69 120.98,-618.61"/>
<polygon fill="#ff0000" stroke="#ff0000" points="121.95,-621.97 130.71,-616.02 120.15,-615.21 121.95,-621.97"/>
</g>
<!-- proc~set_inputs -->
<g id="program~~test_algen~~CallsGraph_node7" class="node">
<title>proc~set_inputs</title>
<g id="a_program~~test_algen~~CallsGraph_node7"><a xlink:href="../proc/set_inputs.html" xlink:title="pikaia_class%set_inputs">
<polygon fill="#d9534f" stroke="#d9534f" points="243.5,-574 115.5,-574 115.5,-550 243.5,-550 243.5,-574"/>
<text text-anchor="middle" x="179.5" y="-559.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pikaia_class%set_inputs</text>
</a>
</g>
</g>
<!-- program~test_algen&#45;&gt;proc~set_inputs -->
<g id="program~~test_algen~~CallsGraph_edge6" class="edge">
<title>program~test_algen&#45;&gt;proc~set_inputs</title>
<path fill="none" stroke="#ff0000" d="M41.38,-633.89C53.09,-619.59 74.48,-596.11 98,-583 101.45,-581.08 105.08,-579.32 108.81,-577.73"/>
<polygon fill="#ff0000" stroke="#ff0000" points="110.2,-580.95 118.27,-574.08 107.68,-574.42 110.2,-580.95"/>
</g>
<!-- proc~solve_with_pikaia -->
<g id="program~~test_algen~~CallsGraph_node8" class="node">
<title>proc~solve_with_pikaia</title>
<g id="a_program~~test_algen~~CallsGraph_node8"><a xlink:href="../proc/solve_with_pikaia.html" xlink:title="pikaia_class%solve_with_pikaia">
<polygon fill="#d9534f" stroke="#d9534f" points="261,-431 98,-431 98,-407 261,-407 261,-431"/>
<text text-anchor="middle" x="179.5" y="-416.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pikaia_class%solve_with_pikaia</text>
</a>
</g>
</g>
<!-- program~test_algen&#45;&gt;proc~solve_with_pikaia -->
<g id="program~~test_algen~~CallsGraph_edge7" class="edge">
<title>program~test_algen&#45;&gt;proc~solve_with_pikaia</title>
<path fill="none" stroke="#ff0000" d="M39.44,-633.98C51.57,-614.41 76.43,-574.49 98,-541 121.15,-505.06 148.69,-463.58 164.82,-439.43"/>
<polygon fill="#ff0000" stroke="#ff0000" points="167.77,-441.32 170.41,-431.06 161.95,-437.43 167.77,-441.32"/>
</g>
<!-- proc~sk_ku -->
<g id="program~~test_algen~~CallsGraph_node11" class="node">
<title>proc~sk_ku</title>
<g id="a_program~~test_algen~~CallsGraph_node11"><a xlink:href="../proc/sk_ku.html" xlink:title="sk_ku">
<polygon fill="#d9534f" stroke="#d9534f" points="545.5,-800 491.5,-800 491.5,-776 545.5,-776 545.5,-800"/>
<text text-anchor="middle" x="518.5" y="-785.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sk_ku</text>
</a>
</g>
</g>
<!-- proc~abs_diff_sk_ku&#45;&gt;proc~sk_ku -->
<g id="program~~test_algen~~CallsGraph_edge8" class="edge">
<title>proc~abs_diff_sk_ku&#45;&gt;proc~sk_ku</title>
<path fill="none" stroke="#ff0000" d="M392.53,-772.94C419.71,-776.22 455.02,-780.47 481.17,-783.62"/>
<polygon fill="#ff0000" stroke="#ff0000" points="481.07,-787.14 491.42,-784.86 481.91,-780.19 481.07,-787.14"/>
</g>
<!-- proc~sort_array2 -->
<g id="program~~test_algen~~CallsGraph_node12" class="node">
<title>proc~sort_array2</title>
<g id="a_program~~test_algen~~CallsGraph_node12"><a xlink:href="../proc/sort_array2.html" xlink:title="sort_array2">
<polygon fill="#d9534f" stroke="#d9534f" points="384,-658 317,-658 317,-634 384,-634 384,-658"/>
<text text-anchor="middle" x="350.5" y="-643.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sort_array2</text>
</a>
</g>
</g>
<!-- proc~melange&#45;&gt;proc~sort_array2 -->
<g id="program~~test_algen~~CallsGraph_edge9" class="edge">
<title>proc~melange&#45;&gt;proc~sort_array2</title>
<path fill="none" stroke="#48ff00" d="M206.54,-646C233.16,-646 274.96,-646 306.5,-646"/>
<polygon fill="#48ff00" stroke="#48ff00" points="306.76,-649.5 316.76,-646 306.76,-642.5 306.76,-649.5"/>
</g>
<!-- proc~newton_raphson_downhill&#45;&gt;proc~abs_diff_sk_ku -->
<g id="program~~test_algen~~CallsGraph_edge10" class="edge">
<title>proc~newton_raphson_downhill&#45;&gt;proc~abs_diff_sk_ku</title>
<path fill="none" stroke="#00ff91" d="M247.78,-768C264.54,-768 282.25,-768 298.11,-768"/>
<polygon fill="#00ff91" stroke="#00ff91" points="298.23,-771.5 308.23,-768 298.23,-764.5 298.23,-771.5"/>
</g>
<!-- proc~calc_moments_1d -->
<g id="program~~test_algen~~CallsGraph_node9" class="node">
<title>proc~calc_moments_1d</title>
<g id="a_program~~test_algen~~CallsGraph_node9"><a xlink:href="../proc/calc_moments_1d.html" xlink:title="calc_moments_1D">
<polygon fill="#d9534f" stroke="#d9534f" points="401,-616 300,-616 300,-592 401,-592 401,-616"/>
<text text-anchor="middle" x="350.5" y="-601.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_moments_1D</text>
</a>
</g>
</g>
<!-- proc~profil_theo_trie_1d&#45;&gt;proc~calc_moments_1d -->
<g id="program~~test_algen~~CallsGraph_edge11" class="edge">
<title>proc~profil_theo_trie_1d&#45;&gt;proc~calc_moments_1d</title>
<path fill="none" stroke="#0091ff" d="M231.21,-604C249.67,-604 270.7,-604 289.87,-604"/>
<polygon fill="#0091ff" stroke="#0091ff" points="289.99,-607.5 299.99,-604 289.99,-600.5 289.99,-607.5"/>
</g>
<!-- proc~pikaia -->
<g id="program~~test_algen~~CallsGraph_node10" class="node">
<title>proc~pikaia</title>
<g id="a_program~~test_algen~~CallsGraph_node10"><a xlink:href="../proc/pikaia.html" xlink:title="pikaia_class%pikaia">
<polygon fill="#d9534f" stroke="#d9534f" points="404,-310 297,-310 297,-286 404,-286 404,-310"/>
<text text-anchor="middle" x="350.5" y="-295.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pikaia_class%pikaia</text>
</a>
</g>
</g>
<!-- proc~solve_with_pikaia&#45;&gt;proc~pikaia -->
<g id="program~~test_algen~~CallsGraph_edge12" class="edge">
<title>proc~solve_with_pikaia&#45;&gt;proc~pikaia</title>
<path fill="none" stroke="#ff00da" d="M197.32,-406.96C227.11,-385.63 289.27,-341.12 324.23,-316.09"/>
<polygon fill="#ff00da" stroke="#ff00da" points="326.4,-318.84 332.49,-310.18 322.33,-313.15 326.4,-318.84"/>
</g>
<!-- proc~adjmut -->
<g id="program~~test_algen~~CallsGraph_node14" class="node">
<title>proc~adjmut</title>
<g id="a_program~~test_algen~~CallsGraph_node14"><a xlink:href="../proc/adjmut.html" xlink:title="pikaia_class%adjmut">
<polygon fill="#d9534f" stroke="#d9534f" points="574.5,-352 462.5,-352 462.5,-328 574.5,-328 574.5,-352"/>
<text text-anchor="middle" x="518.5" y="-337.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pikaia_class%adjmut</text>
</a>
</g>
</g>
<!-- proc~pikaia&#45;&gt;proc~adjmut -->
<g id="program~~test_algen~~CallsGraph_edge13" class="edge">
<title>proc~pikaia&#45;&gt;proc~adjmut</title>
<path fill="none" stroke="#7fff00" d="M399.07,-310.04C418.08,-314.85 440.15,-320.43 460.05,-325.46"/>
<polygon fill="#7fff00" stroke="#7fff00" points="459.37,-328.9 469.92,-327.96 461.09,-322.12 459.37,-328.9"/>
</g>
<!-- proc~cross -->
<g id="program~~test_algen~~CallsGraph_node16" class="node">
<title>proc~cross</title>
<g id="a_program~~test_algen~~CallsGraph_node16"><a xlink:href="../proc/cross.html" xlink:title="pikaia_class%cross">
<polygon fill="#d9534f" stroke="#d9534f" points="571,-436 466,-436 466,-412 571,-412 571,-436"/>
<text text-anchor="middle" x="518.5" y="-421.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pikaia_class%cross</text>
</a>
</g>
</g>
<!-- proc~pikaia&#45;&gt;proc~cross -->
<g id="program~~test_algen~~CallsGraph_edge14" class="edge">
<title>proc~pikaia&#45;&gt;proc~cross</title>
<path fill="none" stroke="#7fff00" d="M358.29,-310.14C371.24,-332.12 401.6,-378.52 440,-403 444.97,-406.17 450.41,-408.86 456.04,-411.15"/>
<polygon fill="#7fff00" stroke="#7fff00" points="455.02,-414.51 465.62,-414.64 457.42,-407.93 455.02,-414.51"/>
</g>
<!-- proc~decode -->
<g id="program~~test_algen~~CallsGraph_node17" class="node">
<title>proc~decode</title>
<g id="a_program~~test_algen~~CallsGraph_node17"><a xlink:href="../proc/decode.html" xlink:title="pikaia_class%decode">
<polygon fill="#d9534f" stroke="#d9534f" points="576,-268 461,-268 461,-244 576,-244 576,-268"/>
<text text-anchor="middle" x="518.5" y="-253.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pikaia_class%decode</text>
</a>
</g>
</g>
<!-- proc~pikaia&#45;&gt;proc~decode -->
<g id="program~~test_algen~~CallsGraph_edge15" class="edge">
<title>proc~pikaia&#45;&gt;proc~decode</title>
<path fill="none" stroke="#7fff00" d="M399.07,-285.96C418.08,-281.15 440.15,-275.57 460.05,-270.54"/>
<polygon fill="#7fff00" stroke="#7fff00" points="461.09,-273.88 469.92,-268.04 459.37,-267.1 461.09,-273.88"/>
</g>
<!-- proc~encode -->
<g id="program~~test_algen~~CallsGraph_node18" class="node">
<title>proc~encode</title>
<g id="a_program~~test_algen~~CallsGraph_node18"><a xlink:href="../proc/encode.html" xlink:title="pikaia_class%encode">
<polygon fill="#d9534f" stroke="#d9534f" points="576,-226 461,-226 461,-202 576,-202 576,-226"/>
<text text-anchor="middle" x="518.5" y="-211.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pikaia_class%encode</text>
</a>
</g>
</g>
<!-- proc~pikaia&#45;&gt;proc~encode -->
<g id="program~~test_algen~~CallsGraph_edge16" class="edge">
<title>proc~pikaia&#45;&gt;proc~encode</title>
<path fill="none" stroke="#7fff00" d="M365.23,-285.84C381.85,-271.72 411.18,-248.62 440,-235 444.34,-232.95 448.91,-231.07 453.58,-229.35"/>
<polygon fill="#7fff00" stroke="#7fff00" points="454.92,-232.59 463.25,-226.05 452.66,-225.97 454.92,-232.59"/>
</g>
<!-- proc~func_wrapper -->
<g id="program~~test_algen~~CallsGraph_node19" class="node">
<title>proc~func_wrapper</title>
<g id="a_program~~test_algen~~CallsGraph_node19"><a xlink:href="../proc/func_wrapper.html" xlink:title="pikaia_class%func_wrapper">
<polygon fill="#d9534f" stroke="#d9534f" points="778,-84 633,-84 633,-60 778,-60 778,-84"/>
<text text-anchor="middle" x="705.5" y="-69.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pikaia_class%func_wrapper</text>
</a>
</g>
</g>
<!-- proc~pikaia&#45;&gt;proc~func_wrapper -->
<g id="program~~test_algen~~CallsGraph_edge17" class="edge">
<title>proc~pikaia&#45;&gt;proc~func_wrapper</title>
<path fill="none" stroke="#7fff00" d="M351.83,-285.8C353.64,-246.38 365.27,-122.08 440,-71 505.09,-26.51 601.84,-42.15 658.51,-57.27"/>
<polygon fill="#7fff00" stroke="#7fff00" points="657.7,-60.68 668.27,-59.98 659.57,-53.93 657.7,-60.68"/>
</g>
<!-- proc~genrep -->
<g id="program~~test_algen~~CallsGraph_node20" class="node">
<title>proc~genrep</title>
<g id="a_program~~test_algen~~CallsGraph_node20"><a xlink:href="../proc/genrep.html" xlink:title="pikaia_class%genrep">
<polygon fill="#d9534f" stroke="#d9534f" points="575,-146 462,-146 462,-122 575,-122 575,-146"/>
<text text-anchor="middle" x="518.5" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pikaia_class%genrep</text>
</a>
</g>
</g>
<!-- proc~pikaia&#45;&gt;proc~genrep -->
<g id="program~~test_algen~~CallsGraph_edge18" class="edge">
<title>proc~pikaia&#45;&gt;proc~genrep</title>
<path fill="none" stroke="#7fff00" d="M356.06,-285.7C366.63,-258.89 395.33,-194.82 440,-160 444.92,-156.16 450.44,-152.88 456.2,-150.07"/>
<polygon fill="#7fff00" stroke="#7fff00" points="457.66,-153.25 465.41,-146.03 454.85,-146.84 457.66,-153.25"/>
</g>
<!-- proc~mutate -->
<g id="program~~test_algen~~CallsGraph_node22" class="node">
<title>proc~mutate</title>
<g id="a_program~~test_algen~~CallsGraph_node22"><a xlink:href="../proc/mutate.html" xlink:title="pikaia_class%mutate">
<polygon fill="#d9534f" stroke="#d9534f" points="574.5,-478 462.5,-478 462.5,-454 574.5,-454 574.5,-478"/>
<text text-anchor="middle" x="518.5" y="-463.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pikaia_class%mutate</text>
</a>
</g>
</g>
<!-- proc~pikaia&#45;&gt;proc~mutate -->
<g id="program~~test_algen~~CallsGraph_edge19" class="edge">
<title>proc~pikaia&#45;&gt;proc~mutate</title>
<path fill="none" stroke="#7fff00" d="M355.24,-310.02C364.64,-338.18 391.98,-408.74 440,-445 443.9,-447.94 448.18,-450.47 452.67,-452.65"/>
<polygon fill="#7fff00" stroke="#7fff00" points="451.54,-455.97 462.11,-456.64 454.26,-449.52 451.54,-455.97"/>
</g>
<!-- proc~newpop -->
<g id="program~~test_algen~~CallsGraph_node23" class="node">
<title>proc~newpop</title>
<g id="a_program~~test_algen~~CallsGraph_node23"><a xlink:href="../proc/newpop.html" xlink:title="pikaia_class%newpop">
<polygon fill="#d9534f" stroke="#d9534f" points="577,-104 460,-104 460,-80 577,-80 577,-104"/>
<text text-anchor="middle" x="518.5" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pikaia_class%newpop</text>
</a>
</g>
</g>
<!-- proc~pikaia&#45;&gt;proc~newpop -->
<g id="program~~test_algen~~CallsGraph_edge20" class="edge">
<title>proc~pikaia&#45;&gt;proc~newpop</title>
<path fill="none" stroke="#7fff00" d="M353.67,-285.93C360.24,-252.9 383.1,-160.4 440,-113 443.25,-110.29 446.83,-107.93 450.6,-105.87"/>
<polygon fill="#7fff00" stroke="#7fff00" points="452.13,-109.01 459.69,-101.59 449.15,-102.68 452.13,-109.01"/>
</g>
<!-- proc~report -->
<g id="program~~test_algen~~CallsGraph_node24" class="node">
<title>proc~report</title>
<g id="a_program~~test_algen~~CallsGraph_node24"><a xlink:href="../proc/report.html" xlink:title="pikaia_class%report">
<polygon fill="#d9534f" stroke="#d9534f" points="572.5,-24 464.5,-24 464.5,0 572.5,0 572.5,-24"/>
<text text-anchor="middle" x="518.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pikaia_class%report</text>
</a>
</g>
</g>
<!-- proc~pikaia&#45;&gt;proc~report -->
<g id="program~~test_algen~~CallsGraph_edge21" class="edge">
<title>proc~pikaia&#45;&gt;proc~report</title>
<path fill="none" stroke="#7fff00" d="M351.98,-285.98C354.25,-245.18 367.18,-110.5 440,-38 444.32,-33.7 449.36,-30.11 454.78,-27.12"/>
<polygon fill="#7fff00" stroke="#7fff00" points="456.66,-30.1 464.17,-22.62 453.63,-23.79 456.66,-30.1"/>
</g>
<!-- proc~rninit -->
<g id="program~~test_algen~~CallsGraph_node25" class="node">
<title>proc~rninit</title>
<g id="a_program~~test_algen~~CallsGraph_node25"><a xlink:href="../proc/rninit.html" xlink:title="pikaia_class%rninit">
<polygon fill="#d9534f" stroke="#d9534f" points="757,-538 654,-538 654,-514 757,-514 757,-538"/>
<text text-anchor="middle" x="705.5" y="-523.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pikaia_class%rninit</text>
</a>
</g>
</g>
<!-- proc~pikaia&#45;&gt;proc~rninit -->
<g id="program~~test_algen~~CallsGraph_edge22" class="edge">
<title>proc~pikaia&#45;&gt;proc~rninit</title>
<path fill="none" stroke="#7fff00" d="M352.28,-310.1C355.43,-347.51 370.59,-461.78 440,-511 499.19,-552.98 585.89,-548.91 643.71,-539.61"/>
<polygon fill="#7fff00" stroke="#7fff00" points="644.53,-543.02 653.8,-537.89 643.35,-536.12 644.53,-543.02"/>
</g>
<!-- proc~rnkpop -->
<g id="program~~test_algen~~CallsGraph_node26" class="node">
<title>proc~rnkpop</title>
<g id="a_program~~test_algen~~CallsGraph_node26"><a xlink:href="../proc/rnkpop.html" xlink:title="pikaia_class%rnkpop">
<polygon fill="#d9534f" stroke="#d9534f" points="761.5,-146 649.5,-146 649.5,-122 761.5,-122 761.5,-146"/>
<text text-anchor="middle" x="705.5" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pikaia_class%rnkpop</text>
</a>
</g>
</g>
<!-- proc~pikaia&#45;&gt;proc~rnkpop -->
<g id="program~~test_algen~~CallsGraph_edge23" class="edge">
<title>proc~pikaia&#45;&gt;proc~rnkpop</title>
<path fill="none" stroke="#7fff00" d="M358.19,-285.7C370.96,-263.44 401.06,-216.61 440,-193 448.6,-187.78 563.82,-163.19 639.32,-147.45"/>
<polygon fill="#7fff00" stroke="#7fff00" points="640.16,-150.85 649.24,-145.39 638.73,-144 640.16,-150.85"/>
</g>
<!-- proc~select_parents -->
<g id="program~~test_algen~~CallsGraph_node27" class="node">
<title>proc~select_parents</title>
<g id="a_program~~test_algen~~CallsGraph_node27"><a xlink:href="../proc/select_parents.html" xlink:title="pikaia_class%select_parents">
<polygon fill="#d9534f" stroke="#d9534f" points="593,-394 444,-394 444,-370 593,-370 593,-394"/>
<text text-anchor="middle" x="518.5" y="-379.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pikaia_class%select_parents</text>
</a>
</g>
</g>
<!-- proc~pikaia&#45;&gt;proc~select_parents -->
<g id="program~~test_algen~~CallsGraph_edge24" class="edge">
<title>proc~pikaia&#45;&gt;proc~select_parents</title>
<path fill="none" stroke="#7fff00" d="M365.23,-310.16C381.85,-324.28 411.18,-347.38 440,-361 444.34,-363.05 448.91,-364.93 453.58,-366.65"/>
<polygon fill="#7fff00" stroke="#7fff00" points="452.66,-370.03 463.25,-369.95 454.92,-363.41 452.66,-370.03"/>
</g>
<!-- proc~stdrep -->
<g id="program~~test_algen~~CallsGraph_node30" class="node">
<title>proc~stdrep</title>
<g id="a_program~~test_algen~~CallsGraph_node30"><a xlink:href="../proc/stdrep.html" xlink:title="pikaia_class%stdrep">
<polygon fill="#d9534f" stroke="#d9534f" points="573,-310 464,-310 464,-286 573,-286 573,-310"/>
<text text-anchor="middle" x="518.5" y="-295.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pikaia_class%stdrep</text>
</a>
</g>
</g>
<!-- proc~pikaia&#45;&gt;proc~stdrep -->
<g id="program~~test_algen~~CallsGraph_edge25" class="edge">
<title>proc~pikaia&#45;&gt;proc~stdrep</title>
<path fill="none" stroke="#7fff00" d="M404.02,-298C419.83,-298 437.36,-298 453.81,-298"/>
<polygon fill="#7fff00" stroke="#7fff00" points="453.89,-301.5 463.89,-298 453.89,-294.5 453.89,-301.5"/>
</g>
<!-- proc~urand -->
<g id="program~~test_algen~~CallsGraph_node32" class="node">
<title>proc~urand</title>
<g id="a_program~~test_algen~~CallsGraph_node32"><a xlink:href="../proc/urand.html" xlink:title="pikaia_class%urand">
<polygon fill="#d94e8f" stroke="#d94e8f" points="759,-438 652,-438 652,-414 759,-414 759,-438"/>
<text text-anchor="middle" x="705.5" y="-423.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pikaia_class%urand</text>
</a>
</g>
</g>
<!-- proc~pikaia&#45;&gt;proc~urand -->
<g id="program~~test_algen~~CallsGraph_edge26" class="edge">
<title>proc~pikaia&#45;&gt;proc~urand</title>
<path fill="none" stroke="#7fff00" d="M352.83,-310.16C357.37,-345.15 375.8,-446.17 440,-487 498.88,-524.44 529.53,-504.81 597,-487 628.41,-478.71 660.26,-458.9 681.05,-444.08"/>
<polygon fill="#7fff00" stroke="#7fff00" points="683.24,-446.82 689.25,-438.09 679.11,-441.17 683.24,-446.82"/>
</g>
<!-- proc~add_tang -->
<g id="program~~test_algen~~CallsGraph_node13" class="node">
<title>proc~add_tang</title>
<g id="a_program~~test_algen~~CallsGraph_node13"><a xlink:href="../proc/add_tang.html" xlink:title="add_tang">
<polygon fill="#d94e8f" stroke="#d94e8f" points="734.5,-820 676.5,-820 676.5,-796 734.5,-796 734.5,-820"/>
<text text-anchor="middle" x="705.5" y="-805.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">add_tang</text>
</a>
</g>
</g>
<!-- proc~sk_ku&#45;&gt;proc~add_tang -->
<g id="program~~test_algen~~CallsGraph_edge27" class="edge">
<title>proc~sk_ku&#45;&gt;proc~add_tang</title>
<path fill="none" stroke="#00ffff" d="M545.61,-790.82C577.07,-794.22 630.17,-799.96 666.25,-803.87"/>
<polygon fill="#00ffff" stroke="#00ffff" points="666.08,-807.37 676.4,-804.96 666.83,-800.41 666.08,-807.37"/>
</g>
<!-- proc~tang -->
<g id="program~~test_algen~~CallsGraph_node31" class="node">
<title>proc~tang</title>
<g id="a_program~~test_algen~~CallsGraph_node31"><a xlink:href="../proc/tang.html" xlink:title="tang">
<polygon fill="#d94e8f" stroke="#d94e8f" points="913.5,-800 859.5,-800 859.5,-776 913.5,-776 913.5,-800"/>
<text text-anchor="middle" x="886.5" y="-785.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">tang</text>
</a>
</g>
</g>
<!-- proc~sk_ku&#45;&gt;proc~tang -->
<g id="program~~test_algen~~CallsGraph_edge28" class="edge">
<title>proc~sk_ku&#45;&gt;proc~tang</title>
<path fill="none" stroke="#00ffff" d="M545.65,-787.7C568.65,-787.46 603.05,-787.13 633,-787 697.44,-786.72 713.56,-786.7 778,-787 801.79,-787.11 828.54,-787.36 849.4,-787.58"/>
<polygon fill="#00ffff" stroke="#00ffff" points="849.4,-791.08 859.43,-787.69 849.47,-784.08 849.4,-791.08"/>
</g>
<!-- proc~change_array_order -->
<g id="program~~test_algen~~CallsGraph_node15" class="node">
<title>proc~change_array_order</title>
<g id="a_program~~test_algen~~CallsGraph_node15"><a xlink:href="../proc/change_array_order.html" xlink:title="change_array_order">
<polygon fill="#d9534f" stroke="#d9534f" points="573.5,-596 463.5,-596 463.5,-572 573.5,-572 573.5,-596"/>
<text text-anchor="middle" x="518.5" y="-581.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">change_array_order</text>
</a>
</g>
</g>
<!-- proc~sort_array2&#45;&gt;proc~change_array_order -->
<g id="program~~test_algen~~CallsGraph_edge29" class="edge">
<title>proc~sort_array2&#45;&gt;proc~change_array_order</title>
<path fill="none" stroke="#7f00ff" d="M383.43,-633.98C390.28,-631.19 397.44,-628.12 404,-625 420.53,-617.14 423.04,-611.89 440,-605 445.17,-602.9 450.61,-600.95 456.12,-599.14"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="457.55,-602.36 466.06,-596.05 455.47,-595.68 457.55,-602.36"/>
</g>
<!-- proc~init_order -->
<g id="program~~test_algen~~CallsGraph_node21" class="node">
<title>proc~init_order</title>
<g id="a_program~~test_algen~~CallsGraph_node21"><a xlink:href="../proc/init_order.html" xlink:title="init_order">
<polygon fill="#d9534f" stroke="#d9534f" points="547.5,-758 489.5,-758 489.5,-734 547.5,-734 547.5,-758"/>
<text text-anchor="middle" x="518.5" y="-743.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_order</text>
</a>
</g>
</g>
<!-- proc~sort_array2&#45;&gt;proc~init_order -->
<g id="program~~test_algen~~CallsGraph_edge30" class="edge">
<title>proc~sort_array2&#45;&gt;proc~init_order</title>
<path fill="none" stroke="#7f00ff" d="M361.65,-658.08C376.9,-675.45 407.41,-707.33 440,-725 452.09,-731.55 466.37,-736.17 479.35,-739.38"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="478.9,-742.86 489.42,-741.65 480.44,-736.03 478.9,-742.86"/>
</g>
<!-- proc~sort_array_integer_with_order -->
<g id="program~~test_algen~~CallsGraph_node28" class="node">
<title>proc~sort_array_integer_with_order</title>
<g id="a_program~~test_algen~~CallsGraph_node28"><a xlink:href="../proc/sort_array_integer_with_order.html" xlink:title="sort_array_integer_with_order">
<polygon fill="#d9534f" stroke="#d9534f" points="597,-698 440,-698 440,-674 597,-674 597,-698"/>
<text text-anchor="middle" x="518.5" y="-683.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sort_array_integer_with_order</text>
</a>
</g>
</g>
<!-- proc~sort_array2&#45;&gt;proc~sort_array_integer_with_order -->
<g id="program~~test_algen~~CallsGraph_edge31" class="edge">
<title>proc~sort_array2&#45;&gt;proc~sort_array_integer_with_order</title>
<path fill="none" stroke="#7f00ff" d="M384.3,-653.9C405.14,-658.93 432.75,-665.58 457.43,-671.52"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="456.89,-675 467.44,-673.94 458.53,-668.19 456.89,-675"/>
</g>
<!-- proc~sort_array_real_with_order -->
<g id="program~~test_algen~~CallsGraph_node29" class="node">
<title>proc~sort_array_real_with_order</title>
<g id="a_program~~test_algen~~CallsGraph_node29"><a xlink:href="../proc/sort_array_real_with_order.html" xlink:title="sort_array_real_with_order">
<polygon fill="#d9534f" stroke="#d9534f" points="589.5,-638 447.5,-638 447.5,-614 589.5,-614 589.5,-638"/>
<text text-anchor="middle" x="518.5" y="-623.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sort_array_real_with_order</text>
</a>
</g>
</g>
<!-- proc~sort_array2&#45;&gt;proc~sort_array_real_with_order -->
<g id="program~~test_algen~~CallsGraph_edge32" class="edge">
<title>proc~sort_array2&#45;&gt;proc~sort_array_real_with_order</title>
<path fill="none" stroke="#7f00ff" d="M384.3,-642.05C399.59,-640.21 418.54,-637.92 437.29,-635.66"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="437.85,-639.12 447.36,-634.45 437.01,-632.17 437.85,-639.12"/>
</g>
<!-- proc~add_tang&#45;&gt;proc~tang -->
<g id="program~~test_algen~~CallsGraph_edge33" class="edge">
<title>proc~add_tang&#45;&gt;proc~tang</title>
<path fill="none" stroke="#ff0000" d="M734.86,-804.83C765.73,-801.38 815.18,-795.86 848.94,-792.08"/>
<polygon fill="#ff0000" stroke="#ff0000" points="849.76,-795.52 859.31,-790.93 848.98,-788.56 849.76,-795.52"/>
</g>
<!-- proc~cross&#45;&gt;proc~urand -->
<g id="program~~test_algen~~CallsGraph_edge34" class="edge">
<title>proc~cross&#45;&gt;proc~urand</title>
<path fill="none" stroke="#ffe500" d="M571.03,-424.56C593.01,-424.79 618.86,-425.07 641.92,-425.32"/>
<polygon fill="#ffe500" stroke="#ffe500" points="641.92,-428.82 651.96,-425.43 642,-421.82 641.92,-428.82"/>
</g>
<!-- proc~mutate&#45;&gt;proc~urand -->
<g id="program~~test_algen~~CallsGraph_edge35" class="edge">
<title>proc~mutate&#45;&gt;proc~urand</title>
<path fill="none" stroke="#00ffb2" d="M574.51,-454.11C595.75,-449.51 620.17,-444.23 642.07,-439.5"/>
<polygon fill="#00ffb2" stroke="#00ffb2" points="642.89,-442.9 651.93,-437.37 641.42,-436.06 642.89,-442.9"/>
</g>
<!-- proc~newpop&#45;&gt;proc~func_wrapper -->
<g id="program~~test_algen~~CallsGraph_edge36" class="edge">
<title>proc~newpop&#45;&gt;proc~func_wrapper</title>
<path fill="none" stroke="#00ffff" d="M577.02,-85.78C591.55,-84.21 607.43,-82.49 622.9,-80.82"/>
<polygon fill="#00ffff" stroke="#00ffff" points="623.42,-84.29 632.99,-79.73 622.67,-77.33 623.42,-84.29"/>
</g>
<!-- proc~newpop&#45;&gt;proc~rnkpop -->
<g id="program~~test_algen~~CallsGraph_edge37" class="edge">
<title>proc~newpop&#45;&gt;proc~rnkpop</title>
<path fill="none" stroke="#00ffff" d="M572.51,-104.04C594.09,-108.93 619.2,-114.63 641.69,-119.74"/>
<polygon fill="#00ffff" stroke="#00ffff" points="640.95,-123.16 651.48,-121.96 642.5,-116.34 640.95,-123.16"/>
</g>
<!-- none~initialize -->
<g id="program~~test_algen~~CallsGraph_node33" class="node">
<title>none~initialize</title>
<g id="a_program~~test_algen~~CallsGraph_node33"><a xlink:href="../type/mt19937.html#boundprocedure-initialize" xlink:title="mt19937%initialize">
<polygon fill="#a7506f" stroke="#a7506f" points="937,-529 836,-529 836,-505 937,-505 937,-529"/>
<text text-anchor="middle" x="886.5" y="-514.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mt19937%initialize</text>
</a>
</g>
</g>
<!-- proc~rninit&#45;&gt;none~initialize -->
<g id="program~~test_algen~~CallsGraph_edge38" class="edge">
<title>proc~rninit&#45;&gt;none~initialize</title>
<path fill="none" stroke="#0066ff" d="M757.32,-523.45C778.55,-522.38 803.39,-521.13 825.51,-520.02"/>
<polygon fill="#0066ff" stroke="#0066ff" points="825.98,-523.5 835.79,-519.5 825.63,-516.51 825.98,-523.5"/>
</g>
<!-- proc~rqsort -->
<g id="program~~test_algen~~CallsGraph_node35" class="node">
<title>proc~rqsort</title>
<g id="a_program~~test_algen~~CallsGraph_node35"><a xlink:href="../proc/rqsort.html" xlink:title="rqsort">
<polygon fill="#d9534f" stroke="#d9534f" points="913.5,-146 859.5,-146 859.5,-122 913.5,-122 913.5,-146"/>
<text text-anchor="middle" x="886.5" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rqsort</text>
</a>
</g>
</g>
<!-- proc~rnkpop&#45;&gt;proc~rqsort -->
<g id="program~~test_algen~~CallsGraph_edge39" class="edge">
<title>proc~rnkpop&#45;&gt;proc~rqsort</title>
<path fill="none" stroke="#0019ff" d="M761.67,-134C790.07,-134 823.91,-134 849.03,-134"/>
<polygon fill="#0019ff" stroke="#0019ff" points="849.22,-137.5 859.22,-134 849.22,-130.5 849.22,-137.5"/>
</g>
<!-- proc~select_parents&#45;&gt;proc~urand -->
<g id="program~~test_algen~~CallsGraph_edge40" class="edge">
<title>proc~select_parents&#45;&gt;proc~urand</title>
<path fill="none" stroke="#3200ff" d="M570.05,-394.02C592.89,-399.46 620.06,-405.92 643.98,-411.61"/>
<polygon fill="#3200ff" stroke="#3200ff" points="643.47,-415.08 654.01,-413.99 645.09,-408.27 643.47,-415.08"/>
</g>
<!-- proc~sort_array_integer_with_order&#45;&gt;proc~sort_array_integer_with_order -->
<g id="program~~test_algen~~CallsGraph_edge41" class="edge">
<title>proc~sort_array_integer_with_order&#45;&gt;proc~sort_array_integer_with_order</title>
<path fill="none" stroke="#7f00ff" d="M490.72,-698.01C481.02,-706.97 490.28,-716 518.5,-716 536.14,-716 546.37,-712.47 549.19,-707.64"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="552.52,-706.57 546.28,-698.01 545.83,-708.6 552.52,-706.57"/>
</g>
<!-- proc~sort_array_real_with_order&#45;&gt;proc~sort_array_real_with_order -->
<g id="program~~test_algen~~CallsGraph_edge42" class="edge">
<title>proc~sort_array_real_with_order&#45;&gt;proc~sort_array_real_with_order</title>
<path fill="none" stroke="#cc00ff" d="M490.72,-638.01C481.02,-646.97 490.28,-656 518.5,-656 536.14,-656 546.37,-652.47 549.19,-647.64"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="552.52,-646.57 546.28,-638.01 545.83,-648.6 552.52,-646.57"/>
</g>
<!-- proc~stdrep&#45;&gt;proc~urand -->
<g id="program~~test_algen~~CallsGraph_edge43" class="edge">
<title>proc~stdrep&#45;&gt;proc~urand</title>
<path fill="none" stroke="#ff00e5" d="M573.08,-308.59C581.38,-311.33 589.64,-314.75 597,-319 635.79,-341.41 670.49,-381.28 689.42,-405.51"/>
<polygon fill="#ff00e5" stroke="#ff00e5" points="686.8,-407.85 695.65,-413.67 692.36,-403.6 686.8,-407.85"/>
</g>
<!-- proc~genrand64_real1 -->
<g id="program~~test_algen~~CallsGraph_node34" class="node">
<title>proc~genrand64_real1</title>
<g id="a_program~~test_algen~~CallsGraph_node34"><a xlink:href="../proc/genrand64_real1.html" xlink:title="mt19937%genrand64_real1">
<polygon fill="#d94e8f" stroke="#d94e8f" points="959,-442 814,-442 814,-418 959,-418 959,-442"/>
<text text-anchor="middle" x="886.5" y="-427.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mt19937%genrand64_real1</text>
</a>
</g>
</g>
<!-- proc~urand&#45;&gt;proc~genrand64_real1 -->
<g id="program~~test_algen~~CallsGraph_edge44" class="edge">
<title>proc~urand&#45;&gt;proc~genrand64_real1</title>
<path fill="none" stroke="#ff004c" d="M759.24,-427.18C773.15,-427.49 788.49,-427.83 803.55,-428.17"/>
<polygon fill="#ff004c" stroke="#ff004c" points="803.83,-431.68 813.9,-428.4 803.98,-424.68 803.83,-431.68"/>
</g>
<!-- proc~init_by_array64 -->
<g id="program~~test_algen~~CallsGraph_node37" class="node">
<title>proc~init_by_array64</title>
<g id="a_program~~test_algen~~CallsGraph_node37"><a xlink:href="../proc/init_by_array64.html" xlink:title="mt19937%init_by_array64">
<polygon fill="#d9534f" stroke="#d9534f" points="1138,-487 1001,-487 1001,-463 1138,-463 1138,-487"/>
<text text-anchor="middle" x="1069.5" y="-472.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mt19937%init_by_array64</text>
</a>
</g>
</g>
<!-- none~initialize&#45;&gt;proc~init_by_array64 -->
<g id="program~~test_algen~~CallsGraph_edge45" class="edge">
<title>none~initialize&#45;&gt;proc~init_by_array64</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M937.44,-505.41C958.86,-500.44 984.1,-494.58 1006.69,-489.34"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1007.57,-492.73 1016.52,-487.06 1005.98,-485.91 1007.57,-492.73"/>
</g>
<!-- proc~init_genrand64 -->
<g id="program~~test_algen~~CallsGraph_node38" class="node">
<title>proc~init_genrand64</title>
<g id="a_program~~test_algen~~CallsGraph_node38"><a xlink:href="../proc/init_genrand64.html" xlink:title="mt19937%init_genrand64">
<polygon fill="#d9534f" stroke="#d9534f" points="1315,-487 1180,-487 1180,-463 1315,-463 1315,-487"/>
<text text-anchor="middle" x="1247.5" y="-472.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mt19937%init_genrand64</text>
</a>
</g>
</g>
<!-- none~initialize&#45;&gt;proc~init_genrand64 -->
<g id="program~~test_algen~~CallsGraph_edge46" class="edge">
<title>none~initialize&#45;&gt;proc~init_genrand64</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M928.34,-529.05C979.68,-542.24 1070.05,-558.91 1144,-538 1174.47,-529.39 1204.79,-508.89 1224.45,-493.6"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1226.82,-496.18 1232.45,-487.21 1222.46,-490.71 1226.82,-496.18"/>
</g>
<!-- proc~init_genrand64_i4 -->
<g id="program~~test_algen~~CallsGraph_node39" class="node">
<title>proc~init_genrand64_i4</title>
<g id="a_program~~test_algen~~CallsGraph_node39"><a xlink:href="../proc/init_genrand64_i4.html" xlink:title="mt19937%init_genrand64_i4">
<polygon fill="#d9534f" stroke="#d9534f" points="1144,-529 995,-529 995,-505 1144,-505 1144,-529"/>
<text text-anchor="middle" x="1069.5" y="-514.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mt19937%init_genrand64_i4</text>
</a>
</g>
</g>
<!-- none~initialize&#45;&gt;proc~init_genrand64_i4 -->
<g id="program~~test_algen~~CallsGraph_edge47" class="edge">
<title>none~initialize&#45;&gt;proc~init_genrand64_i4</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M937.44,-510.89C951.94,-510.4 968.2,-510.19 984.2,-510.26"/>
<polygon fill="#ff0000" stroke="#ff0000" points="984.63,-513.77 994.66,-510.35 984.69,-506.77 984.63,-513.77"/>
</g>
<!-- proc~genrand64_int64 -->
<g id="program~~test_algen~~CallsGraph_node36" class="node">
<title>proc~genrand64_int64</title>
<g id="a_program~~test_algen~~CallsGraph_node36"><a xlink:href="../proc/genrand64_int64.html" xlink:title="mt19937%genrand64_int64">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1142,-443 997,-443 997,-419 1142,-419 1142,-443"/>
<text text-anchor="middle" x="1069.5" y="-428.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mt19937%genrand64_int64</text>
</a>
</g>
</g>
<!-- proc~genrand64_real1&#45;&gt;proc~genrand64_int64 -->
<g id="program~~test_algen~~CallsGraph_edge48" class="edge">
<title>proc~genrand64_real1&#45;&gt;proc~genrand64_int64</title>
<path fill="none" stroke="#00ff00" d="M959.04,-430.4C968.18,-430.45 977.59,-430.5 986.88,-430.55"/>
<polygon fill="#00ff00" stroke="#00ff00" points="986.87,-434.05 996.89,-430.6 986.91,-427.05 986.87,-434.05"/>
</g>
<!-- proc~genrand64_int64&#45;&gt;proc~init_genrand64 -->
<g id="program~~test_algen~~CallsGraph_edge49" class="edge">
<title>proc~genrand64_int64&#45;&gt;proc~init_genrand64</title>
<path fill="none" stroke="#ff0000" d="M1118.59,-443.02C1140.23,-448.43 1165.94,-454.86 1188.62,-460.53"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1187.92,-463.96 1198.47,-462.99 1189.61,-457.17 1187.92,-463.96"/>
</g>
<!-- proc~init_by_array64&#45;&gt;proc~init_genrand64 -->
<g id="program~~test_algen~~CallsGraph_edge50" class="edge">
<title>proc~init_by_array64&#45;&gt;proc~init_genrand64</title>
<path fill="none" stroke="#7fff00" d="M1138.04,-475C1148.4,-475 1159.16,-475 1169.7,-475"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1169.72,-478.5 1179.72,-475 1169.72,-471.5 1169.72,-478.5"/>
</g>
<!-- proc~init_genrand64_i4&#45;&gt;none~initialize -->
<g id="program~~test_algen~~CallsGraph_edge51" class="edge">
<title>proc~init_genrand64_i4&#45;&gt;none~initialize</title>
<path fill="none" stroke="#7f00ff" d="M994.66,-523.65C979.02,-523.84 962.69,-523.76 947.64,-523.4"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="947.53,-519.9 937.44,-523.11 947.33,-526.89 947.53,-519.9"/>
</g>
</g>
</svg>
</div>                <script>
                  var panprogramtest_algenCallsGraph = svgPanZoom('#programtest_algenCallsGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CallsGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CallsGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="29pt"
 viewBox="0.00 0.00 641.00 29.32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.92 0.92) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 695.5,-28 695.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,0 64,0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,0 136,0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,0 209.5,0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="350,-24 228,-24 228,0 350,0 350,-24"/>
<text text-anchor="middle" x="289" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="504,-24 368,-24 368,0 504,0 504,-24"/>
<text text-anchor="middle" x="436" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="576,-24 522,-24 522,0 576,0 576,-24"/>
<text text-anchor="middle" x="549" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="691.5,-24 594.5,-24 594.5,0 691.5,0 691.5,-24"/>
<text text-anchor="middle" x="643" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 Where possible, edges connecting nodes are
given different colours to make them easier to distinguish in
large graphs.</div>
            </div>
          </div>
        </div>
      </div>
    </div>
<br>

    <section>
    <h2>Variables</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-sku"></span>
              real(kind=R8),
            </td>
            <td>
parameter               
            </td>
            <td>::</td>
            <td><strong>SKU</strong></td>
<td> =</td>
                <td>+20.0_R8</td>
            <td>
                <p><em>Imposed surface height kurtosis</em></p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ssk"></span>
              real(kind=R8),
            </td>
            <td>
parameter               
            </td>
            <td>::</td>
            <td><strong>SSK</strong></td>
<td> =</td>
                <td>-01.0_R8</td>
            <td>
                <p><em>Imposed surface height skewness</em></p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-f~2"></span>
              real(kind=R8)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>f</strong></td>
                <td></td>
                <td></td>
            <td>
                <p><em>best cost</em></p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-f_xx"></span>
              real(kind=R8)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>f_xx</strong></td>
                <td></td>
                <td></td>
            <td>
                <p><em>cost function or optimization function at</em> <code>xx</code></p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-i~33"></span>
              integer(kind=I4)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>i</strong></td>
                <td></td>
                <td></td>
            <td>
                <p><em>loop indices</em></p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iu"></span>
              integer(kind=I4)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iu</strong></td>
                <td></td>
                <td></td>
            <td>
                <p><em>i/o unit</em></p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-j~26"></span>
              integer(kind=I4)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>j</strong></td>
                <td></td>
                <td></td>
            <td>
                <p><em>loop indices</em></p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-k~14"></span>
              integer(kind=I4)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>k</strong></td>
                <td></td>
                <td></td>
            <td>
                <p><em>loop indices</em></p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-mom"></span>
              type(<a href='../type/moment_stat.html'>moment_stat</a>)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>mom</strong></td>
                <td></td>
                <td></td>
            <td>
                <p><em>a statistical moment variable</em></p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nb_th"></span>
              integer(kind=I4)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>nb_th</strong></td>
                <td></td>
                <td></td>
            <td>
                <p><em>nb threads</em></p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nn~2"></span>
              integer(kind=I4),
            </td>
            <td>
parameter               
            </td>
            <td>::</td>
            <td><strong>nn</strong></td>
<td> =</td>
                <td>512</td>
            <td>
                <p><em>Surface side dimension</em></p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-p~3"></span>
              type(<a href='../type/pikaia_class.html'>pikaia_class</a>)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>p</strong></td>
                <td></td>
                <td></td>
            <td>
                <p><strong>PIKAIA</strong> <em>class instanciation</em></p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-status~57"></span>
              integer(kind=I4)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>status</strong></td>
                <td></td>
                <td></td>
            <td>
                <p><strong>PIKAIA</strong> <em>status</em></p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-tab_sur"></span>
              real(kind=R8)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>tab_sur</strong>(1:nn*nn)</td>
                <td></td>
                <td></td>
            <td>
                <p><em>output surface heights</em></p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-tend"></span>
              real(kind=R8)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>tend</strong></td>
                <td></td>
                <td></td>
            <td>
                <p><em>time variables</em></p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-tstart"></span>
              real(kind=R8)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>tstart</strong></td>
                <td></td>
                <td></td>
            <td>
                <p><em>time variables</em></p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xl"></span>
              real(kind=R8),
            </td>
            <td>
              dimension(1:2)
            </td>
            <td>::</td>
            <td><strong>xl</strong></td>
                <td></td>
                <td></td>
            <td>
                <p><em>lower and upper bonds of xx</em></p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xu"></span>
              real(kind=R8),
            </td>
            <td>
              dimension(1:2)
            </td>
            <td>::</td>
            <td><strong>xu</strong></td>
                <td></td>
                <td></td>
            <td>
                <p><em>lower and upper bonds of xx</em></p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xx"></span>
              real(kind=R8),
            </td>
            <td>
              dimension(1:2)
            </td>
            <td>::</td>
            <td><strong>xx</strong></td>
                <td></td>
                <td></td>
            <td>
                <p><em>chromosom for</em> <strong>PIKAIA</strong></p>
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    
    
    

    <section>
   <h2>Derived Types</h2>
       <div class="card">
    <div class="card-header codesum">
      <span class="anchor" id="type-moment_stat"></span>
      <h3>
        type&nbsp;::&nbsp;
        <a href='../type/moment_stat.html'>moment_stat</a>
        
      </h3>
    </div>
    <div class="card-body">
      <p><span style="color:green">Statistical moment type</span></p>

        <h4>Components</h4>
          <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-ku"></span>
              real(kind=R8),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ku</strong></td>
                <td></td>
                <td></td>
            <td>
<p><em>kurtosis</em></p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-mu~4"></span>
              real(kind=R8),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>mu</strong></td>
                <td></td>
                <td></td>
            <td>
<p><em>mean</em></p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-si"></span>
              real(kind=R8),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>si</strong></td>
                <td></td>
                <td></td>
            <td>
<p><em>standard deviation</em></p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-sk"></span>
              real(kind=R8),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>sk</strong></td>
                <td></td>
                <td></td>
            <td>
<p><em>skewness</em></p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-va"></span>
              real(kind=R8),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>va</strong></td>
                <td></td>
                <td></td>
            <td>
<p><em>variance</em></p>
            </td>
        </tr>
    </tbody>
  </table>




    </div>
  </div>

    </section>
   <br>
    
 
    <section>
    <h2>Functions</h2>
      <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-abs_diff_sk_ku"></span> <h3> function <a href='../proc/abs_diff_sk_ku.html'>abs_diff_sk_ku</a>(chrom)  
</h3></div>
    <div class="card-body">
          
  

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-chrom"></span>
              real(kind=R8),
            </td>
<td>intent(in),</td>
              <td></td>            <td>
              dimension(1:2)
            </td>
            <td>::</td>
            <td><strong>chrom</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>

    <h4>
    Return Value
    <small>real(kind=r8)</small>
    </h4>
    

    </div>
  </div>

      <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-add_tang"></span> <h3> function <a href='../proc/add_tang.html'>add_tang</a>(n, deb, fin, alp, bet, mu, si)  
</h3></div>
    <div class="card-body">
          
  

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-n~71"></span>
              integer(kind=i4),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>n</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-deb~2"></span>
              integer(kind=i4),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>deb</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fin~2"></span>
              integer(kind=i4),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>fin</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-alp~2"></span>
              real(kind=R8),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>alp</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-bet~2"></span>
              real(kind=R8),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>bet</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-mu~6"></span>
              real(kind=R8),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>mu</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-si~3"></span>
              real(kind=R8),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>si</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>

    <h4>
    Return Value
    <small>real(kind=r8)</small>
    </h4>
    

    </div>
  </div>

      <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-cost_func"></span> <h3> function <a href='../proc/cost_func.html'>cost_func</a>(chrom)  
</h3></div>
    <div class="card-body">
          
  

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-chrom~2"></span>
              real(kind=R8),
            </td>
<td>intent(in),</td>
              <td></td>            <td>
              dimension(1:2)
            </td>
            <td>::</td>
            <td><strong>chrom</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>

    <h4>
    Return Value
    <small>real(kind=r8)</small>
    </h4>
    

    </div>
  </div>

      <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-tang"></span> <h3> function <a href='../proc/tang.html'>tang</a>(xi, n, alp, bet, mu, si)  
</h3></div>
    <div class="card-body">
          
  

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-xi~5"></span>
              real(kind=R8),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>xi</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-n~72"></span>
              integer(kind=i4),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>n</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-alp~3"></span>
              real(kind=R8),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>alp</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-bet~3"></span>
              real(kind=R8),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>bet</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-mu~7"></span>
              real(kind=R8),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>mu</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-si~4"></span>
              real(kind=R8),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>si</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>

    <h4>
    Return Value
    <small>real(kind=r8)</small>
    </h4>
    

    </div>
  </div>

    </section>
    <br>


    <section>
    <h2>Subroutines</h2>
      <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-calc_moments_1d"></span> <h3> subroutine <a href='../proc/calc_moments_1d.html'>calc_moments_1D</a>(tab, mx, nb_mom, lg)  
</h3></div>
    <div class="card-body">
          
  

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-tab~2"></span>
              real(kind=R8),
            </td>
<td>intent(in),</td>
              <td></td>            <td>
              dimension(1:lg)
            </td>
            <td>::</td>
            <td><strong>tab</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-mx"></span>
              type(<a href='../type/moment_stat.html'>moment_stat</a>),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>mx</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nb_mom"></span>
              integer(kind=I4),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>nb_mom</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lg"></span>
              integer(kind=I4),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>lg</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

      <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-cost"></span> <h3> subroutine <a href='../proc/cost.html'>cost</a>(me, x, f)  
</h3></div>
    <div class="card-body">
          
  

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-me"></span>
              class(<a href='../type/pikaia_class.html'>pikaia_class</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>me</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-x~61"></span>
              real(kind=R8),
            </td>
<td>intent(in),</td>
              <td></td>            <td>
              dimension(:)
            </td>
            <td>::</td>
            <td><strong>x</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-f~3"></span>
              real(kind=R8),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>f</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

      <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-melange"></span> <h3> subroutine <a href='../proc/melange.html'>melange</a>(tab, lg)  
</h3></div>
    <div class="card-body">
          
  

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-tab~4"></span>
              real(kind=r8),
            </td>
<td>intent(inout),</td>
              <td></td>            <td>
              dimension(1:lg)
            </td>
            <td>::</td>
            <td><strong>tab</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lg~3"></span>
              integer(kind=i4),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>lg</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

      <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-newton_raphson_downhill"></span> <h3> subroutine <a href='../proc/newton_raphson_downhill.html'>newton_raphson_downhill</a>(x, fvec, eps, ndir, rel)  
</h3></div>
    <div class="card-body">
          
  

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-x~62"></span>
              real(kind=R8),
            </td>
<td>intent(inout),</td>
              <td></td>            <td>
              dimension(1:2)
            </td>
            <td>::</td>
            <td><strong>x</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fvec~32"></span>
              real(kind=R8),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>fvec</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-eps~4"></span>
              real(kind=R8),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>eps</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ndir"></span>
              integer(kind=I4),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>ndir</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rel"></span>
              real(kind=R8),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>rel</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

      <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-profil_theo_trie_1d"></span> <h3> subroutine <a href='../proc/profil_theo_trie_1d.html'>profil_theo_trie_1D</a>(tab, lg, x, mx)  
</h3></div>
    <div class="card-body">
          
  

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-tab~3"></span>
              real(kind=R8),
            </td>
<td>intent(out),</td>
              <td></td>            <td>
              dimension(1:lg)
            </td>
            <td>::</td>
            <td><strong>tab</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lg~2"></span>
              integer(kind=I4),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>lg</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-x~64"></span>
              real(kind=R8),
            </td>
<td>intent(in),</td>
              <td></td>            <td>
              dimension(1:2)
            </td>
            <td>::</td>
            <td><strong>x</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-mx~2"></span>
              type(<a href='../type/moment_stat.html'>moment_stat</a>),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>mx</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

      <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-sk_ku"></span> <h3> subroutine <a href='../proc/sk_ku.html'>sk_ku</a>(xx, sk, ku)  
</h3></div>
    <div class="card-body">
          
  

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-xx~2"></span>
              real(kind=R8),
            </td>
<td>intent(in),</td>
              <td></td>            <td>
              dimension(1:2)
            </td>
            <td>::</td>
            <td><strong>xx</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-sk~3"></span>
              real(kind=R8),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>sk</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ku~3"></span>
              real(kind=R8),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>ku</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

    </section>    
    

    <section>
    <h2 id="src">Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="k">program </span><span class="n">test_algen</span>
<span class="k">use </span><span class="n">omp_lib</span>
<span class="k">use </span><span class="n">sort_arrays</span><span class="p">,</span><span class="w">   </span><span class="k">only</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">sort_array2</span>
<span class="k">use </span><span class="n">data_arch</span><span class="p">,</span><span class="w">     </span><span class="k">only</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">I4</span><span class="p">,</span><span class="w"> </span><span class="n">R8</span><span class="p">,</span><span class="w"> </span><span class="n">PI_R8</span>
<span class="k">use </span><span class="n">miscellaneous</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">get_unit</span>
<span class="k">use </span><span class="n">pikaia_oop</span><span class="p">,</span><span class="w">    </span><span class="k">only</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">pikaia_class</span>

<span class="k">implicit none</span>

<span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">I4</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nn</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">512</span><span class="w">        </span><span class="c">!! *Surface side dimension*</span>
<span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">),</span><span class="w">    </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">SSK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">0</span><span class="mf">1.0_R8</span><span class="w">   </span><span class="c">!! *Imposed surface height skewness*</span>
<span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">),</span><span class="w">    </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">SKU</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">+</span><span class="mi">2</span><span class="mf">0.0_R8</span><span class="w">   </span><span class="c">!! *Imposed surface height kurtosis*</span>

<span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">I4</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">status</span><span class="w">                      </span><span class="c">!! **PIKAIA** *status*</span>
<span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">I4</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w">                     </span><span class="c">!! *loop indices*</span>
<span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">I4</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iu</span><span class="w">                          </span><span class="c">!! *i/o unit*</span>
<span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">I4</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nb_th</span><span class="w">                       </span><span class="c">!! *nb threads*</span>

<span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xx</span><span class="w">             </span><span class="c">!! *chromosom for* **PIKAIA**</span>
<span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xl</span><span class="p">,</span><span class="w"> </span><span class="n">xu</span><span class="w">         </span><span class="c">!! *lower and upper bonds of xx*</span>

<span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">f_xx</span><span class="w">                        </span><span class="c">!! *cost function or optimization function at* ```xx```</span>
<span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">tab_sur</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nn</span><span class="o">*</span><span class="n">nn</span><span class="p">)</span><span class="w">            </span><span class="c">!! *output surface heights*</span>

<span class="k">type </span><span class="n">moment_stat</span>
<span class="c">!! &lt;span style=&quot;color:green&quot;&gt;Statistical moment type&lt;/span&gt;</span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">mu</span><span class="w"> </span><span class="c">!! *mean*</span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">va</span><span class="w"> </span><span class="c">!! *variance*</span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">si</span><span class="w"> </span><span class="c">!! *standard deviation*</span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">sk</span><span class="w"> </span><span class="c">!! *skewness*</span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ku</span><span class="w"> </span><span class="c">!! *kurtosis*</span>
<span class="k">endtype </span><span class="n">moment_stat</span>

<span class="k">type</span><span class="p">(</span><span class="n">moment_stat</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">mom</span><span class="w">   </span><span class="c">!! *a statistical moment variable*</span>

<span class="k">type</span><span class="p">(</span><span class="n">pikaia_class</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">p</span><span class="w">              </span><span class="c">!! **PIKAIA** *class instanciation*</span>
<span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">)</span><span class="w">        </span><span class="kd">::</span><span class="w"> </span><span class="n">f</span><span class="w">              </span><span class="c">!! *best cost*</span>
<span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">)</span><span class="w">        </span><span class="kd">::</span><span class="w"> </span><span class="n">tstart</span><span class="p">,</span><span class="n">tend</span><span class="w">    </span><span class="c">!! *time variables*</span>


<span class="w">   </span><span class="c">!$ real(kind=R8)    :: ostart,oend    !! *openmp time variables*</span>
<span class="w">   </span><span class="c">!$ integer(kind=I4) :: tid            !! *active thread*</span>

<span class="w">   </span><span class="n">nb_th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>

<span class="w">   </span><span class="c">! get the number of available threads</span>
<span class="w">   </span><span class="c">!$OMP PARALLEL PRIVATE(nb_th, TID)</span>
<span class="w">   </span><span class="c">!$</span>
<span class="w">   </span><span class="c">!$ tid = omp_get_thread_num()</span>
<span class="w">   </span><span class="c">!$</span>
<span class="w">   </span><span class="c">!$ if (tid == 0) then</span>
<span class="w">   </span><span class="c">!$    nb_th = omp_get_num_threads()</span>
<span class="w">   </span><span class="c">!$    write(*,&#39;(A)&#39;) &#39;--------------&#39;</span>
<span class="w">   </span><span class="c">!$    write(*,&#39;(A,1X,I5)&#39;) &#39;number of OMP threads: &#39;, nb_th</span>
<span class="w">   </span><span class="c">!$    write(*,&#39;(A)&#39;) &#39;--------------&#39;</span>
<span class="w">   </span><span class="c">!$ endif</span>
<span class="w">   </span><span class="c">!$OMP END PARALLEL</span>

<span class="w">   </span><span class="n">xx</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_R8</span>
<span class="w">   </span><span class="n">xl</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_R8</span>
<span class="w">   </span><span class="n">xu</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0_R8</span>

<span class="w">   </span><span class="c">!initialize the class:</span>
<span class="w">   </span><span class="k">call </span><span class="n">p</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="w">           </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">                   </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! IN           ; the parameter space dimension, i.e., the number of adjustable parameters (size of the x vector).</span>
<span class="w">                         </span><span class="n">xl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xl</span><span class="p">,</span><span class="w">                  </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! IN, DIM(n)   ;  vector of lower bounds for x</span>
<span class="w">                         </span><span class="n">xu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xu</span><span class="p">,</span><span class="w">                  </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! IN, DIM(n)   ;  vector of upper bounds for x</span>
<span class="w">                          </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cost</span><span class="p">,</span><span class="w">                </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!              ; user-supplied scalar function of n variables, which must have the pikaia_func procedure interface.</span>
<span class="w">                     </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w">              </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! OUT          ; status output flag (0 if there were no errors)</span>
<span class="w">                    </span><span class="c">!iter_f = report_iteration,    &amp;  !     OPT      ; user-supplied subroutine that will report the best solution for each generation. It must have the iter_func procedure interface.</span>
<span class="w">                         </span><span class="n">np</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">                 </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! IN, OPT      ; number of individuals in a population (default is 100)</span>
<span class="w">                       </span><span class="n">ngen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">                </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! IN, OPT      ; maximum number of iterations</span>
<span class="w">                         </span><span class="n">nd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">9</span><span class="p">,</span><span class="w">                   </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! IN           ; number of significant digits (i.e., number of genes) retained in chromosomal encoding</span>
<span class="w">                     </span><span class="n">pcross</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.85_R8</span><span class="p">,</span><span class="w">             </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! IN, OPT      ; crossover probability; must be &lt;= 1.0 (default is 0.85). If crossover takes place, either one or two splicing points are used, with equal probabilities</span>
<span class="w">                     </span><span class="n">pmutmn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0005_R8</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! IN, OPT      ; minimum mutation rate; must be &gt;= 0.0 (default is 0.0005)</span>
<span class="w">                     </span><span class="n">pmutmx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.25_R8</span><span class="p">,</span><span class="w">             </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! IN, OPT      ; maximum mutation rate; must be &lt;= 1.0 (default is 0.25)</span>
<span class="w">                       </span><span class="n">pmut</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.005_R8</span><span class="p">,</span><span class="w">            </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! IN, OPT      ; initial mutation rate; should be small (default is 0.005) (Note: the mutation rate is the probability that any one gene locus will mutate in any one generation.)</span>
<span class="w">                       </span><span class="n">imut</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">                   </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! IN, OPT      ; mutation mode; 1/2/3/4/5 (default is 2).</span>
<span class="w">                                                      </span><span class="c">!              1=one-point mutation, fixed rate.</span>
<span class="w">                                                      </span><span class="c">!              2=one-point, adjustable rate based on fitness.</span>
<span class="w">                                                      </span><span class="c">!              3=one-point, adjustable rate based on distance.</span>
<span class="w">                                                      </span><span class="c">!              4=one-point+creep, fixed rate.</span>
<span class="w">                                                      </span><span class="c">!              5=one-point+creep, adjustable rate based on fitness.</span>
<span class="w">                                                      </span><span class="c">!              6=one-point+creep, adjustable rate based on distance.</span>
<span class="w">                       </span><span class="n">fdif</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1._R8</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! IN, OPT      ; relative fitness differential; range from 0 (none) to 1 (maximum). (default is 1.0)</span>
<span class="w">                       </span><span class="n">irep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">                   </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! IN, OPT      ; reproduction plan; 1/2/3=Full generational replacement/Steady-state-replace-random/Steady- state-replace-worst (default is 3)</span>
<span class="w">                     </span><span class="n">ielite</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">                   </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! IN, OPT      ; elitism flag; 0/1=off/on (default is 0) (Applies only to reproduction plans 1 and 2)</span>
<span class="w">                       </span><span class="n">ivrb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">                   </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! IN, OPT      ; printed output 0/1/2=None/Minimal/Verbose</span>
<span class="w">            </span><span class="n">convergence_tol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0e-6_R8</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! IN, OPT      ; convergence tolerance; must be &gt; 0.0 (default is 0.0001)</span>
<span class="w">         </span><span class="n">convergence_window</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w">                 </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! IN, OPT      ; convergence window; must be &gt;= 0 This is the number of consecutive solutions within the tolerance for convergence to be declared (default is 20)</span>
<span class="w">         </span><span class="n">initial_guess_frac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1_R8</span><span class="p">,</span><span class="w">              </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! IN, OPT      ; raction of the initial population to set equal to the initial guess. Range from 0 (none) to 1.0 (all). (default is 0.1 or 10%).</span>
<span class="w">                      </span><span class="n">iseed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">999</span><span class="p">)</span><span class="w">                    </span><span class="c">! IN, OPT      ; random seed value; must be &gt; 0 (default is 999)</span>

<span class="w">   </span><span class="c">!Now call pikaia:</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">tstart</span><span class="p">)</span>
<span class="w">   </span><span class="c">!$ ostart = omp_get_wtime()</span>

<span class="w">   </span><span class="k">call </span><span class="n">p</span><span class="p">%</span><span class="n">solve</span><span class="p">(</span><span class="w">      </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xx</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">),</span><span class="w">     </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! INOUT, DIM(*) ;</span>
<span class="w">                      </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!   OUT         ;</span>
<span class="w">                 </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">status</span><span class="p">)</span><span class="w"> </span><span class="c">!,   &amp;  !   OUT         ;</span>
<span class="c">!~                     omp = .false. )    ! IN, OPTIONAL</span>

<span class="w">   </span><span class="c">!$ oend = omp_get_wtime()</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">tend</span><span class="p">)</span>

<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Total time spent: &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">tend</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">tstart</span>
<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Real time spent:  &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">oend</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ostart</span>

<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Absolute diff after GA: &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">abs_diff_sk_ku</span><span class="p">(</span><span class="n">chrom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xx</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">))</span>

<span class="w">   </span><span class="c">! optimization function ran with this &quot;good&quot; solution</span>
<span class="w">   </span><span class="k">call </span><span class="n">newton_raphson_downhill</span><span class="p">(</span><span class="w"> </span><span class="n">x</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">xx</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">),</span><span class="w">           </span><span class="p">&amp;</span><span class="w"> </span><span class="c">! starting/ending point</span>
<span class="w">                                 </span><span class="n">fvec</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">f_xx</span><span class="p">,</span><span class="w">              </span><span class="p">&amp;</span><span class="w"> </span><span class="c">! best deviation to the wanted solution</span>
<span class="w">                                 </span><span class="n">eps</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mf">1.e-6_R8</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"> </span><span class="c">! dx</span>
<span class="w">                                 </span><span class="n">ndir</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">32</span><span class="o">*</span><span class="n">nb_th</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"> </span><span class="c">! number of directions to explore</span>
<span class="w">                                 </span><span class="n">rel</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mf">0.9_R8</span><span class="p">)</span><span class="w">              </span><span class="c">! relaxation parameter</span>

<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Absolute diff after refinement: &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">abs_diff_sk_ku</span><span class="p">(</span><span class="n">chrom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xx</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">))</span>


<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;A (nn x nn) SSK, SKU random surface will be now generated&#39;</span>

<span class="w">   </span><span class="c">! generation of nn*nn heights with the tangent function with xx(1:2) as bound parameters.</span>
<span class="w">   </span><span class="c">! mu = 0.</span>
<span class="w">   </span><span class="c">! va = si = 1.</span>
<span class="w">   </span><span class="c">! sk = SSK</span>
<span class="w">   </span><span class="c">! ku = SKU</span>
<span class="w">   </span><span class="k">call </span><span class="n">profil_theo_trie_1D</span><span class="p">(</span><span class="n">tab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tab_sur</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nn</span><span class="o">*</span><span class="n">nn</span><span class="p">),</span><span class="w">   </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! resulting vector of heights</span>
<span class="w">                             </span><span class="n">lg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nn</span><span class="o">*</span><span class="n">nn</span><span class="p">,</span><span class="w">              </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! vector length</span>
<span class="w">                              </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xx</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">),</span><span class="w">            </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! best variable couple</span>
<span class="w">                             </span><span class="n">mx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mom</span><span class="p">)</span><span class="w">                   </span><span class="c">! resulting moment</span>

<span class="w">   </span><span class="c">! height shuffle</span>
<span class="w">   </span><span class="k">call </span><span class="n">melange</span><span class="p">(</span><span class="n">tab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tab_sur</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nn</span><span class="o">*</span><span class="n">nn</span><span class="p">),</span><span class="w">   </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<span class="w">                 </span><span class="n">lg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nn</span><span class="o">*</span><span class="n">nn</span><span class="p">)</span><span class="w">                 </span><span class="c">!</span>

<span class="w">   </span><span class="c">! random surface output in ascii format</span>
<span class="w">   </span><span class="k">call </span><span class="n">get_unit</span><span class="p">(</span><span class="n">iunit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iu</span><span class="p">)</span>
<span class="w">   </span><span class="k">open</span><span class="p">(</span><span class="n">unit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iu</span><span class="p">,</span><span class="w"> </span><span class="k">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;out/surf.dat&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">      </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nn</span>
<span class="w">      </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nn</span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="n">iu</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">tab_sur</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="w">         </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">+</span><span class="mi">1</span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">      enddo</span>
<span class="k">   close</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">iu</span><span class="p">)</span>

<span class="w">   </span><span class="c">! statistical moments check</span>
<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;statistical moments:&#39;</span>
<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w">  </span><span class="n">mom</span><span class="p">%</span><span class="n">mu</span><span class="p">,</span><span class="w"> </span><span class="n">mom</span><span class="p">%</span><span class="n">si</span><span class="p">,</span><span class="w"> </span><span class="n">mom</span><span class="p">%</span><span class="n">sk</span><span class="p">,</span><span class="w"> </span><span class="n">mom</span><span class="p">%</span><span class="n">ku</span>

<span class="w">   </span><span class="c">! precision</span>
<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(a, e8.2)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;maximum difference (%) &#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="mi">100</span><span class="o">*</span><span class="nb">abs</span><span class="p">((</span><span class="n">mom</span><span class="p">%</span><span class="n">sk</span><span class="w"> </span><span class="o">-</span><span class="n">SSK</span><span class="p">)</span><span class="o">/</span><span class="n">SSK</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="c">!</span>
<span class="w">                                                        </span><span class="mi">100</span><span class="o">*</span><span class="nb">abs</span><span class="p">((</span><span class="n">mom</span><span class="p">%</span><span class="n">ku</span><span class="w"> </span><span class="o">-</span><span class="n">SKU</span><span class="p">)</span><span class="o">/</span><span class="n">SKU</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>

<span class="k">stop</span>

<span class="k">contains</span>

<span class="k">   subroutine </span><span class="n">cost</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">)</span>
<span class="w">   </span><span class="k">implicit none</span>
<span class="k">   class</span><span class="p">(</span><span class="n">pikaia_class</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w">               </span><span class="kd">::</span><span class="w"> </span><span class="n">me</span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">)</span><span class="w">      </span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="w">   </span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">x</span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">)</span><span class="w">      </span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="w">  </span><span class="n">out</span><span class="p">)</span><span class="w">               </span><span class="kd">::</span><span class="w"> </span><span class="n">f</span>

<span class="w">      </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">abs_diff_sk_ku</span><span class="p">(</span><span class="n">chrom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)))</span>

<span class="w">   </span><span class="k">return</span>
<span class="k">   endsubroutine </span><span class="n">cost</span>


<span class="w">   </span><span class="k">subroutine </span><span class="n">newton_raphson_downhill</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">,</span><span class="w"> </span><span class="n">eps</span><span class="p">,</span><span class="w"> </span><span class="n">ndir</span><span class="p">,</span><span class="w"> </span><span class="n">rel</span><span class="p">)</span>
<span class="w">   </span><span class="k">implicit none</span>
<span class="k">   </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">I4</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="w">   </span><span class="p">)</span><span class="w">                 </span><span class="kd">::</span><span class="w"> </span><span class="n">ndir</span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">),</span><span class="w">    </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="w">   </span><span class="p">)</span><span class="w">                 </span><span class="kd">::</span><span class="w"> </span><span class="n">eps</span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">),</span><span class="w">    </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="w">   </span><span class="p">)</span><span class="w">                 </span><span class="kd">::</span><span class="w"> </span><span class="n">rel</span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">),</span><span class="w">    </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">x</span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">),</span><span class="w">    </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="w">  </span><span class="p">)</span><span class="w">                 </span><span class="kd">::</span><span class="w"> </span><span class="n">fvec</span>

<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">x0</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ndir</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ct</span><span class="p">,</span><span class="w"> </span><span class="n">st</span><span class="p">,</span><span class="w"> </span><span class="n">ff</span><span class="p">,</span><span class="w"> </span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="n">x2</span>

<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">f0</span><span class="p">,</span><span class="w"> </span><span class="n">fd1</span><span class="p">,</span><span class="w"> </span><span class="n">fd2</span><span class="p">,</span><span class="w"> </span><span class="n">ti</span><span class="p">,</span><span class="w"> </span><span class="n">dfdx1</span><span class="p">,</span><span class="w"> </span><span class="n">dfdx2</span><span class="p">,</span><span class="w"> </span><span class="n">dx1</span><span class="p">,</span><span class="w"> </span><span class="n">dx2</span><span class="p">,</span><span class="w"> </span><span class="n">dt</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">I4</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span>

<span class="w">      </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ndir</span>
<span class="w">         </span><span class="n">ti</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PI_R8</span><span class="o">*</span><span class="p">(</span><span class="w"> </span><span class="o">-</span><span class="mf">1.</span><span class="w"> </span><span class="o">+</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mf">2.</span><span class="o">/</span><span class="n">ndir</span><span class="w"> </span><span class="p">)</span>
<span class="w">         </span><span class="n">ct</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">cos</span><span class="p">(</span><span class="n">ti</span><span class="p">)</span>
<span class="w">         </span><span class="n">st</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sin</span><span class="p">(</span><span class="n">ti</span><span class="p">)</span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">      </span><span class="n">x0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span>

<span class="w">      </span><span class="k">do</span>
<span class="k">         </span><span class="n">f0</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">abs_diff_sk_ku</span><span class="p">(</span><span class="n">chrom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="n">x0</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">     </span><span class="p">,</span><span class="w"> </span><span class="n">x0</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w">     </span><span class="o">/</span><span class="p">))</span>
<span class="w">         </span><span class="n">fd1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">abs_diff_sk_ku</span><span class="p">(</span><span class="n">chrom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="n">x0</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="n">eps</span><span class="p">,</span><span class="w"> </span><span class="n">x0</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w">     </span><span class="o">/</span><span class="p">))</span>
<span class="w">         </span><span class="n">fd2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">abs_diff_sk_ku</span><span class="p">(</span><span class="n">chrom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="n">x0</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">     </span><span class="p">,</span><span class="w"> </span><span class="n">x0</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="n">eps</span><span class="o">/</span><span class="p">))</span>

<span class="w">         </span><span class="n">dfdx1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">fd1</span><span class="w"> </span><span class="o">-</span><span class="n">f0</span><span class="p">)</span><span class="o">/</span><span class="n">eps</span>
<span class="w">         </span><span class="n">dfdx2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">fd2</span><span class="w"> </span><span class="o">-</span><span class="n">f0</span><span class="p">)</span><span class="o">/</span><span class="n">eps</span>

<span class="w">         </span><span class="c">!$OMP PARALLEL DEFAULT(SHARED) NUM_THREADS(nb_th)</span>
<span class="w">         </span><span class="c">!$OMP DO PRIVATE(i, dt, dx1, dx2)</span>
<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ndir</span>
<span class="w">               </span><span class="n">dt</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">f0</span><span class="o">/</span><span class="p">(</span><span class="w"> </span><span class="n">eps</span><span class="o">*</span><span class="p">(</span><span class="n">dfdx1</span><span class="o">*</span><span class="n">ct</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="n">dfdx2</span><span class="o">*</span><span class="n">st</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="w"> </span><span class="p">)</span>
<span class="w">               </span><span class="n">dx1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eps</span><span class="o">*</span><span class="n">ct</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span>
<span class="w">               </span><span class="n">dx2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eps</span><span class="o">*</span><span class="n">st</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span>

<span class="w">               </span><span class="n">x1</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x0</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="n">rel</span><span class="o">*</span><span class="n">dx1</span>
<span class="w">               </span><span class="n">x2</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x0</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="n">rel</span><span class="o">*</span><span class="n">dx2</span>

<span class="w">               </span><span class="n">ff</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">abs_diff_sk_ku</span><span class="p">(</span><span class="n">chrom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="n">x1</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">x2</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="p">))</span>
<span class="w">            </span><span class="k">enddo</span>
<span class="w">         </span><span class="c">!$OMP END DO</span>
<span class="w">         </span><span class="c">!$OMP END PARALLEL</span>

<span class="w">         </span><span class="n">i</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nb">minloc</span><span class="p">(</span><span class="n">ff</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">         </span><span class="n">x0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="n">x1</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">x2</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="p">)</span>

<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ff</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">1.e-8</span><span class="p">)</span><span class="w"> </span><span class="k">exit</span>
<span class="k">         write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">x0</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">x0</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">ff</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">      </span><span class="k">enddo</span>

<span class="k">      </span><span class="n">x</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">x0</span>
<span class="w">      </span><span class="n">fvec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ff</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">   </span><span class="k">return</span>
<span class="k">   endsubroutine </span><span class="n">newton_raphson_downhill</span>


<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">)</span><span class="w"> </span><span class="k">function </span><span class="n">abs_diff_sk_ku</span><span class="p">(</span><span class="n">chrom</span><span class="p">)</span>
<span class="w">   </span><span class="k">implicit none</span>
<span class="k">   </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="kd">::</span><span class="w"> </span><span class="n">chrom</span>

<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">sk</span><span class="p">,</span><span class="w"> </span><span class="n">ku</span>

<span class="w">      </span><span class="k">call </span><span class="n">sk_ku</span><span class="p">(</span><span class="n">xx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">chrom</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">sk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sk</span><span class="p">,</span><span class="w"> </span><span class="n">ku</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ku</span><span class="p">)</span>
<span class="w">      </span><span class="n">abs_diff_sk_ku</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">sk</span><span class="w"> </span><span class="o">-</span><span class="n">SSK</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="nb">abs</span><span class="p">(</span><span class="n">ku</span><span class="w"> </span><span class="o">-</span><span class="n">SKU</span><span class="p">)</span>

<span class="w">   </span><span class="k">return</span>
<span class="k">   endfunction </span><span class="n">abs_diff_sk_ku</span>


<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">)</span><span class="w"> </span><span class="k">function </span><span class="n">cost_func</span><span class="p">(</span><span class="n">chrom</span><span class="p">)</span>
<span class="w">   </span><span class="k">implicit none</span>
<span class="k">   </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">chrom</span>

<span class="w">      </span><span class="n">cost_func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">abs_diff_sk_ku</span><span class="p">(</span><span class="n">chrom</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)))</span>

<span class="w">   </span><span class="k">return</span>
<span class="k">   endfunction </span><span class="n">cost_func</span>


<span class="w">   </span><span class="k">subroutine </span><span class="n">sk_ku</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="w"> </span><span class="n">sk</span><span class="p">,</span><span class="w"> </span><span class="n">ku</span><span class="p">)</span>
<span class="w">   </span><span class="k">implicit none</span>
<span class="k">   </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xx</span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w">                 </span><span class="kd">::</span><span class="w"> </span><span class="n">sk</span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w">                 </span><span class="kd">::</span><span class="w"> </span><span class="n">ku</span>

<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">xa</span><span class="p">,</span><span class="w"> </span><span class="n">xb</span><span class="p">,</span><span class="w"> </span><span class="n">mu</span><span class="p">,</span><span class="w"> </span><span class="n">si</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">un</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">h</span><span class="p">,</span><span class="w"> </span><span class="n">hh</span><span class="p">,</span><span class="w"> </span><span class="n">b1</span><span class="p">,</span><span class="w"> </span><span class="n">b2</span><span class="p">,</span><span class="w"> </span><span class="n">alp</span><span class="p">,</span><span class="w"> </span><span class="n">bet</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">I4</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ia</span><span class="p">,</span><span class="w"> </span><span class="n">ib</span><span class="p">,</span><span class="w"> </span><span class="n">deb</span><span class="p">,</span><span class="w"> </span><span class="n">fin</span><span class="p">,</span><span class="w"> </span><span class="n">npts</span><span class="p">,</span><span class="w"> </span><span class="nb">long</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">k</span>

<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">x</span>
<span class="w">      </span><span class="nb">long</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">nn</span>

<span class="w">      </span><span class="k">do </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span>
<span class="w">        </span><span class="n">x</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">xx</span><span class="p">(</span><span class="n">k</span><span class="p">),</span><span class="w"> </span><span class="mf">1.e-4_R8</span><span class="w"> </span><span class="p">)</span>
<span class="w">      </span><span class="k">enddo</span>

<span class="k">      </span><span class="n">ia</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">long</span>
<span class="nb">      </span><span class="n">ib</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">long</span>

<span class="nb">      </span><span class="n">npts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">long</span><span class="o">*</span><span class="nb">long</span>

<span class="nb">      </span><span class="n">deb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w">    </span><span class="o">+</span><span class="n">ia</span>
<span class="w">      </span><span class="n">fin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">npts</span><span class="w"> </span><span class="o">-</span><span class="n">ib</span>

<span class="w">      </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">      </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="w">      </span><span class="n">hh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mf">2._R8</span><span class="w"> </span><span class="o">-</span><span class="n">a</span><span class="w"> </span><span class="o">-</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">npts</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="w">      </span><span class="n">h</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">pi_R8</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">hh</span>

<span class="w">      </span><span class="n">xa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="n">ia</span><span class="o">*</span><span class="n">hh</span>
<span class="w">      </span><span class="n">xb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">+</span><span class="n">ib</span><span class="o">*</span><span class="n">hh</span>

<span class="w">      </span><span class="n">b1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">pi_R8</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">a</span><span class="p">)</span>
<span class="w">      </span><span class="n">b2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">+</span><span class="n">pi_R8</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">b</span><span class="p">)</span>

<span class="w">      </span><span class="n">alp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="p">(</span><span class="n">b2</span><span class="o">-</span><span class="n">npts</span><span class="o">*</span><span class="n">b1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">b2</span><span class="o">-</span><span class="n">b1</span><span class="p">)</span>
<span class="w">      </span><span class="n">bet</span><span class="w"> </span><span class="o">=</span><span class="w">      </span><span class="p">(</span><span class="n">npts</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">b2</span><span class="o">-</span><span class="n">b1</span><span class="p">)</span>

<span class="w">      </span><span class="n">un</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1._R8</span>
<span class="w">      </span><span class="c">!. . . . . . . . . . . . . . . . . . . . . . . . . . . . .</span>
<span class="w">      </span><span class="n">mu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">log</span><span class="p">(</span><span class="mf">1._R8</span><span class="o">/</span><span class="nb">sin</span><span class="p">((</span><span class="n">pi_R8</span><span class="o">*</span><span class="n">xb</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span><span class="o">*</span><span class="nb">sin</span><span class="p">((</span><span class="n">pi_R8</span><span class="o">*</span><span class="n">xa</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">))</span>
<span class="w">      </span><span class="n">mu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">un</span><span class="o">/</span><span class="n">h</span><span class="p">)</span><span class="o">*</span><span class="n">mu</span><span class="w"> </span><span class="o">+</span><span class="n">add_tang</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">deb</span><span class="p">,</span><span class="w"> </span><span class="n">fin</span><span class="p">,</span><span class="w"> </span><span class="n">alp</span><span class="p">,</span><span class="w"> </span><span class="n">bet</span><span class="p">,</span><span class="w"> </span><span class="n">mu</span><span class="o">=</span><span class="mf">0._R8</span><span class="p">,</span><span class="w"> </span><span class="n">si</span><span class="o">=</span><span class="mf">1._R8</span><span class="p">)</span>
<span class="w">      </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ia</span><span class="o">-</span><span class="mi">1</span>
<span class="w">         </span><span class="n">mu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mu</span><span class="w"> </span><span class="o">+</span><span class="n">tang</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">un</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">alp</span><span class="p">,</span><span class="w"> </span><span class="n">bet</span><span class="p">,</span><span class="w"> </span><span class="n">mu</span><span class="o">=</span><span class="mf">0._R8</span><span class="p">,</span><span class="w"> </span><span class="n">si</span><span class="o">=</span><span class="mf">1._R8</span><span class="p">)</span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">      do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">npts</span><span class="p">,</span><span class="w"> </span><span class="n">npts</span><span class="w"> </span><span class="o">-</span><span class="p">(</span><span class="n">ib</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">         </span><span class="n">mu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mu</span><span class="w"> </span><span class="o">+</span><span class="n">tang</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">un</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">alp</span><span class="p">,</span><span class="w"> </span><span class="n">bet</span><span class="p">,</span><span class="w"> </span><span class="n">mu</span><span class="o">=</span><span class="mf">0._R8</span><span class="p">,</span><span class="w"> </span><span class="n">si</span><span class="o">=</span><span class="mf">1._R8</span><span class="p">)</span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">      </span><span class="n">mu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mu</span><span class="o">/</span><span class="n">npts</span>
<span class="w">      </span><span class="c">!. . . . . . . . . . . . . . . . . . . . . . . . . . . . .</span>
<span class="w">      </span><span class="n">si</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">pi_R8</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xa</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xb</span><span class="p">))</span><span class="o">/</span><span class="mf">2.</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">mu</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">pi_R8</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xa</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xb</span><span class="p">))</span><span class="o">/</span><span class="mf">2.</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1._R8</span><span class="o">/</span><span class="nb">tan</span><span class="p">((</span><span class="n">pi_R8</span><span class="o">*</span><span class="n">xa</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1._R8</span><span class="o">/</span><span class="nb">tan</span><span class="p">((</span><span class="n">pi_R8</span><span class="o">*</span><span class="n">xb</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">mu</span><span class="o">*</span><span class="nb">Log</span><span class="p">(</span><span class="mf">1._R8</span><span class="o">/</span><span class="nb">sin</span><span class="p">((</span><span class="n">pi_R8</span><span class="o">*</span><span class="n">xb</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span><span class="o">*</span><span class="nb">Sin</span><span class="p">((</span><span class="n">pi_R8</span><span class="o">*</span><span class="n">xa</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">))</span>
<span class="w">      </span><span class="n">si</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">un</span><span class="o">/</span><span class="n">h</span><span class="p">)</span><span class="o">*</span><span class="n">si</span><span class="w"> </span><span class="o">+</span><span class="n">add_tang</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">deb</span><span class="p">,</span><span class="w"> </span><span class="n">fin</span><span class="p">,</span><span class="w"> </span><span class="n">alp</span><span class="p">,</span><span class="w"> </span><span class="n">bet</span><span class="p">,</span><span class="w"> </span><span class="n">mu</span><span class="p">,</span><span class="w"> </span><span class="n">si</span><span class="o">=</span><span class="mf">1._R8</span><span class="p">)</span>
<span class="w">      </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ia</span><span class="o">-</span><span class="mi">1</span>
<span class="w">         </span><span class="n">si</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">si</span><span class="o">+</span><span class="w"> </span><span class="n">tang</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">un</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">alp</span><span class="p">,</span><span class="w"> </span><span class="n">bet</span><span class="p">,</span><span class="w"> </span><span class="n">mu</span><span class="p">,</span><span class="w"> </span><span class="n">si</span><span class="o">=</span><span class="mf">1._R8</span><span class="p">)</span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">      do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">npts</span><span class="p">,</span><span class="w"> </span><span class="n">npts</span><span class="w"> </span><span class="o">-</span><span class="p">(</span><span class="n">ib</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">         </span><span class="n">si</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">si</span><span class="w"> </span><span class="o">+</span><span class="n">tang</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">un</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">alp</span><span class="p">,</span><span class="w"> </span><span class="n">bet</span><span class="p">,</span><span class="w"> </span><span class="n">mu</span><span class="p">,</span><span class="w"> </span><span class="n">si</span><span class="o">=</span><span class="mf">1._R8</span><span class="p">)</span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">      </span><span class="n">si</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">si</span><span class="o">/</span><span class="n">npts</span>
<span class="w">      </span><span class="n">si</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="n">si</span><span class="p">)</span>
<span class="w">      </span><span class="c">!. . . . . . . . . . . . . . . . . . . . . . . . . . . . .</span>
<span class="w">      </span><span class="n">sk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">mu</span><span class="o">*</span><span class="n">pi_R8</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">mu</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">pi_R8</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">mu</span><span class="o">*</span><span class="n">pi_R8</span><span class="o">*</span><span class="n">xa</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">mu</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">pi_R8</span><span class="o">*</span><span class="n">xa</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">mu</span><span class="o">*</span><span class="n">pi_R8</span><span class="o">*</span><span class="n">xb</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">mu</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">pi_R8</span><span class="o">*</span><span class="n">xb</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">6</span><span class="o">*</span><span class="n">mu</span><span class="o">*</span><span class="mf">1._R8</span><span class="o">/</span><span class="nb">tan</span><span class="p">((</span><span class="n">pi_R8</span><span class="o">*</span><span class="n">xa</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">6</span><span class="o">*</span><span class="n">mu</span><span class="o">*</span><span class="mf">1._R8</span><span class="o">/</span><span class="nb">tan</span><span class="p">((</span><span class="n">pi_R8</span><span class="o">*</span><span class="n">xb</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1._R8</span><span class="o">/</span><span class="nb">sin</span><span class="p">((</span><span class="n">pi_R8</span><span class="o">*</span><span class="n">xa</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1._R8</span><span class="o">/</span><span class="nb">sin</span><span class="p">((</span><span class="n">pi_R8</span><span class="o">*</span><span class="n">xb</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="nb">Log</span><span class="p">(</span><span class="nb">Sin</span><span class="p">((</span><span class="n">pi_R8</span><span class="o">*</span><span class="n">xa</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">6</span><span class="o">*</span><span class="n">mu</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="nb">Log</span><span class="p">(</span><span class="nb">Sin</span><span class="p">((</span><span class="n">pi_R8</span><span class="o">*</span><span class="n">xa</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="nb">Log</span><span class="p">(</span><span class="nb">Sin</span><span class="p">((</span><span class="n">pi_R8</span><span class="o">*</span><span class="n">xb</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">))</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">6</span><span class="o">*</span><span class="n">mu</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="nb">Log</span><span class="p">(</span><span class="nb">Sin</span><span class="p">((</span><span class="n">pi_R8</span><span class="o">*</span><span class="n">xb</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">)))</span><span class="o">/</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">si</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
<span class="w">      </span><span class="n">sk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">un</span><span class="o">/</span><span class="n">h</span><span class="p">)</span><span class="o">*</span><span class="n">sk</span><span class="w"> </span><span class="o">+</span><span class="n">add_tang</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">deb</span><span class="p">,</span><span class="w"> </span><span class="n">fin</span><span class="p">,</span><span class="w"> </span><span class="n">alp</span><span class="p">,</span><span class="w"> </span><span class="n">bet</span><span class="p">,</span><span class="w"> </span><span class="n">mu</span><span class="p">,</span><span class="w"> </span><span class="n">si</span><span class="p">)</span>
<span class="w">      </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ia</span><span class="o">-</span><span class="mi">1</span>
<span class="w">         </span><span class="n">sk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sk</span><span class="w"> </span><span class="o">+</span><span class="n">tang</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">un</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">alp</span><span class="p">,</span><span class="w"> </span><span class="n">bet</span><span class="p">,</span><span class="w"> </span><span class="n">mu</span><span class="p">,</span><span class="w"> </span><span class="n">si</span><span class="p">)</span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">      do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">npts</span><span class="p">,</span><span class="w"> </span><span class="n">npts</span><span class="w"> </span><span class="o">-</span><span class="p">(</span><span class="n">ib</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">         </span><span class="n">sk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sk</span><span class="w"> </span><span class="o">+</span><span class="n">tang</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">un</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">alp</span><span class="p">,</span><span class="w"> </span><span class="n">bet</span><span class="p">,</span><span class="w"> </span><span class="n">mu</span><span class="p">,</span><span class="w"> </span><span class="n">si</span><span class="p">)</span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">      </span><span class="n">sk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sk</span><span class="o">/</span><span class="n">npts</span>
<span class="w">      </span><span class="c">!. . . . . . . . . . . . . . . . . . . . . . . . . . . . .</span>
<span class="w">      </span><span class="n">ku</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">pi_R8</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">36</span><span class="o">*</span><span class="n">mu</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">pi_R8</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">6</span><span class="o">*</span><span class="n">mu</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">pi_R8</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">pi_R8</span><span class="o">*</span><span class="n">xa</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">18</span><span class="o">*</span><span class="n">mu</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">pi_R8</span><span class="o">*</span><span class="n">xa</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">mu</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">pi_R8</span><span class="o">*</span><span class="n">xa</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">pi_R8</span><span class="o">*</span><span class="n">xb</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">18</span><span class="o">*</span><span class="n">mu</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">pi_R8</span><span class="o">*</span><span class="n">xb</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">mu</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">pi_R8</span><span class="o">*</span><span class="n">xb</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">9</span><span class="o">*</span><span class="n">mu</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mf">1._R8</span><span class="o">/</span><span class="nb">tan</span><span class="p">((</span><span class="n">pi_R8</span><span class="o">*</span><span class="n">xa</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">9</span><span class="o">*</span><span class="n">mu</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mf">1._R8</span><span class="o">/</span><span class="nb">tan</span><span class="p">((</span><span class="n">pi_R8</span><span class="o">*</span><span class="n">xb</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">12</span><span class="o">*</span><span class="n">mu</span><span class="o">*</span><span class="mf">1._R8</span><span class="o">/</span><span class="nb">sin</span><span class="p">((</span><span class="n">pi_R8</span><span class="o">*</span><span class="n">xa</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">12</span><span class="o">*</span><span class="n">mu</span><span class="o">*</span><span class="mf">1._R8</span><span class="o">/</span><span class="nb">sin</span><span class="p">((</span><span class="n">pi_R8</span><span class="o">*</span><span class="n">xb</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">24</span><span class="o">*</span><span class="n">mu</span><span class="o">*</span><span class="nb">Log</span><span class="p">(</span><span class="nb">Sin</span><span class="p">((</span><span class="n">pi_R8</span><span class="o">*</span><span class="n">xa</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">))</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">24</span><span class="o">*</span><span class="n">mu</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="nb">Log</span><span class="p">(</span><span class="nb">Sin</span><span class="p">((</span><span class="n">pi_R8</span><span class="o">*</span><span class="n">xa</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">))</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">24</span><span class="o">*</span><span class="n">mu</span><span class="o">*</span><span class="nb">Log</span><span class="p">(</span><span class="nb">Sin</span><span class="p">((</span><span class="n">pi_R8</span><span class="o">*</span><span class="n">xb</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">24</span><span class="o">*</span><span class="n">mu</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="nb">Log</span><span class="p">(</span><span class="nb">Sin</span><span class="p">((</span><span class="n">pi_R8</span><span class="o">*</span><span class="n">xb</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1._R8</span><span class="o">/</span><span class="nb">sin</span><span class="p">((</span><span class="n">pi_R8</span><span class="o">*</span><span class="n">xa</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="nb">Sin</span><span class="p">(</span><span class="n">pi_R8</span><span class="o">*</span><span class="n">xa</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1._R8</span><span class="o">/</span><span class="nb">sin</span><span class="p">((</span><span class="n">pi_R8</span><span class="o">*</span><span class="n">xb</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="nb">Sin</span><span class="p">(</span><span class="n">pi_R8</span><span class="o">*</span><span class="n">xb</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mf">6.</span><span class="o">*</span><span class="n">si</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
<span class="w">      </span><span class="n">ku</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">un</span><span class="o">/</span><span class="n">h</span><span class="p">)</span><span class="o">*</span><span class="n">ku</span><span class="w"> </span><span class="o">+</span><span class="n">add_tang</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="n">deb</span><span class="p">,</span><span class="w"> </span><span class="n">fin</span><span class="p">,</span><span class="w"> </span><span class="n">alp</span><span class="p">,</span><span class="w"> </span><span class="n">bet</span><span class="p">,</span><span class="w"> </span><span class="n">mu</span><span class="p">,</span><span class="w"> </span><span class="n">si</span><span class="p">)</span>
<span class="w">      </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ia</span><span class="o">-</span><span class="mi">1</span>
<span class="w">         </span><span class="n">ku</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ku</span><span class="w"> </span><span class="o">+</span><span class="n">tang</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">un</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="n">alp</span><span class="p">,</span><span class="w"> </span><span class="n">bet</span><span class="p">,</span><span class="w"> </span><span class="n">mu</span><span class="p">,</span><span class="w"> </span><span class="n">si</span><span class="p">)</span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">      do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">npts</span><span class="p">,</span><span class="w"> </span><span class="n">npts</span><span class="w"> </span><span class="o">-</span><span class="p">(</span><span class="n">ib</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">         </span><span class="n">ku</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ku</span><span class="w"> </span><span class="o">+</span><span class="n">tang</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">un</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="n">alp</span><span class="p">,</span><span class="w"> </span><span class="n">bet</span><span class="p">,</span><span class="w"> </span><span class="n">mu</span><span class="p">,</span><span class="w"> </span><span class="n">si</span><span class="p">)</span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">      </span><span class="n">ku</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ku</span><span class="o">/</span><span class="n">npts</span>
<span class="w">      </span><span class="c">!. . . . . . . . . . . . . . . . . . . . . . . . . . . . .</span>

<span class="w">   </span><span class="k">return</span>
<span class="k">   endsubroutine </span><span class="n">sk_ku</span>


<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">)</span><span class="w"> </span><span class="k">function </span><span class="n">add_tang</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">deb</span><span class="p">,</span><span class="w"> </span><span class="n">fin</span><span class="p">,</span><span class="w"> </span><span class="n">alp</span><span class="p">,</span><span class="w"> </span><span class="n">bet</span><span class="p">,</span><span class="w"> </span><span class="n">mu</span><span class="p">,</span><span class="w"> </span><span class="n">si</span><span class="p">)</span>
<span class="w">   </span><span class="k">implicit none</span>
<span class="k">   </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">),</span><span class="w">    </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">alp</span><span class="p">,</span><span class="w"> </span><span class="n">bet</span><span class="p">,</span><span class="w"> </span><span class="n">mu</span><span class="p">,</span><span class="w"> </span><span class="n">si</span>
<span class="w">   </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">i4</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">fin</span><span class="p">,</span><span class="w"> </span><span class="n">deb</span>

<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xdeb</span><span class="p">,</span><span class="w"> </span><span class="n">xfin</span>

<span class="w">      </span><span class="n">xdeb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deb</span>
<span class="w">      </span><span class="n">xfin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fin</span>
<span class="w">      </span><span class="n">add_tang</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mi">12</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="w"> </span><span class="o">+</span><span class="mi">9</span><span class="o">*</span><span class="p">(</span><span class="n">tang</span><span class="p">(</span><span class="n">xdeb</span><span class="w"> </span><span class="o">+</span><span class="mf">0.0_R8</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">alp</span><span class="p">,</span><span class="w"> </span><span class="n">bet</span><span class="p">,</span><span class="w"> </span><span class="n">mu</span><span class="p">,</span><span class="w"> </span><span class="n">si</span><span class="p">)</span><span class="o">+</span><span class="n">tang</span><span class="p">(</span><span class="n">xfin</span><span class="w"> </span><span class="o">-</span><span class="mf">0.0_R8</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">alp</span><span class="p">,</span><span class="w"> </span><span class="n">bet</span><span class="p">,</span><span class="w"> </span><span class="n">mu</span><span class="p">,</span><span class="w"> </span><span class="n">si</span><span class="p">))</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                           </span><span class="o">+</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="n">tang</span><span class="p">(</span><span class="n">xdeb</span><span class="w"> </span><span class="o">+</span><span class="mf">1.0_R8</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">alp</span><span class="p">,</span><span class="w"> </span><span class="n">bet</span><span class="p">,</span><span class="w"> </span><span class="n">mu</span><span class="p">,</span><span class="w"> </span><span class="n">si</span><span class="p">)</span><span class="o">+</span><span class="n">tang</span><span class="p">(</span><span class="n">xfin</span><span class="w"> </span><span class="o">-</span><span class="mf">1.0_R8</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">alp</span><span class="p">,</span><span class="w"> </span><span class="n">bet</span><span class="p">,</span><span class="w"> </span><span class="n">mu</span><span class="p">,</span><span class="w"> </span><span class="n">si</span><span class="p">))</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                           </span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">tang</span><span class="p">(</span><span class="n">xdeb</span><span class="w"> </span><span class="o">+</span><span class="mf">0.5_R8</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">alp</span><span class="p">,</span><span class="w"> </span><span class="n">bet</span><span class="p">,</span><span class="w"> </span><span class="n">mu</span><span class="p">,</span><span class="w"> </span><span class="n">si</span><span class="p">)</span><span class="o">+</span><span class="n">tang</span><span class="p">(</span><span class="n">xfin</span><span class="w"> </span><span class="o">-</span><span class="mf">0.5_R8</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">alp</span><span class="p">,</span><span class="w"> </span><span class="n">bet</span><span class="p">,</span><span class="w"> </span><span class="n">mu</span><span class="p">,</span><span class="w"> </span><span class="n">si</span><span class="p">))</span><span class="w"> </span><span class="p">)</span>
<span class="w">   </span><span class="k">return</span>
<span class="k">   endfunction </span><span class="n">add_tang</span>


<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">)</span><span class="w"> </span><span class="k">function </span><span class="n">tang</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">alp</span><span class="p">,</span><span class="w"> </span><span class="n">bet</span><span class="p">,</span><span class="w"> </span><span class="n">mu</span><span class="p">,</span><span class="w"> </span><span class="n">si</span><span class="p">)</span>
<span class="w">   </span><span class="k">implicit none</span>
<span class="k">   </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">),</span><span class="w">    </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xi</span><span class="p">,</span><span class="w"> </span><span class="n">alp</span><span class="p">,</span><span class="w"> </span><span class="n">bet</span><span class="p">,</span><span class="w"> </span><span class="n">mu</span><span class="p">,</span><span class="w"> </span><span class="n">si</span>
<span class="w">   </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">i4</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">n</span>

<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tmp</span>

<span class="w">      </span><span class="n">tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">xi</span><span class="w"> </span><span class="o">+</span><span class="n">alp</span><span class="p">)</span><span class="o">/</span><span class="n">bet</span>
<span class="w">      </span><span class="n">tang</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="nb">tan</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="n">mu</span><span class="p">)</span><span class="o">/</span><span class="n">si</span><span class="w"> </span><span class="p">)</span><span class="o">**</span><span class="n">n</span>

<span class="w">   </span><span class="k">return</span>
<span class="k">   endfunction </span><span class="n">tang</span>


<span class="w">   </span><span class="k">subroutine </span><span class="n">calc_moments_1D</span><span class="p">(</span><span class="n">tab</span><span class="p">,</span><span class="w"> </span><span class="n">mx</span><span class="p">,</span><span class="w"> </span><span class="n">nb_mom</span><span class="p">,</span><span class="w"> </span><span class="n">lg</span><span class="p">)</span>
<span class="w">   </span><span class="k">implicit none</span>
<span class="k">   </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">I4</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="w"> </span><span class="p">)</span><span class="w">                  </span><span class="kd">::</span><span class="w"> </span><span class="n">lg</span>
<span class="w">   </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">I4</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="w"> </span><span class="p">)</span><span class="w">                  </span><span class="kd">::</span><span class="w"> </span><span class="n">nb_mom</span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">)</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">lg</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tab</span>
<span class="w">   </span><span class="k">type</span><span class="p">(</span><span class="n">moment_stat</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w">                  </span><span class="kd">::</span><span class="w"> </span><span class="n">mx</span>

<span class="w">      </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">I4</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">tmp</span>

<span class="w">      </span><span class="n">mx</span><span class="p">%</span><span class="n">mu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">      </span><span class="n">mx</span><span class="p">%</span><span class="n">si</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">      </span><span class="n">mx</span><span class="p">%</span><span class="n">va</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">      </span><span class="n">mx</span><span class="p">%</span><span class="n">Sk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">      </span><span class="n">mx</span><span class="p">%</span><span class="n">Ku</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">      </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">lg</span>
<span class="w">         </span><span class="n">mx</span><span class="p">%</span><span class="n">mu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mx</span><span class="p">%</span><span class="n">mu</span><span class="w"> </span><span class="o">+</span><span class="n">tab</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="n">lg</span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">nb_mom</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">return</span>

<span class="k">      do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">lg</span>
<span class="w">         </span><span class="n">mx</span><span class="p">%</span><span class="n">va</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mx</span><span class="p">%</span><span class="n">va</span><span class="w"> </span><span class="o">+</span><span class="p">((</span><span class="n">tab</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="n">mx</span><span class="p">%</span><span class="n">mu</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">lg</span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">      </span><span class="n">mx</span><span class="p">%</span><span class="n">si</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="w"> </span><span class="n">mx</span><span class="p">%</span><span class="n">va</span><span class="w"> </span><span class="p">)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nb_mom</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">return</span>
<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">mx</span><span class="p">%</span><span class="n">si</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">1.e-15_R8</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         </span><span class="n">mx</span><span class="p">%</span><span class="n">Sk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">         </span><span class="n">mx</span><span class="p">%</span><span class="n">Ku</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">      </span><span class="k">else</span>
<span class="k">         do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">lg</span>
<span class="w">            </span><span class="n">tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">tab</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="n">mx</span><span class="p">%</span><span class="n">mu</span><span class="p">)</span><span class="o">/</span><span class="n">mx</span><span class="p">%</span><span class="n">si</span>
<span class="w">            </span><span class="n">mx</span><span class="p">%</span><span class="n">Sk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mx</span><span class="p">%</span><span class="n">Sk</span><span class="w"> </span><span class="o">+</span><span class="p">(</span><span class="n">tmp</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="n">lg</span>
<span class="w">            </span><span class="n">mx</span><span class="p">%</span><span class="n">Ku</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mx</span><span class="p">%</span><span class="n">Ku</span><span class="w"> </span><span class="o">+</span><span class="p">(</span><span class="n">tmp</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">/</span><span class="n">lg</span>
<span class="w">         </span><span class="k">enddo</span>
<span class="k">      endif</span>

<span class="k">   return</span>
<span class="k">   endsubroutine </span><span class="n">calc_moments_1D</span>


<span class="w">   </span><span class="k">subroutine </span><span class="n">profil_theo_trie_1D</span><span class="p">(</span><span class="n">tab</span><span class="p">,</span><span class="w"> </span><span class="n">lg</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">mx</span><span class="p">)</span>
<span class="w">   </span><span class="k">implicit none</span>
<span class="k">   </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">I4</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="w"> </span><span class="p">)</span><span class="w">                  </span><span class="kd">::</span><span class="w"> </span><span class="n">lg</span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">)</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">lg</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tab</span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">)</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">x</span>
<span class="w">   </span><span class="k">type</span><span class="p">(</span><span class="n">moment_stat</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w">                  </span><span class="kd">::</span><span class="w"> </span><span class="n">mx</span>

<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">b1</span><span class="p">,</span><span class="w"> </span><span class="n">b2</span><span class="p">,</span><span class="w"> </span><span class="n">alp</span><span class="p">,</span><span class="w"> </span><span class="n">bet</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">I4</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span>

<span class="w">      </span><span class="n">b1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">PI_R8</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="w"> </span><span class="o">-</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="w">      </span><span class="n">b2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">+</span><span class="n">PI_R8</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="w"> </span><span class="o">-</span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="w">      </span><span class="n">alp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="p">(</span><span class="n">b2</span><span class="o">-</span><span class="w"> </span><span class="n">lg</span><span class="o">*</span><span class="n">b1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">b2</span><span class="w"> </span><span class="o">-</span><span class="n">b1</span><span class="p">)</span>
<span class="w">      </span><span class="n">bet</span><span class="w"> </span><span class="o">=</span><span class="w">      </span><span class="p">(</span><span class="n">lg</span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">b2</span><span class="w"> </span><span class="o">-</span><span class="n">b1</span><span class="p">)</span>
<span class="w">      </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">lg</span>
<span class="w">         </span><span class="n">tab</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">tan</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="n">alp</span><span class="p">)</span><span class="o">/</span><span class="n">bet</span><span class="w"> </span><span class="p">)</span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">      call </span><span class="n">calc_moments_1D</span><span class="p">(</span><span class="n">tab</span><span class="p">,</span><span class="w"> </span><span class="n">mx</span><span class="p">,</span><span class="w"> </span><span class="n">nb_mom</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="n">lg</span><span class="o">=</span><span class="n">lg</span><span class="p">)</span>
<span class="w">      </span><span class="n">tab</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">lg</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">tab</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">lg</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="n">mx</span><span class="p">%</span><span class="n">mu</span><span class="p">)</span><span class="o">/</span><span class="n">mx</span><span class="p">%</span><span class="n">si</span>

<span class="w">      </span><span class="n">mx</span><span class="p">%</span><span class="n">mu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0._R8</span>
<span class="w">      </span><span class="n">mx</span><span class="p">%</span><span class="n">si</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1._R8</span>

<span class="w">   </span><span class="k">return</span>
<span class="k">   endsubroutine </span><span class="n">profil_theo_trie_1D</span>


<span class="w">   </span><span class="k">subroutine </span><span class="n">melange</span><span class="p">(</span><span class="n">tab</span><span class="p">,</span><span class="w"> </span><span class="n">lg</span><span class="p">)</span>
<span class="w">   </span><span class="k">implicit none</span>
<span class="k">   </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">i4</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="w">   </span><span class="p">)</span><span class="w">                  </span><span class="kd">::</span><span class="w"> </span><span class="n">lg</span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">r8</span><span class="p">)</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">lg</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tab</span>

<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">r8</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">lg</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tmp</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">i4</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span>

<span class="w">      </span><span class="k">call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">harvest</span><span class="o">=</span><span class="n">tmp</span><span class="p">)</span>

<span class="w">      </span><span class="k">call </span><span class="n">sort_array2</span><span class="p">(</span><span class="n">tab_inout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tmp</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">lg</span><span class="p">),</span><span class="w">            </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<span class="w">                            </span><span class="n">tab1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">lg</span><span class="p">),</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lg</span><span class="p">)</span><span class="w">       </span><span class="c">!</span>

<span class="w">   </span><span class="k">return</span>
<span class="k">   endsubroutine </span><span class="n">melange</span>

<span class="k">endprogram </span><span class="n">test_algen</span>
</pre></div>

    </section>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              TOOLIB
 was developed by Arthur Francisco<br>              &copy; 2024 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2024-11-20 15:32 +0100             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>    

    <!-- MathJax JavaScript
             ================================================== -->
             <!-- Placed at the end of the document so the pages load faster -->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
          TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
          jax: ['input/TeX','input/MathML','output/HTML-CSS'],
          extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
          });
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

          <script src="../tipuesearch/tipuesearch_content.js"></script>
          <script src="../tipuesearch/tipuesearch_set.js"></script>
          <script src="../tipuesearch/tipuesearch.js"></script>

  </body>
</html>